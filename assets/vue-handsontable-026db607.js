import{i as fm,j as AO,m as I$,o as k$,c as A$,k as M$}from"./index-a6ef20b2.js";var Vl=function(e){return e&&e.Math==Math&&e},be=Vl(typeof globalThis=="object"&&globalThis)||Vl(typeof window=="object"&&window)||Vl(typeof self=="object"&&self)||Vl(typeof fm=="object"&&fm)||function(){return this}()||Function("return this")(),Ur={},Q=function(e){try{return!!e()}catch{return!0}},x$=Q,Fe=!x$(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),N$=Q,ul=!N$(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),D$=ul,Wl=Function.prototype.call,Ge=D$?Wl.bind(Wl):function(){return Wl.apply(Wl,arguments)},cl={},MO={}.propertyIsEnumerable,xO=Object.getOwnPropertyDescriptor,H$=xO&&!MO.call({1:2},1);cl.f=H$?function(t){var r=xO(this,t);return!!r&&r.enumerable}:MO;var fl=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},NO=ul,DO=Function.prototype,sh=DO.call,L$=NO&&DO.bind.bind(sh,sh),ee=NO?L$:function(e){return function(){return sh.apply(e,arguments)}},HO=ee,F$=HO({}.toString),j$=HO("".slice),Tr=function(e){return j$(F$(e),8,-1)},V$=ee,W$=Q,B$=Tr,Ic=Object,z$=V$("".split),hl=W$(function(){return!Ic("z").propertyIsEnumerable(0)})?function(e){return B$(e)=="String"?z$(e,""):Ic(e)}:Ic,Rr=function(e){return e==null},U$=Rr,Y$=TypeError,cr=function(e){if(U$(e))throw Y$("Can't call method on "+e);return e},G$=hl,K$=cr,Ft=function(e){return G$(K$(e))},uh=typeof document=="object"&&document.all,X$=typeof uh>"u"&&uh!==void 0,LO={all:uh,IS_HTMLDDA:X$},FO=LO,q$=FO.all,Ee=FO.IS_HTMLDDA?function(e){return typeof e=="function"||e===q$}:function(e){return typeof e=="function"},hm=Ee,jO=LO,Z$=jO.all,je=jO.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:hm(e)||e===Z$}:function(e){return typeof e=="object"?e!==null:hm(e)},kc=be,Q$=Ee,J$=function(e){return Q$(e)?e:void 0},Yr=function(e,t){return arguments.length<2?J$(kc[e]):kc[e]&&kc[e][t]},eP=ee,yn=eP({}.isPrototypeOf),Un=typeof navigator<"u"&&String(navigator.userAgent)||"",VO=be,Ac=Un,dm=VO.process,vm=VO.Deno,ym=dm&&dm.versions||vm&&vm.version,mm=ym&&ym.v8,ir,Bs;mm&&(ir=mm.split("."),Bs=ir[0]>0&&ir[0]<4?1:+(ir[0]+ir[1]));!Bs&&Ac&&(ir=Ac.match(/Edge\/(\d+)/),(!ir||ir[1]>=74)&&(ir=Ac.match(/Chrome\/(\d+)/),ir&&(Bs=+ir[1])));var dl=Bs,gm=dl,tP=Q,co=!!Object.getOwnPropertySymbols&&!tP(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&gm&&gm<41}),rP=co,WO=rP&&!Symbol.sham&&typeof Symbol.iterator=="symbol",nP=Yr,iP=Ee,oP=yn,aP=WO,lP=Object,vl=aP?function(e){return typeof e=="symbol"}:function(e){var t=nP("Symbol");return iP(t)&&oP(t.prototype,lP(e))},sP=String,fo=function(e){try{return sP(e)}catch{return"Object"}},uP=Ee,cP=fo,fP=TypeError,Yn=function(e){if(uP(e))return e;throw fP(cP(e)+" is not a function")},hP=Yn,dP=Rr,ho=function(e,t){var r=e[t];return dP(r)?void 0:hP(r)},Mc=Ge,xc=Ee,Nc=je,vP=TypeError,BO=function(e,t){var r,n;if(t==="string"&&xc(r=e.toString)&&!Nc(n=Mc(r,e))||xc(r=e.valueOf)&&!Nc(n=Mc(r,e))||t!=="string"&&xc(r=e.toString)&&!Nc(n=Mc(r,e)))return n;throw vP("Can't convert object to primitive value")},dn={},yP={get exports(){return dn},set exports(e){dn=e}},mP=!1,pm=be,gP=Object.defineProperty,uv=function(e,t){try{gP(pm,e,{value:t,configurable:!0,writable:!0})}catch{pm[e]=t}return t},pP=be,bP=uv,bm="__core-js_shared__",wP=pP[bm]||bP(bm,{}),cv=wP,wm=cv;(yP.exports=function(e,t){return wm[e]||(wm[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var SP=cr,OP=Object,It=function(e){return OP(SP(e))},CP=ee,_P=It,TP=CP({}.hasOwnProperty),Ae=Object.hasOwn||function(t,r){return TP(_P(t),r)},RP=ee,EP=0,$P=Math.random(),PP=RP(1 .toString),Vu=function(e){return"Symbol("+(e===void 0?"":e)+")_"+PP(++EP+$P,36)},IP=be,kP=dn,Sm=Ae,AP=Vu,MP=co,xP=WO,gi=IP.Symbol,Dc=kP("wks"),NP=xP?gi.for||gi:gi&&gi.withoutSetter||AP,Oe=function(e){return Sm(Dc,e)||(Dc[e]=MP&&Sm(gi,e)?gi[e]:NP("Symbol."+e)),Dc[e]},DP=Ge,Om=je,Cm=vl,HP=ho,LP=BO,FP=Oe,jP=TypeError,VP=FP("toPrimitive"),zO=function(e,t){if(!Om(e)||Cm(e))return e;var r=HP(e,VP),n;if(r){if(t===void 0&&(t="default"),n=DP(r,e,t),!Om(n)||Cm(n))return n;throw jP("Can't convert object to primitive value")}return t===void 0&&(t="number"),LP(e,t)},WP=zO,BP=vl,Wu=function(e){var t=WP(e,"string");return BP(t)?t:t+""},zP=be,_m=je,ch=zP.document,UP=_m(ch)&&_m(ch.createElement),Bu=function(e){return UP?ch.createElement(e):{}},YP=Fe,GP=Q,KP=Bu,UO=!YP&&!GP(function(){return Object.defineProperty(KP("div"),"a",{get:function(){return 7}}).a!=7}),XP=Fe,qP=Ge,ZP=cl,QP=fl,JP=Ft,eI=Wu,tI=Ae,rI=UO,Tm=Object.getOwnPropertyDescriptor;Ur.f=XP?Tm:function(t,r){if(t=JP(t),r=eI(r),rI)try{return Tm(t,r)}catch{}if(tI(t,r))return QP(!qP(ZP.f,t,r),t[r])};var Ot={},nI=Fe,iI=Q,YO=nI&&iI(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),oI=je,aI=String,lI=TypeError,Ve=function(e){if(oI(e))return e;throw lI(aI(e)+" is not an object")},sI=Fe,uI=UO,cI=YO,Bl=Ve,Rm=Wu,fI=TypeError,Hc=Object.defineProperty,hI=Object.getOwnPropertyDescriptor,Lc="enumerable",Fc="configurable",jc="writable";Ot.f=sI?cI?function(t,r,n){if(Bl(t),r=Rm(r),Bl(n),typeof t=="function"&&r==="prototype"&&"value"in n&&jc in n&&!n[jc]){var i=hI(t,r);i&&i[jc]&&(t[r]=n.value,n={configurable:Fc in n?n[Fc]:i[Fc],enumerable:Lc in n?n[Lc]:i[Lc],writable:!1})}return Hc(t,r,n)}:Hc:function(t,r,n){if(Bl(t),r=Rm(r),Bl(n),uI)try{return Hc(t,r,n)}catch{}if("get"in n||"set"in n)throw fI("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var dI=Fe,vI=Ot,yI=fl,Gn=dI?function(e,t,r){return vI.f(e,t,yI(1,r))}:function(e,t,r){return e[t]=r,e},zs={},mI={get exports(){return zs},set exports(e){zs=e}},fh=Fe,gI=Ae,GO=Function.prototype,pI=fh&&Object.getOwnPropertyDescriptor,fv=gI(GO,"name"),bI=fv&&function(){}.name==="something",wI=fv&&(!fh||fh&&pI(GO,"name").configurable),yl={EXISTS:fv,PROPER:bI,CONFIGURABLE:wI},SI=ee,OI=Ee,hh=cv,CI=SI(Function.toString);OI(hh.inspectSource)||(hh.inspectSource=function(e){return CI(e)});var KO=hh.inspectSource,_I=be,TI=Ee,Em=_I.WeakMap,XO=TI(Em)&&/native code/.test(String(Em)),RI=dn,EI=Vu,$m=RI("keys"),zu=function(e){return $m[e]||($m[e]=EI(e))},ml={},$I=XO,qO=be,PI=je,II=Gn,Vc=Ae,Wc=cv,kI=zu,AI=ml,Pm="Object already initialized",dh=qO.TypeError,MI=qO.WeakMap,Us,Jo,Ys,xI=function(e){return Ys(e)?Jo(e):Us(e,{})},NI=function(e){return function(t){var r;if(!PI(t)||(r=Jo(t)).type!==e)throw dh("Incompatible receiver, "+e+" required");return r}};if($I||Wc.state){var pr=Wc.state||(Wc.state=new MI);pr.get=pr.get,pr.has=pr.has,pr.set=pr.set,Us=function(e,t){if(pr.has(e))throw dh(Pm);return t.facade=e,pr.set(e,t),t},Jo=function(e){return pr.get(e)||{}},Ys=function(e){return pr.has(e)}}else{var ri=kI("state");AI[ri]=!0,Us=function(e,t){if(Vc(e,ri))throw dh(Pm);return t.facade=e,II(e,ri,t),t},Jo=function(e){return Vc(e,ri)?e[ri]:{}},Ys=function(e){return Vc(e,ri)}}var Gr={set:Us,get:Jo,has:Ys,enforce:xI,getterFor:NI},hv=ee,DI=Q,HI=Ee,zl=Ae,vh=Fe,LI=yl.CONFIGURABLE,FI=KO,ZO=Gr,jI=ZO.enforce,VI=ZO.get,Im=String,ws=Object.defineProperty,WI=hv("".slice),BI=hv("".replace),zI=hv([].join),UI=vh&&!DI(function(){return ws(function(){},"length",{value:8}).length!==8}),YI=String(String).split("String"),GI=mI.exports=function(e,t,r){WI(Im(t),0,7)==="Symbol("&&(t="["+BI(Im(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!zl(e,"name")||LI&&e.name!==t)&&(vh?ws(e,"name",{value:t,configurable:!0}):e.name=t),UI&&r&&zl(r,"arity")&&e.length!==r.arity&&ws(e,"length",{value:r.arity});try{r&&zl(r,"constructor")&&r.constructor?vh&&ws(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=jI(e);return zl(n,"source")||(n.source=zI(YI,typeof t=="string"?t:"")),e};Function.prototype.toString=GI(function(){return HI(this)&&VI(this).source||FI(this)},"toString");var KI=Ee,XI=Ot,qI=zs,ZI=uv,qt=function(e,t,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:t;if(KI(r)&&qI(r,o,n),n.global)i?e[t]=r:ZI(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:XI.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Kn={},QI=Math.ceil,JI=Math.floor,ek=Math.trunc||function(t){var r=+t;return(r>0?JI:QI)(r)},tk=ek,Xn=function(e){var t=+e;return t!==t||t===0?0:tk(t)},rk=Xn,nk=Math.max,ik=Math.min,gl=function(e,t){var r=rk(e);return r<0?nk(r+t,0):ik(r,t)},ok=Xn,ak=Math.min,vo=function(e){return e>0?ak(ok(e),9007199254740991):0},lk=vo,Zt=function(e){return lk(e.length)},sk=Ft,uk=gl,ck=Zt,km=function(e){return function(t,r,n){var i=sk(t),o=ck(i),a=uk(n,o),l;if(e&&r!=r){for(;o>a;)if(l=i[a++],l!=l)return!0}else for(;o>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},dv={includes:km(!0),indexOf:km(!1)},fk=ee,Bc=Ae,hk=Ft,dk=dv.indexOf,vk=ml,Am=fk([].push),QO=function(e,t){var r=hk(e),n=0,i=[],o;for(o in r)!Bc(vk,o)&&Bc(r,o)&&Am(i,o);for(;t.length>n;)Bc(r,o=t[n++])&&(~dk(i,o)||Am(i,o));return i},vv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],yk=QO,mk=vv,gk=mk.concat("length","prototype");Kn.f=Object.getOwnPropertyNames||function(t){return yk(t,gk)};var pl={};pl.f=Object.getOwnPropertySymbols;var pk=Yr,bk=ee,wk=Kn,Sk=pl,Ok=Ve,Ck=bk([].concat),JO=pk("Reflect","ownKeys")||function(t){var r=wk.f(Ok(t)),n=Sk.f;return n?Ck(r,n(t)):r},Mm=Ae,_k=JO,Tk=Ur,Rk=Ot,eC=function(e,t,r){for(var n=_k(t),i=Rk.f,o=Tk.f,a=0;a<n.length;a++){var l=n[a];!Mm(e,l)&&!(r&&Mm(r,l))&&i(e,l,o(t,l))}},Ek=Q,$k=Ee,Pk=/#|\.prototype\./,bl=function(e,t){var r=kk[Ik(e)];return r==Mk?!0:r==Ak?!1:$k(t)?Ek(t):!!t},Ik=bl.normalize=function(e){return String(e).replace(Pk,".").toLowerCase()},kk=bl.data={},Ak=bl.NATIVE="N",Mk=bl.POLYFILL="P",Uu=bl,zc=be,xk=Ur.f,Nk=Gn,Dk=qt,Hk=uv,Lk=eC,Fk=Uu,K=function(e,t){var r=e.target,n=e.global,i=e.stat,o,a,l,s,u,c;if(n?a=zc:i?a=zc[r]||Hk(r,{}):a=(zc[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(c=xk(a,l),s=c&&c.value):s=a[l],o=Fk(n?l:r+(i?".":"#")+l,e.forced),!o&&s!==void 0){if(typeof u==typeof s)continue;Lk(u,s)}(e.sham||s&&s.sham)&&Nk(u,"sham",!0),Dk(a,l,u,e)}},jk=Oe,Vk=jk("toStringTag"),tC={};tC[Vk]="z";var yv=String(tC)==="[object z]",Wk=yv,Bk=Ee,Ss=Tr,zk=Oe,Uk=zk("toStringTag"),Yk=Object,Gk=Ss(function(){return arguments}())=="Arguments",Kk=function(e,t){try{return e[t]}catch{}},Yu=Wk?Ss:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=Kk(t=Yk(e),Uk))=="string"?r:Gk?Ss(t):(n=Ss(t))=="Object"&&Bk(t.callee)?"Arguments":n},Xk=Yu,qk=String,Je=function(e){if(Xk(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return qk(e)},mv={},Zk=QO,Qk=vv,wl=Object.keys||function(t){return Zk(t,Qk)},Jk=Fe,eA=YO,tA=Ot,rA=Ve,nA=Ft,iA=wl;mv.f=Jk&&!eA?Object.defineProperties:function(t,r){rA(t);for(var n=nA(r),i=iA(r),o=i.length,a=0,l;o>a;)tA.f(t,l=i[a++],n[l]);return t};var oA=Yr,rC=oA("document","documentElement"),aA=Ve,lA=mv,xm=vv,sA=ml,uA=rC,cA=Bu,fA=zu,Nm=">",Dm="<",yh="prototype",mh="script",nC=fA("IE_PROTO"),Uc=function(){},iC=function(e){return Dm+mh+Nm+e+Dm+"/"+mh+Nm},Hm=function(e){e.write(iC("")),e.close();var t=e.parentWindow.Object;return e=null,t},hA=function(){var e=cA("iframe"),t="java"+mh+":",r;return e.style.display="none",uA.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(iC("document.F=Object")),r.close(),r.F},Ul,Os=function(){try{Ul=new ActiveXObject("htmlfile")}catch{}Os=typeof document<"u"?document.domain&&Ul?Hm(Ul):hA():Hm(Ul);for(var e=xm.length;e--;)delete Os[yh][xm[e]];return Os()};sA[nC]=!0;var yo=Object.create||function(t,r){var n;return t!==null?(Uc[yh]=aA(t),n=new Uc,Uc[yh]=null,n[nC]=t):n=Os(),r===void 0?n:lA.f(n,r)},gv={},dA=Wu,vA=Ot,yA=fl,mo=function(e,t,r){var n=dA(t);n in e?vA.f(e,n,yA(0,r)):e[n]=r},Lm=gl,mA=Zt,gA=mo,pA=Array,bA=Math.max,pv=function(e,t,r){for(var n=mA(e),i=Lm(t,n),o=Lm(r===void 0?n:r,n),a=pA(bA(o-i,0)),l=0;i<o;i++,l++)gA(a,l,e[i]);return a.length=l,a},wA=Tr,SA=Ft,oC=Kn.f,OA=pv,aC=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],CA=function(e){try{return oC(e)}catch{return OA(aC)}};gv.f=function(t){return aC&&wA(t)=="Window"?CA(t):oC(SA(t))};var Fm=zs,_A=Ot,Sl=function(e,t,r){return r.get&&Fm(r.get,t,{getter:!0}),r.set&&Fm(r.set,t,{setter:!0}),_A.f(e,t,r)},bv={},TA=Oe;bv.f=TA;var RA=be,lC=RA,jm=lC,EA=Ae,$A=bv,PA=Ot.f,wv=function(e){var t=jm.Symbol||(jm.Symbol={});EA(t,e)||PA(t,e,{value:$A.f(e)})},IA=Ge,kA=Yr,AA=Oe,MA=qt,sC=function(){var e=kA("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=AA("toPrimitive");t&&!t[n]&&MA(t,n,function(i){return IA(r,this)},{arity:1})},xA=Ot.f,NA=Ae,DA=Oe,Vm=DA("toStringTag"),Gu=function(e,t,r){e&&!r&&(e=e.prototype),e&&!NA(e,Vm)&&xA(e,Vm,{configurable:!0,value:t})},HA=Tr,LA=ee,Ku=function(e){if(HA(e)==="Function")return LA(e)},Wm=Ku,FA=Yn,jA=ul,VA=Wm(Wm.bind),Ol=function(e,t){return FA(e),t===void 0?e:jA?VA(e,t):function(){return e.apply(t,arguments)}},WA=Tr,go=Array.isArray||function(t){return WA(t)=="Array"},BA=ee,zA=Q,uC=Ee,UA=Yu,YA=Yr,GA=KO,cC=function(){},KA=[],fC=YA("Reflect","construct"),Sv=/^\s*(?:class|function)\b/,XA=BA(Sv.exec),qA=!Sv.exec(cC),To=function(t){if(!uC(t))return!1;try{return fC(cC,KA,t),!0}catch{return!1}},hC=function(t){if(!uC(t))return!1;switch(UA(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return qA||!!XA(Sv,GA(t))}catch{return!0}};hC.sham=!0;var Xu=!fC||zA(function(){var e;return To(To.call)||!To(Object)||!To(function(){e=!0})||e})?hC:To,Bm=go,ZA=Xu,QA=je,JA=Oe,eM=JA("species"),zm=Array,tM=function(e){var t;return Bm(e)&&(t=e.constructor,ZA(t)&&(t===zm||Bm(t.prototype))?t=void 0:QA(t)&&(t=t[eM],t===null&&(t=void 0))),t===void 0?zm:t},rM=tM,Ov=function(e,t){return new(rM(e))(t===0?0:t)},nM=Ol,iM=ee,oM=hl,aM=It,lM=Zt,sM=Ov,Um=iM([].push),Qr=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,o=e==6,a=e==7,l=e==5||o;return function(s,u,c,f){for(var h=aM(s),v=oM(h),m=nM(u,c),p=lM(v),b=0,C=f||sM,T=t?C(s,p):r||a?C(s,0):void 0,I,P;p>b;b++)if((l||b in v)&&(I=v[b],P=m(I,b,h),e))if(t)T[b]=P;else if(P)switch(e){case 3:return!0;case 5:return I;case 6:return b;case 2:Um(T,I)}else switch(e){case 4:return!1;case 7:Um(T,I)}return o?-1:n||i?i:T}},qn={forEach:Qr(0),map:Qr(1),filter:Qr(2),some:Qr(3),every:Qr(4),find:Qr(5),findIndex:Qr(6),filterReject:Qr(7)},qu=K,Cv=be,_v=Ge,uM=ee,Ri=Fe,Ei=co,cM=Q,Ze=Ae,fM=yn,gh=Ve,Zu=Ft,Tv=Wu,hM=Je,ph=fl,ea=yo,dC=wl,dM=Kn,vC=gv,vM=pl,yC=Ur,mC=Ot,yM=mv,gC=cl,Yc=qt,mM=Sl,Rv=dn,gM=zu,pC=ml,Ym=Vu,pM=Oe,bM=bv,wM=wv,SM=sC,OM=Gu,bC=Gr,Qu=qn.forEach,Et=gM("hidden"),Ju="Symbol",ta="prototype",CM=bC.set,Gm=bC.getterFor(Ju),Gt=Object[ta],kn=Cv.Symbol,Wo=kn&&kn[ta],_M=Cv.TypeError,Gc=Cv.QObject,wC=yC.f,En=mC.f,SC=vC.f,TM=gC.f,OC=uM([].push),jr=Rv("symbols"),Cl=Rv("op-symbols"),RM=Rv("wks"),bh=!Gc||!Gc[ta]||!Gc[ta].findChild,wh=Ri&&cM(function(){return ea(En({},"a",{get:function(){return En(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=wC(Gt,t);n&&delete Gt[t],En(e,t,r),n&&e!==Gt&&En(Gt,t,n)}:En,Kc=function(e,t){var r=jr[e]=ea(Wo);return CM(r,{type:Ju,tag:e,description:t}),Ri||(r.description=t),r},ec=function(t,r,n){t===Gt&&ec(Cl,r,n),gh(t);var i=Tv(r);return gh(n),Ze(jr,i)?(n.enumerable?(Ze(t,Et)&&t[Et][i]&&(t[Et][i]=!1),n=ea(n,{enumerable:ph(0,!1)})):(Ze(t,Et)||En(t,Et,ph(1,{})),t[Et][i]=!0),wh(t,i,n)):En(t,i,n)},Ev=function(t,r){gh(t);var n=Zu(r),i=dC(n).concat(TC(n));return Qu(i,function(o){(!Ri||_v(Sh,n,o))&&ec(t,o,n[o])}),t},EM=function(t,r){return r===void 0?ea(t):Ev(ea(t),r)},Sh=function(t){var r=Tv(t),n=_v(TM,this,r);return this===Gt&&Ze(jr,r)&&!Ze(Cl,r)?!1:n||!Ze(this,r)||!Ze(jr,r)||Ze(this,Et)&&this[Et][r]?n:!0},CC=function(t,r){var n=Zu(t),i=Tv(r);if(!(n===Gt&&Ze(jr,i)&&!Ze(Cl,i))){var o=wC(n,i);return o&&Ze(jr,i)&&!(Ze(n,Et)&&n[Et][i])&&(o.enumerable=!0),o}},_C=function(t){var r=SC(Zu(t)),n=[];return Qu(r,function(i){!Ze(jr,i)&&!Ze(pC,i)&&OC(n,i)}),n},TC=function(e){var t=e===Gt,r=SC(t?Cl:Zu(e)),n=[];return Qu(r,function(i){Ze(jr,i)&&(!t||Ze(Gt,i))&&OC(n,jr[i])}),n};Ei||(kn=function(){if(fM(Wo,this))throw _M("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:hM(arguments[0]),r=Ym(t),n=function(i){this===Gt&&_v(n,Cl,i),Ze(this,Et)&&Ze(this[Et],r)&&(this[Et][r]=!1),wh(this,r,ph(1,i))};return Ri&&bh&&wh(Gt,r,{configurable:!0,set:n}),Kc(r,t)},Wo=kn[ta],Yc(Wo,"toString",function(){return Gm(this).tag}),Yc(kn,"withoutSetter",function(e){return Kc(Ym(e),e)}),gC.f=Sh,mC.f=ec,yM.f=Ev,yC.f=CC,dM.f=vC.f=_C,vM.f=TC,bM.f=function(e){return Kc(pM(e),e)},Ri&&(mM(Wo,"description",{configurable:!0,get:function(){return Gm(this).description}}),Yc(Gt,"propertyIsEnumerable",Sh,{unsafe:!0})));qu({global:!0,constructor:!0,wrap:!0,forced:!Ei,sham:!Ei},{Symbol:kn});Qu(dC(RM),function(e){wM(e)});qu({target:Ju,stat:!0,forced:!Ei},{useSetter:function(){bh=!0},useSimple:function(){bh=!1}});qu({target:"Object",stat:!0,forced:!Ei,sham:!Ri},{create:EM,defineProperty:ec,defineProperties:Ev,getOwnPropertyDescriptor:CC});qu({target:"Object",stat:!0,forced:!Ei},{getOwnPropertyNames:_C});SM();OM(kn,Ju);pC[Et]=!0;var $M=co,RC=$M&&!!Symbol.for&&!!Symbol.keyFor,PM=K,IM=Yr,kM=Ae,AM=Je,EC=dn,MM=RC,Xc=EC("string-to-symbol-registry"),xM=EC("symbol-to-string-registry");PM({target:"Symbol",stat:!0,forced:!MM},{for:function(e){var t=AM(e);if(kM(Xc,t))return Xc[t];var r=IM("Symbol")(t);return Xc[t]=r,xM[r]=t,r}});var NM=K,DM=Ae,HM=vl,LM=fo,FM=dn,jM=RC,Km=FM("symbol-to-string-registry");NM({target:"Symbol",stat:!0,forced:!jM},{keyFor:function(t){if(!HM(t))throw TypeError(LM(t)+" is not a symbol");if(DM(Km,t))return Km[t]}});var VM=ul,$C=Function.prototype,Xm=$C.apply,qm=$C.call,Zn=typeof Reflect=="object"&&Reflect.apply||(VM?qm.bind(Xm):function(){return qm.apply(Xm,arguments)}),WM=ee,_l=WM([].slice),BM=ee,Zm=go,zM=Ee,Qm=Tr,UM=Je,Jm=BM([].push),YM=function(e){if(zM(e))return e;if(Zm(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?Jm(r,i):(typeof i=="number"||Qm(i)=="Number"||Qm(i)=="String")&&Jm(r,UM(i))}var o=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(Zm(this))return s;for(var u=0;u<o;u++)if(r[u]===l)return s}}},GM=K,PC=Yr,IC=Zn,KM=Ge,Tl=ee,kC=Q,eg=Ee,tg=vl,AC=_l,XM=YM,qM=co,ZM=String,un=PC("JSON","stringify"),Yl=Tl(/./.exec),rg=Tl("".charAt),QM=Tl("".charCodeAt),JM=Tl("".replace),e1=Tl(1 .toString),t1=/[\uD800-\uDFFF]/g,ng=/^[\uD800-\uDBFF]$/,ig=/^[\uDC00-\uDFFF]$/,og=!qM||kC(function(){var e=PC("Symbol")();return un([e])!="[null]"||un({a:e})!="{}"||un(Object(e))!="{}"}),ag=kC(function(){return un("\uDF06\uD834")!=='"\\udf06\\ud834"'||un("\uDEAD")!=='"\\udead"'}),r1=function(e,t){var r=AC(arguments),n=XM(t);if(!(!eg(n)&&(e===void 0||tg(e))))return r[1]=function(i,o){if(eg(n)&&(o=KM(n,this,ZM(i),o)),!tg(o))return o},IC(un,null,r)},n1=function(e,t,r){var n=rg(r,t-1),i=rg(r,t+1);return Yl(ng,e)&&!Yl(ig,i)||Yl(ig,e)&&!Yl(ng,n)?"\\u"+e1(QM(e,0),16):e};un&&GM({target:"JSON",stat:!0,arity:3,forced:og||ag},{stringify:function(t,r,n){var i=AC(arguments),o=IC(og?r1:un,null,i);return ag&&typeof o=="string"?JM(o,t1,n1):o}});var i1=K,o1=co,a1=Q,MC=pl,l1=It,s1=!o1||a1(function(){MC.f(1)});i1({target:"Object",stat:!0,forced:s1},{getOwnPropertySymbols:function(t){var r=MC.f;return r?r(l1(t)):[]}});var u1=K,c1=Fe,f1=be,Gl=ee,h1=Ae,d1=Ee,v1=yn,y1=Je,m1=Sl,g1=eC,xr=f1.Symbol,bn=xr&&xr.prototype;if(c1&&d1(xr)&&(!("description"in bn)||xr().description!==void 0)){var lg={},Kl=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:y1(arguments[0]),r=v1(bn,this)?new xr(t):t===void 0?xr():xr(t);return t===""&&(lg[r]=!0),r};g1(Kl,xr),Kl.prototype=bn,bn.constructor=Kl;var p1=String(xr("test"))=="Symbol(test)",b1=Gl(bn.valueOf),w1=Gl(bn.toString),S1=/^Symbol\((.*)\)[^)]+$/,O1=Gl("".replace),C1=Gl("".slice);m1(bn,"description",{configurable:!0,get:function(){var t=b1(this);if(h1(lg,t))return"";var r=w1(t),n=p1?C1(r,7,-1):O1(r,S1,"$1");return n===""?void 0:n}}),u1({global:!0,constructor:!0,forced:!0},{Symbol:Kl})}var _1=wv;_1("iterator");var T1=Fe,R1=yl.EXISTS,xC=ee,E1=Sl,NC=Function.prototype,$1=xC(NC.toString),DC=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,P1=xC(DC.exec),I1="name";T1&&!R1&&E1(NC,I1,{configurable:!0,get:function(){try{return P1(DC,$1(this))[1]}catch{return""}}});var k1=Q,$v=!k1(function(){return Object.isExtensible(Object.preventExtensions({}))}),xn={},A1={get exports(){return xn},set exports(e){xn=e}},M1=Q,x1=M1(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),N1=Q,D1=je,H1=Tr,sg=x1,Cs=Object.isExtensible,L1=N1(function(){Cs(1)}),F1=L1||sg?function(t){return!D1(t)||sg&&H1(t)=="ArrayBuffer"?!1:Cs?Cs(t):!0}:Cs,j1=K,V1=ee,W1=ml,B1=je,Pv=Ae,z1=Ot.f,ug=Kn,U1=gv,Iv=F1,Y1=Vu,G1=$v,HC=!1,Vr=Y1("meta"),K1=0,kv=function(e){z1(e,Vr,{value:{objectID:"O"+K1++,weakData:{}}})},X1=function(e,t){if(!B1(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!Pv(e,Vr)){if(!Iv(e))return"F";if(!t)return"E";kv(e)}return e[Vr].objectID},q1=function(e,t){if(!Pv(e,Vr)){if(!Iv(e))return!0;if(!t)return!1;kv(e)}return e[Vr].weakData},Z1=function(e){return G1&&HC&&Iv(e)&&!Pv(e,Vr)&&kv(e),e},Q1=function(){J1.enable=function(){},HC=!0;var e=ug.f,t=V1([].splice),r={};r[Vr]=1,e(r).length&&(ug.f=function(n){for(var i=e(n),o=0,a=i.length;o<a;o++)if(i[o]===Vr){t(i,o,1);break}return i},j1({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:U1.f}))},J1=A1.exports={enable:Q1,fastKey:X1,getWeakData:q1,onFreeze:Z1};W1[Vr]=!0;var ex=K,tx=$v,rx=Q,nx=je,ix=xn.onFreeze,Oh=Object.freeze,ox=rx(function(){Oh(1)});ex({target:"Object",stat:!0,forced:ox,sham:!tx},{freeze:function(t){return Oh&&nx(t)?Oh(ix(t)):t}});var ax=Oe,lx=yo,sx=Ot.f,Ch=ax("unscopables"),_h=Array.prototype;_h[Ch]==null&&sx(_h,Ch,{configurable:!0,value:lx(null)});var Rl=function(e){_h[Ch][e]=!0},El={},ux=Q,LC=!ux(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),cx=Ae,fx=Ee,hx=It,dx=zu,vx=LC,cg=dx("IE_PROTO"),Th=Object,yx=Th.prototype,tc=vx?Th.getPrototypeOf:function(e){var t=hx(e);if(cx(t,cg))return t[cg];var r=t.constructor;return fx(r)&&t instanceof r?r.prototype:t instanceof Th?yx:null},mx=Q,gx=Ee,px=je,fg=tc,bx=qt,wx=Oe,Rh=wx("iterator"),FC=!1,Nn,qc,Zc;[].keys&&(Zc=[].keys(),"next"in Zc?(qc=fg(fg(Zc)),qc!==Object.prototype&&(Nn=qc)):FC=!0);var Sx=!px(Nn)||mx(function(){var e={};return Nn[Rh].call(e)!==e});Sx&&(Nn={});gx(Nn[Rh])||bx(Nn,Rh,function(){return this});var jC={IteratorPrototype:Nn,BUGGY_SAFARI_ITERATORS:FC},Ox=jC.IteratorPrototype,Cx=yo,_x=fl,Tx=Gu,Rx=El,Ex=function(){return this},$x=function(e,t,r,n){var i=t+" Iterator";return e.prototype=Cx(Ox,{next:_x(+!n,r)}),Tx(e,i,!1),Rx[i]=Ex,e},Px=ee,Ix=Yn,kx=function(e,t,r){try{return Px(Ix(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},Ax=Ee,Mx=String,xx=TypeError,Nx=function(e){if(typeof e=="object"||Ax(e))return e;throw xx("Can't set "+Mx(e)+" as a prototype")},Dx=kx,Hx=Ve,Lx=Nx,Av=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=Dx(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,o){return Hx(i),Lx(o),e?r(i,o):i.__proto__=o,i}}():void 0),Fx=K,jx=Ge,VC=yl,Vx=Ee,Wx=$x,hg=tc,dg=Av,Bx=Gu,zx=Gn,Qc=qt,Ux=Oe,Yx=El,WC=jC,Gx=VC.PROPER,Kx=VC.CONFIGURABLE,vg=WC.IteratorPrototype,Xl=WC.BUGGY_SAFARI_ITERATORS,Ro=Ux("iterator"),yg="keys",Eo="values",mg="entries",Xx=function(){return this},Mv=function(e,t,r,n,i,o,a){Wx(r,t,n);var l=function(C){if(C===i&&h)return h;if(!Xl&&C in c)return c[C];switch(C){case yg:return function(){return new r(this,C)};case Eo:return function(){return new r(this,C)};case mg:return function(){return new r(this,C)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,c=e.prototype,f=c[Ro]||c["@@iterator"]||i&&c[i],h=!Xl&&f||l(i),v=t=="Array"&&c.entries||f,m,p,b;if(v&&(m=hg(v.call(new e)),m!==Object.prototype&&m.next&&(hg(m)!==vg&&(dg?dg(m,vg):Vx(m[Ro])||Qc(m,Ro,Xx)),Bx(m,s,!0))),Gx&&i==Eo&&f&&f.name!==Eo&&(Kx?zx(c,"name",Eo):(u=!0,h=function(){return jx(f,this)})),i)if(p={values:l(Eo),keys:o?h:l(yg),entries:l(mg)},a)for(b in p)(Xl||u||!(b in c))&&Qc(c,b,p[b]);else Fx({target:t,proto:!0,forced:Xl||u},p);return c[Ro]!==h&&Qc(c,Ro,h,{name:i}),Yx[t]=h,p},xv=function(e,t){return{value:e,done:t}},qx=Ft,Nv=Rl,gg=El,BC=Gr,Zx=Ot.f,Qx=Mv,ql=xv,Jx=Fe,zC="Array Iterator",eN=BC.set,tN=BC.getterFor(zC),rN=Qx(Array,"Array",function(e,t){eN(this,{type:zC,target:qx(e),index:0,kind:t})},function(){var e=tN(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,ql(void 0,!0)):r=="keys"?ql(n,!1):r=="values"?ql(t[n],!1):ql([n,t[n]],!1)},"values"),pg=gg.Arguments=gg.Array;Nv("keys");Nv("values");Nv("entries");if(Jx&&pg.name!=="values")try{Zx(pg,"name",{value:"values"})}catch{}var nN=yv,iN=Yu,oN=nN?{}.toString:function(){return"[object "+iN(this)+"]"},aN=yv,lN=qt,sN=oN;aN||lN(Object.prototype,"toString",sN,{unsafe:!0});var uN=Oe,cN=El,fN=uN("iterator"),hN=Array.prototype,UC=function(e){return e!==void 0&&(cN.Array===e||hN[fN]===e)},dN=Yu,bg=ho,vN=Rr,yN=El,mN=Oe,gN=mN("iterator"),Dv=function(e){if(!vN(e))return bg(e,gN)||bg(e,"@@iterator")||yN[dN(e)]},pN=Ge,bN=Yn,wN=Ve,SN=fo,ON=Dv,CN=TypeError,YC=function(e,t){var r=arguments.length<2?ON(e):t;if(bN(r))return wN(pN(r,e));throw CN(SN(e)+" is not iterable")},_N=Ge,wg=Ve,TN=ho,GC=function(e,t,r){var n,i;wg(e);try{if(n=TN(e,"return"),!n){if(t==="throw")throw r;return r}n=_N(n,e)}catch(o){i=!0,n=o}if(t==="throw")throw r;if(i)throw n;return wg(n),r},RN=Ol,EN=Ge,$N=Ve,PN=fo,IN=UC,kN=Zt,Sg=yn,AN=YC,MN=Dv,Og=GC,xN=TypeError,_s=function(e,t){this.stopped=e,this.result=t},Cg=_s.prototype,Hv=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=RN(t,n),u,c,f,h,v,m,p,b=function(T){return u&&Og(u,"normal",T),new _s(!0,T)},C=function(T){return i?($N(T),l?s(T[0],T[1],b):s(T[0],T[1])):l?s(T,b):s(T)};if(o)u=e.iterator;else if(a)u=e;else{if(c=MN(e),!c)throw xN(PN(e)+" is not iterable");if(IN(c)){for(f=0,h=kN(e);h>f;f++)if(v=C(e[f]),v&&Sg(Cg,v))return v;return new _s(!1)}u=AN(e,c)}for(m=o?e.next:u.next;!(p=EN(m,u)).done;){try{v=C(p.value)}catch(T){Og(u,"throw",T)}if(typeof v=="object"&&v&&Sg(Cg,v))return v}return new _s(!1)},NN=yn,DN=TypeError,Lv=function(e,t){if(NN(t,e))return e;throw DN("Incorrect invocation")},HN=Oe,KC=HN("iterator"),XC=!1;try{var LN=0,_g={next:function(){return{done:!!LN++}},return:function(){XC=!0}};_g[KC]=function(){return this},Array.from(_g,function(){throw 2})}catch{}var qC=function(e,t){if(!t&&!XC)return!1;var r=!1;try{var n={};n[KC]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},FN=Ee,jN=je,Tg=Av,Fv=function(e,t,r){var n,i;return Tg&&FN(n=t.constructor)&&n!==r&&jN(i=n.prototype)&&i!==r.prototype&&Tg(e,i),e},VN=K,WN=be,BN=ee,Rg=Uu,zN=qt,UN=xn,YN=Hv,GN=Lv,KN=Ee,XN=Rr,Jc=je,ef=Q,qN=qC,ZN=Gu,QN=Fv,jv=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,o=n?"set":"add",a=WN[e],l=a&&a.prototype,s=a,u={},c=function(C){var T=BN(l[C]);zN(l,C,C=="add"?function(P){return T(this,P===0?0:P),this}:C=="delete"?function(I){return i&&!Jc(I)?!1:T(this,I===0?0:I)}:C=="get"?function(P){return i&&!Jc(P)?void 0:T(this,P===0?0:P)}:C=="has"?function(P){return i&&!Jc(P)?!1:T(this,P===0?0:P)}:function(P,E){return T(this,P===0?0:P,E),this})},f=Rg(e,!KN(a)||!(i||l.forEach&&!ef(function(){new a().entries().next()})));if(f)s=r.getConstructor(t,e,n,o),UN.enable();else if(Rg(e,!0)){var h=new s,v=h[o](i?{}:-0,1)!=h,m=ef(function(){h.has(1)}),p=qN(function(C){new a(C)}),b=!i&&ef(function(){for(var C=new a,T=5;T--;)C[o](T,T);return!C.has(-0)});p||(s=t(function(C,T){GN(C,l);var I=QN(new a,C,s);return XN(T)||YN(T,I[o],{that:I,AS_ENTRIES:n}),I}),s.prototype=l,l.constructor=s),(m||b)&&(c("delete"),c("has"),n&&c("get")),(b||v)&&c(o),i&&l.clear&&delete l.clear}return u[e]=s,VN({global:!0,constructor:!0,forced:s!=a},u),ZN(s,e),i||r.setStrong(s,e,n),s},JN=qt,Vv=function(e,t,r){for(var n in t)JN(e,n,t[n],r);return e},eD=Yr,tD=Sl,rD=Oe,nD=Fe,Eg=rD("species"),ZC=function(e){var t=eD(e);nD&&t&&!t[Eg]&&tD(t,Eg,{configurable:!0,get:function(){return this}})},iD=yo,oD=Sl,$g=Vv,aD=Ol,lD=Lv,sD=Rr,uD=Hv,cD=Mv,Zl=xv,fD=ZC,$o=Fe,Pg=xn.fastKey,QC=Gr,Ig=QC.set,tf=QC.getterFor,JC={getConstructor:function(e,t,r,n){var i=e(function(u,c){lD(u,o),Ig(u,{type:t,index:iD(null),first:void 0,last:void 0,size:0}),$o||(u.size=0),sD(c)||uD(c,u[n],{that:u,AS_ENTRIES:r})}),o=i.prototype,a=tf(t),l=function(u,c,f){var h=a(u),v=s(u,c),m,p;return v?v.value=f:(h.last=v={index:p=Pg(c,!0),key:c,value:f,previous:m=h.last,next:void 0,removed:!1},h.first||(h.first=v),m&&(m.next=v),$o?h.size++:u.size++,p!=="F"&&(h.index[p]=v)),u},s=function(u,c){var f=a(u),h=Pg(c),v;if(h!=="F")return f.index[h];for(v=f.first;v;v=v.next)if(v.key==c)return v};return $g(o,{clear:function(){for(var c=this,f=a(c),h=f.index,v=f.first;v;)v.removed=!0,v.previous&&(v.previous=v.previous.next=void 0),delete h[v.index],v=v.next;f.first=f.last=void 0,$o?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),h=s(c,u);if(h){var v=h.next,m=h.previous;delete f.index[h.index],h.removed=!0,m&&(m.next=v),v&&(v.previous=m),f.first==h&&(f.first=v),f.last==h&&(f.last=m),$o?f.size--:c.size--}return!!h},forEach:function(c){for(var f=a(this),h=aD(c,arguments.length>1?arguments[1]:void 0),v;v=v?v.next:f.first;)for(h(v.value,v.key,this);v&&v.removed;)v=v.previous},has:function(c){return!!s(this,c)}}),$g(o,r?{get:function(c){var f=s(this,c);return f&&f.value},set:function(c,f){return l(this,c===0?0:c,f)}}:{add:function(c){return l(this,c=c===0?0:c,c)}}),$o&&oD(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=tf(t),o=tf(n);cD(e,t,function(a,l){Ig(this,{type:n,target:a,state:i(a),kind:l,last:void 0})},function(){for(var a=o(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Zl(void 0,!0)):l=="keys"?Zl(s.key,!1):l=="values"?Zl(s.value,!1):Zl([s.key,s.value],!1)},r?"entries":"values",!r,!0),fD(t)}},hD=jv,dD=JC;hD("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},dD);var Wv=ee,vD=Xn,yD=Je,mD=cr,gD=Wv("".charAt),kg=Wv("".charCodeAt),pD=Wv("".slice),Ag=function(e){return function(t,r){var n=yD(mD(t)),i=vD(r),o=n.length,a,l;return i<0||i>=o?e?"":void 0:(a=kg(n,i),a<55296||a>56319||i+1===o||(l=kg(n,i+1))<56320||l>57343?e?gD(n,i):a:e?pD(n,i,i+2):(a-55296<<10)+(l-56320)+65536)}},Bv={codeAt:Ag(!1),charAt:Ag(!0)},bD=Bv.charAt,wD=Je,e_=Gr,SD=Mv,Mg=xv,t_="String Iterator",OD=e_.set,CD=e_.getterFor(t_);SD(String,"String",function(e){OD(this,{type:t_,string:wD(e),index:0})},function(){var t=CD(this),r=t.string,n=t.index,i;return n>=r.length?Mg(void 0,!0):(i=bD(r,n),t.index+=i.length,Mg(i,!1))});var r_={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},_D=Bu,rf=_D("span").classList,xg=rf&&rf.constructor&&rf.constructor.prototype,n_=xg===Object.prototype?void 0:xg,Ng=be,i_=r_,TD=n_,Bo=rN,nf=Gn,o_=Oe,of=o_("iterator"),Dg=o_("toStringTag"),af=Bo.values,a_=function(e,t){if(e){if(e[of]!==af)try{nf(e,of,af)}catch{e[of]=af}if(e[Dg]||nf(e,Dg,t),i_[t]){for(var r in Bo)if(e[r]!==Bo[r])try{nf(e,r,Bo[r])}catch{e[r]=Bo[r]}}}};for(var lf in i_)a_(Ng[lf]&&Ng[lf].prototype,lf);a_(TD,"DOMTokenList");var RD=K,ED=dv.includes,$D=Q,PD=Rl,ID=$D(function(){return!Array(1).includes()});RD({target:"Array",proto:!0,forced:ID},{includes:function(t){return ED(this,t,arguments.length>1?arguments[1]:void 0)}});PD("includes");var Hg=fo,kD=TypeError,l_=function(e,t){if(!delete e[t])throw kD("Cannot delete property "+Hg(t)+" of "+Hg(e))},Lg=pv,AD=Math.floor,Eh=function(e,t){var r=e.length,n=AD(r/2);return r<8?MD(e,t):xD(e,Eh(Lg(e,0,n),t),Eh(Lg(e,n),t),t)},MD=function(e,t){for(var r=e.length,n=1,i,o;n<r;){for(o=n,i=e[n];o&&t(e[o-1],i)>0;)e[o]=e[--o];o!==n++&&(e[o]=i)}return e},xD=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,l=0;a<i||l<o;)e[a+l]=a<i&&l<o?n(t[a],r[l])<=0?t[a++]:r[l++]:a<i?t[a++]:r[l++];return e},ND=Eh,DD=Q,po=function(e,t){var r=[][e];return!!r&&DD(function(){r.call(null,t||function(){return 1},1)})},HD=Un,Fg=HD.match(/firefox\/(\d+)/i),LD=!!Fg&&+Fg[1],FD=Un,jD=/MSIE|Trident/.test(FD),VD=Un,jg=VD.match(/AppleWebKit\/(\d+)\./),WD=!!jg&&+jg[1],BD=K,s_=ee,zD=Yn,UD=It,Vg=Zt,YD=l_,Wg=Je,zv=Q,GD=ND,KD=po,Bg=LD,XD=jD,zg=dl,Ug=WD,on=[],Yg=s_(on.sort),qD=s_(on.push),ZD=zv(function(){on.sort(void 0)}),QD=zv(function(){on.sort(null)}),JD=KD("sort"),u_=!zv(function(){if(zg)return zg<70;if(!(Bg&&Bg>3)){if(XD)return!0;if(Ug)return Ug<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)on.push({k:r+i,v:n})}for(on.sort(function(o,a){return a.v-o.v}),i=0;i<on.length;i++)r=on[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),eH=ZD||!QD||!JD||!u_,tH=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:Wg(t)>Wg(r)?1:-1}};BD({target:"Array",proto:!0,forced:eH},{sort:function(t){t!==void 0&&zD(t);var r=UD(this);if(u_)return t===void 0?Yg(r):Yg(r,t);var n=[],i=Vg(r),o,a;for(a=0;a<i;a++)a in r&&qD(n,r[a]);for(GD(n,tH(t)),o=Vg(n),a=0;a<o;)r[a]=n[a++];for(;a<i;)YD(r,a++);return r}});var rH=Fe,nH=go,iH=TypeError,oH=Object.getOwnPropertyDescriptor,aH=rH&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),lH=aH?function(e,t){if(nH(e)&&!oH(e,"length").writable)throw iH("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},sH=TypeError,uH=9007199254740991,c_=function(e){if(e>uH)throw sH("Maximum allowed index exceeded");return e},cH=Q,fH=Oe,hH=dl,dH=fH("species"),$l=function(e){return hH>=51||!cH(function(){var t=[],r=t.constructor={};return r[dH]=function(){return{foo:1}},t[e](Boolean).foo!==1})},vH=K,yH=It,mH=gl,gH=Xn,pH=Zt,bH=lH,wH=c_,SH=Ov,OH=mo,sf=l_,CH=$l,_H=CH("splice"),TH=Math.max,RH=Math.min;vH({target:"Array",proto:!0,forced:!_H},{splice:function(t,r){var n=yH(this),i=pH(n),o=mH(t,i),a=arguments.length,l,s,u,c,f,h;for(a===0?l=s=0:a===1?(l=0,s=i-o):(l=a-2,s=RH(TH(gH(r),0),i-o)),wH(i+l-s),u=SH(n,s),c=0;c<s;c++)f=o+c,f in n&&OH(u,c,n[f]);if(u.length=s,l<s){for(c=o;c<i-s;c++)f=c+s,h=c+l,f in n?n[h]=n[f]:sf(n,h);for(c=i;c>i-s+l;c--)sf(n,c-1)}else if(l>s)for(c=i-s;c>o;c--)f=c+s-1,h=c+l-1,f in n?n[h]=n[f]:sf(n,h);for(c=0;c<l;c++)n[c+o]=arguments[c+2];return bH(n,i-s+l),u}});var EH=je,$H=Math.floor,PH=Number.isInteger||function(t){return!EH(t)&&isFinite(t)&&$H(t)===t},IH=K,kH=PH;IH({target:"Number",stat:!0},{isInteger:kH});var AH=ee,MH=AH(1 .valueOf),f_=`	
\v\f\r                　\u2028\u2029\uFEFF`,xH=ee,NH=cr,DH=Je,$h=f_,Gg=xH("".replace),HH=RegExp("^["+$h+"]+"),LH=RegExp("(^|[^"+$h+"])["+$h+"]+$"),uf=function(e){return function(t){var r=DH(NH(t));return e&1&&(r=Gg(r,HH,"")),e&2&&(r=Gg(r,LH,"$1")),r}},h_={start:uf(1),end:uf(2),trim:uf(3)},FH=K,d_=mP,jH=Fe,v_=be,y_=lC,m_=ee,VH=Uu,Kg=Ae,WH=Fv,BH=yn,zH=vl,g_=zO,UH=Q,YH=Kn.f,GH=Ur.f,KH=Ot.f,XH=MH,qH=h_.trim,rc="Number",wi=v_[rc];y_[rc];var Uv=wi.prototype,ZH=v_.TypeError,QH=m_("".slice),Ql=m_("".charCodeAt),JH=function(e){var t=g_(e,"number");return typeof t=="bigint"?t:eL(t)},eL=function(e){var t=g_(e,"number"),r,n,i,o,a,l,s,u;if(zH(t))throw ZH("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=qH(t),r=Ql(t,0),r===43||r===45){if(n=Ql(t,2),n===88||n===120)return NaN}else if(r===48){switch(Ql(t,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+t}for(a=QH(t,2),l=a.length,s=0;s<l;s++)if(u=Ql(a,s),u<48||u>o)return NaN;return parseInt(a,i)}}return+t},Yv=VH(rc,!wi(" 0o1")||!wi("0b1")||wi("+0x1")),tL=function(e){return BH(Uv,e)&&UH(function(){XH(e)})},nc=function(t){var r=arguments.length<1?0:wi(JH(t));return tL(this)?WH(Object(r),this,nc):r};nc.prototype=Uv;Yv&&!d_&&(Uv.constructor=nc);FH({global:!0,constructor:!0,wrap:!0,forced:Yv},{Number:nc});var rL=function(e,t){for(var r=jH?YH(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)Kg(t,i=r[n])&&!Kg(e,i)&&KH(e,i,GH(t,i))};(Yv||d_)&&rL(y_[rc],wi);var nL=K,Xg=go,iL=Xu,oL=je,qg=gl,aL=Zt,lL=Ft,sL=mo,uL=Oe,cL=$l,fL=_l,hL=cL("slice"),dL=uL("species"),cf=Array,vL=Math.max;nL({target:"Array",proto:!0,forced:!hL},{slice:function(t,r){var n=lL(this),i=aL(n),o=qg(t,i),a=qg(r===void 0?i:r,i),l,s,u;if(Xg(n)&&(l=n.constructor,iL(l)&&(l===cf||Xg(l.prototype))?l=void 0:oL(l)&&(l=l[dL],l===null&&(l=void 0)),l===cf||l===void 0))return fL(n,o,a);for(s=new(l===void 0?cf:l)(vL(a-o,0)),u=0;o<a;o++,u++)o in n&&sL(s,u,n[o]);return s.length=u,s}});var yL=K,mL=Q,gL=go,pL=je,bL=It,wL=Zt,Zg=c_,Qg=mo,SL=Ov,OL=$l,CL=Oe,_L=dl,p_=CL("isConcatSpreadable"),TL=_L>=51||!mL(function(){var e=[];return e[p_]=!1,e.concat()[0]!==e}),RL=function(e){if(!pL(e))return!1;var t=e[p_];return t!==void 0?!!t:gL(e)},EL=!TL||!OL("concat");yL({target:"Array",proto:!0,arity:1,forced:EL},{concat:function(t){var r=bL(this),n=SL(r,0),i=0,o,a,l,s,u;for(o=-1,l=arguments.length;o<l;o++)if(u=o===-1?r:arguments[o],RL(u))for(s=wL(u),Zg(i+s),a=0;a<s;a++,i++)a in u&&Qg(n,i,u[a]);else Zg(i+1),Qg(n,i++,u);return n.length=i,n}});var $L=It,Jg=gl,PL=Zt,IL=function(t){for(var r=$L(this),n=PL(r),i=arguments.length,o=Jg(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,l=a===void 0?n:Jg(a,n);l>o;)r[o++]=t;return r},kL=K,AL=IL,ML=Rl;kL({target:"Array",proto:!0},{fill:AL});ML("fill");var xL=K,NL=qn.map,DL=$l,HL=DL("map");xL({target:"Array",proto:!0,forced:!HL},{map:function(t){return NL(this,t,arguments.length>1?arguments[1]:void 0)}});var LL=Ve,b_=function(){var e=LL(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Gv=Q,FL=be,Kv=FL.RegExp,Xv=Gv(function(){var e=Kv("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),jL=Xv||Gv(function(){return!Kv("a","y").sticky}),VL=Xv||Gv(function(){var e=Kv("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),qv={BROKEN_CARET:VL,MISSED_STICKY:jL,UNSUPPORTED_Y:Xv},WL=Q,BL=be,zL=BL.RegExp,w_=WL(function(){var e=zL(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),UL=Q,YL=be,GL=YL.RegExp,S_=UL(function(){var e=GL("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),pi=Ge,ic=ee,KL=Je,XL=b_,qL=qv,ZL=dn,QL=yo,JL=Gr.get,eF=w_,tF=S_,rF=ZL("native-string-replace",String.prototype.replace),Gs=RegExp.prototype.exec,Ph=Gs,nF=ic("".charAt),iF=ic("".indexOf),oF=ic("".replace),ff=ic("".slice),Ih=function(){var e=/a/,t=/b*/g;return pi(Gs,e,"a"),pi(Gs,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),O_=qL.BROKEN_CARET,kh=/()??/.exec("")[1]!==void 0,aF=Ih||kh||O_||eF||tF;aF&&(Ph=function(t){var r=this,n=JL(r),i=KL(t),o=n.raw,a,l,s,u,c,f,h;if(o)return o.lastIndex=r.lastIndex,a=pi(Ph,o,i),r.lastIndex=o.lastIndex,a;var v=n.groups,m=O_&&r.sticky,p=pi(XL,r),b=r.source,C=0,T=i;if(m&&(p=oF(p,"y",""),iF(p,"g")===-1&&(p+="g"),T=ff(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&nF(i,r.lastIndex-1)!==`
`)&&(b="(?: "+b+")",T=" "+T,C++),l=new RegExp("^(?:"+b+")",p)),kh&&(l=new RegExp("^"+b+"$(?!\\s)",p)),Ih&&(s=r.lastIndex),u=pi(Gs,m?l:r,T),m?u?(u.input=ff(u.input,C),u[0]=ff(u[0],C),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:Ih&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),kh&&u&&u.length>1&&pi(rF,u[0],l,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&v)for(u.groups=f=QL(null),c=0;c<v.length;c++)h=v[c],f[h[0]]=u[h[1]];return u});var oc=Ph,lF=K,ep=oc;lF({target:"RegExp",proto:!0,forced:/./.exec!==ep},{exec:ep});var tp=Ku,rp=qt,sF=oc,np=Q,C_=Oe,uF=Gn,cF=C_("species"),hf=RegExp.prototype,Zv=function(e,t,r,n){var i=C_(e),o=!np(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),a=o&&!np(function(){var u=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[cF]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return u=!0,null},c[i](""),!u});if(!o||!a||r){var l=tp(/./[i]),s=t(i,""[e],function(u,c,f,h,v){var m=tp(u),p=c.exec;return p===sF||p===hf.exec?o&&!v?{done:!0,value:l(c,f,h)}:{done:!0,value:m(f,c,h)}:{done:!1}});rp(String.prototype,e,s[0]),rp(hf,i,s[1])}n&&uF(hf[i],"sham",!0)},fF=Bv.charAt,Qv=function(e,t,r){return t+(r?fF(e,t).length:1)},Jv=ee,hF=It,dF=Math.floor,df=Jv("".charAt),vF=Jv("".replace),vf=Jv("".slice),yF=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,mF=/\$([$&'`]|\d{1,2})/g,gF=function(e,t,r,n,i,o){var a=r+e.length,l=n.length,s=mF;return i!==void 0&&(i=hF(i),s=yF),vF(o,s,function(u,c){var f;switch(df(c,0)){case"$":return"$";case"&":return e;case"`":return vf(t,0,r);case"'":return vf(t,a);case"<":f=i[vf(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>l){var v=dF(h/10);return v===0?u:v<=l?n[v-1]===void 0?df(c,1):n[v-1]+df(c,1):u}f=n[h-1]}return f===void 0?"":f})},ip=Ge,pF=Ve,bF=Ee,wF=Tr,SF=oc,OF=TypeError,ey=function(e,t){var r=e.exec;if(bF(r)){var n=ip(r,e,t);return n!==null&&pF(n),n}if(wF(e)==="RegExp")return ip(SF,e,t);throw OF("RegExp#exec called on incompatible receiver")},CF=Zn,op=Ge,ac=ee,_F=Zv,TF=Q,RF=Ve,EF=Ee,$F=Rr,PF=Xn,IF=vo,ni=Je,kF=cr,AF=Qv,MF=ho,xF=gF,NF=ey,DF=Oe,Ah=DF("replace"),HF=Math.max,LF=Math.min,FF=ac([].concat),yf=ac([].push),ap=ac("".indexOf),lp=ac("".slice),jF=function(e){return e===void 0?e:String(e)},VF=function(){return"a".replace(/./,"$0")==="$0"}(),sp=function(){return/./[Ah]?/./[Ah]("a","$0")==="":!1}(),WF=!TF(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});_F("replace",function(e,t,r){var n=sp?"$":"$0";return[function(o,a){var l=kF(this),s=$F(o)?void 0:MF(o,Ah);return s?op(s,o,l,a):op(t,ni(l),o,a)},function(i,o){var a=RF(this),l=ni(i);if(typeof o=="string"&&ap(o,n)===-1&&ap(o,"$<")===-1){var s=r(t,a,l,o);if(s.done)return s.value}var u=EF(o);u||(o=ni(o));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var v=NF(a,l);if(v===null||(yf(h,v),!c))break;var m=ni(v[0]);m===""&&(a.lastIndex=AF(l,IF(a.lastIndex),f))}for(var p="",b=0,C=0;C<h.length;C++){v=h[C];for(var T=ni(v[0]),I=HF(LF(PF(v.index),l.length),0),P=[],E=1;E<v.length;E++)yf(P,jF(v[E]));var q=v.groups;if(u){var Y=FF([T],P,I,l);q!==void 0&&yf(Y,q);var ne=ni(CF(o,void 0,Y))}else ne=xF(T,l,I,P,q,o);I>=b&&(p+=lp(l,b,I)+ne,b=I+T.length)}return p+lp(l,b)}]},!WF||!VF||sp);var BF=Ve,zF=GC,UF=function(e,t,r,n){try{return n?t(BF(r)[0],r[1]):t(r)}catch(i){zF(e,"throw",i)}},YF=Ol,GF=Ge,KF=It,XF=UF,qF=UC,ZF=Xu,QF=Zt,up=mo,JF=YC,ej=Dv,cp=Array,tj=function(t){var r=KF(t),n=ZF(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=YF(o,i>2?arguments[2]:void 0));var l=ej(r),s=0,u,c,f,h,v,m;if(l&&!(this===cp&&qF(l)))for(h=JF(r,l),v=h.next,c=n?new this:[];!(f=GF(v,h)).done;s++)m=a?XF(h,o,[f.value,s],!0):f.value,up(c,s,m);else for(u=QF(r),c=n?new this(u):cp(u);u>s;s++)m=a?o(r[s],s):r[s],up(c,s,m);return c.length=s,c},rj=K,nj=tj,ij=qC,oj=!ij(function(e){Array.from(e)});rj({target:"Array",stat:!0,forced:oj},{from:nj});var aj=K,lj=Ku,sj=dv.indexOf,uj=po,Mh=lj([].indexOf),__=!!Mh&&1/Mh([1],1,-0)<0,cj=__||!uj("indexOf");aj({target:"Array",proto:!0,forced:cj},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return __?Mh(this,t,r)||0:sj(this,t,r)}});var fj=K,hj=ee,dj=go,vj=hj([].reverse),fp=[1,2];fj({target:"Array",proto:!0,forced:String(fp)===String(fp.reverse())},{reverse:function(){return dj(this)&&(this.length=this.length),vj(this)}});var yj=qn.forEach,mj=po,gj=mj("forEach"),pj=gj?[].forEach:function(t){return yj(this,t,arguments.length>1?arguments[1]:void 0)},hp=be,dp=r_,bj=n_,mf=pj,wj=Gn,T_=function(e){if(e&&e.forEach!==mf)try{wj(e,"forEach",mf)}catch{e.forEach=mf}};for(var gf in dp)dp[gf]&&T_(hp[gf]&&hp[gf].prototype);T_(bj);var Sj=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",Oj=TypeError,R_=function(e,t){if(e<t)throw Oj("Not enough arguments");return e},E_=be,Cj=Zn,_j=Ee,Tj=Sj,Rj=Un,Ej=_l,$j=R_,Pj=E_.Function,Ij=/MSIE .\./.test(Rj)||Tj&&function(){var e=E_.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),ty=function(e,t){var r=t?2:1;return Ij?function(n,i){var o=$j(arguments.length,1)>r,a=_j(n)?n:Pj(n),l=o?Ej(arguments,r):[],s=o?function(){Cj(a,this,l)}:a;return t?e(s,i):e(s)}:e},kj=K,$_=be,Aj=ty,vp=Aj($_.setInterval,!0);kj({global:!0,bind:!0,forced:$_.setInterval!==vp},{setInterval:vp});var Mj=K,P_=be,xj=ty,yp=xj(P_.setTimeout,!0);Mj({global:!0,bind:!0,forced:P_.setTimeout!==yp},{setTimeout:yp});var Nj=Un,Dj=/(?:ipad|iphone|ipod).*applewebkit/i.test(Nj),Hj=Tr,I_=typeof process<"u"&&Hj(process)=="process",Ht=be,Lj=Zn,Fj=Ol,mp=Ee,jj=Ae,k_=Q,gp=rC,Vj=_l,pp=Bu,Wj=R_,Bj=Dj,zj=I_,xh=Ht.setImmediate,Nh=Ht.clearImmediate,Uj=Ht.process,pf=Ht.Dispatch,Yj=Ht.Function,bp=Ht.MessageChannel,Gj=Ht.String,bf=0,Uo={},wp="onreadystatechange",ra,wn,wf,Sf;k_(function(){ra=Ht.location});var ry=function(e){if(jj(Uo,e)){var t=Uo[e];delete Uo[e],t()}},Of=function(e){return function(){ry(e)}},Sp=function(e){ry(e.data)},Op=function(e){Ht.postMessage(Gj(e),ra.protocol+"//"+ra.host)};(!xh||!Nh)&&(xh=function(t){Wj(arguments.length,1);var r=mp(t)?t:Yj(t),n=Vj(arguments,1);return Uo[++bf]=function(){Lj(r,void 0,n)},wn(bf),bf},Nh=function(t){delete Uo[t]},zj?wn=function(e){Uj.nextTick(Of(e))}:pf&&pf.now?wn=function(e){pf.now(Of(e))}:bp&&!Bj?(wf=new bp,Sf=wf.port2,wf.port1.onmessage=Sp,wn=Fj(Sf.postMessage,Sf)):Ht.addEventListener&&mp(Ht.postMessage)&&!Ht.importScripts&&ra&&ra.protocol!=="file:"&&!k_(Op)?(wn=Op,Ht.addEventListener("message",Sp,!1)):wp in pp("script")?wn=function(e){gp.appendChild(pp("script"))[wp]=function(){gp.removeChild(this),ry(e)}}:wn=function(e){setTimeout(Of(e),0)});var A_={set:xh,clear:Nh},Kj=K,Xj=be,Cp=A_.clear;Kj({global:!0,bind:!0,enumerable:!0,forced:Xj.clearImmediate!==Cp},{clearImmediate:Cp});var qj=K,M_=be,_p=A_.set,Zj=ty,Tp=M_.setImmediate?Zj(_p,!1):_p;qj({global:!0,bind:!0,enumerable:!0,forced:M_.setImmediate!==Tp},{setImmediate:Tp});var Qj=jv,Jj=JC;Qj("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Jj);var eV=K,tV=Q,rV=It,x_=tc,nV=LC,iV=tV(function(){x_(1)});eV({target:"Object",stat:!0,forced:iV,sham:!nV},{getPrototypeOf:function(t){return x_(rV(t))}});var oV=je,aV=Tr,lV=Oe,sV=lV("match"),ny=function(e){var t;return oV(e)&&((t=e[sV])!==void 0?!!t:aV(e)=="RegExp")},uV=ny,cV=TypeError,N_=function(e){if(uV(e))throw cV("The method doesn't accept regular expressions");return e},fV=Oe,hV=fV("match"),D_=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[hV]=!1,"/./"[e](t)}catch{}}return!1},dV=K,vV=ee,yV=N_,mV=cr,Rp=Je,gV=D_,pV=vV("".indexOf);dV({target:"String",proto:!0,forced:!gV("includes")},{includes:function(t){return!!~pV(Rp(mV(this)),Rp(yV(t)),arguments.length>1?arguments[1]:void 0)}});var bV=K,wV=qn.filter,SV=$l,OV=SV("filter");bV({target:"Array",proto:!0,forced:!OV},{filter:function(t){return wV(this,t,arguments.length>1?arguments[1]:void 0)}});var CV=Ge,_V=Ae,TV=yn,RV=b_,Ep=RegExp.prototype,H_=function(e){var t=e.flags;return t===void 0&&!("flags"in Ep)&&!_V(e,"flags")&&TV(Ep,e)?CV(RV,e):t},EV=Ot.f,$V=function(e,t,r){r in e||EV(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},PV=Fe,iy=be,Pl=ee,IV=Uu,kV=Fv,AV=Gn,MV=Kn.f,$p=yn,xV=ny,Pp=Je,NV=H_,L_=qv,DV=$V,HV=qt,LV=Q,FV=Ae,jV=Gr.enforce,VV=ZC,WV=Oe,F_=w_,j_=S_,BV=WV("match"),cn=iy.RegExp,di=cn.prototype,zV=iy.SyntaxError,UV=Pl(di.exec),Ks=Pl("".charAt),Ip=Pl("".replace),kp=Pl("".indexOf),YV=Pl("".slice),GV=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,An=/a/g,Cf=/a/g,KV=new cn(An)!==An,V_=L_.MISSED_STICKY,XV=L_.UNSUPPORTED_Y,qV=PV&&(!KV||V_||F_||j_||LV(function(){return Cf[BV]=!1,cn(An)!=An||cn(Cf)==Cf||cn(An,"i")!="/a/i"})),ZV=function(e){for(var t=e.length,r=0,n="",i=!1,o;r<=t;r++){if(o=Ks(e,r),o==="\\"){n+=o+Ks(e,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},QV=function(e){for(var t=e.length,r=0,n="",i=[],o={},a=!1,l=!1,s=0,u="",c;r<=t;r++){if(c=Ks(e,r),c==="\\")c=c+Ks(e,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":UV(GV,YV(e,r+1))&&(r+=2,l=!0),n+=c,s++;continue;case(c===">"&&l):if(u===""||FV(o,u))throw new zV("Invalid capture group name");o[u]=!0,i[i.length]=[u,s],l=!1,u="";continue}l?u+=c:n+=c}return[n,i]};if(IV("RegExp",qV)){for(var Sn=function(t,r){var n=$p(di,this),i=xV(t),o=r===void 0,a=[],l=t,s,u,c,f,h,v;if(!n&&i&&o&&t.constructor===Sn)return t;if((i||$p(di,t))&&(t=t.source,o&&(r=NV(l))),t=t===void 0?"":Pp(t),r=r===void 0?"":Pp(r),l=t,F_&&"dotAll"in An&&(u=!!r&&kp(r,"s")>-1,u&&(r=Ip(r,/s/g,""))),s=r,V_&&"sticky"in An&&(c=!!r&&kp(r,"y")>-1,c&&XV&&(r=Ip(r,/y/g,""))),j_&&(f=QV(t),t=f[0],a=f[1]),h=kV(cn(t,r),n?this:di,Sn),(u||c||a.length)&&(v=jV(h),u&&(v.dotAll=!0,v.raw=Sn(ZV(t),s)),c&&(v.sticky=!0),a.length&&(v.groups=a)),t!==l)try{AV(h,"source",l===""?"(?:)":l)}catch{}return h},Ap=MV(cn),Mp=0;Ap.length>Mp;)DV(Sn,cn,Ap[Mp++]);di.constructor=Sn,Sn.prototype=di,HV(iy,"RegExp",Sn,{constructor:!0})}VV("RegExp");var JV=yl.PROPER,eW=qt,tW=Ve,xp=Je,rW=Q,nW=H_,oy="toString",iW=RegExp.prototype,W_=iW[oy],oW=rW(function(){return W_.call({source:"a",flags:"b"})!="/a/b"}),aW=JV&&W_.name!=oy;(oW||aW)&&eW(RegExp.prototype,oy,function(){var t=tW(this),r=xp(t.source),n=xp(nW(t));return"/"+r+"/"+n},{unsafe:!0});var lW=K,sW=ee,uW=hl,cW=Ft,fW=po,hW=sW([].join),dW=uW!=Object,vW=dW||!fW("join",",");lW({target:"Array",proto:!0,forced:vW},{join:function(t){return hW(cW(this),t===void 0?",":t)}});var yW=yl.PROPER,mW=Q,Np=f_,Dp="​᠎",gW=function(e){return mW(function(){return!!Np[e]()||Dp[e]()!==Dp||yW&&Np[e].name!==e})},pW=K,bW=h_.trim,wW=gW;pW({target:"String",proto:!0,forced:wW("trim")},{trim:function(){return bW(this)}});function SW(e){return window.requestAnimationFrame(e)}function OW(){return!!document.documentElement.classList}function CW(){return!!document.createTextNode("test").textContent}function _W(){return!!window.getComputedStyle}function TW(){return"ontouchstart"in window}var Dh;function RW(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),Dh=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function B_(){return Dh===void 0&&RW(),Dh}var Po;function EW(){if(Po!==void 0)return Po;try{var e={get passive(){Po=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Po=!1}return Po}var $W=wv,PW=sC;$W("toPrimitive");PW();var IW=Ve,kW=BO,AW=TypeError,MW=function(e){if(IW(this),e==="string"||e==="default")e="string";else if(e!=="number")throw AW("Incorrect hint");return kW(this,e)},xW=Ae,NW=qt,DW=MW,HW=Oe,Hp=HW("toPrimitive"),Lp=Date.prototype;xW(Lp,Hp)||NW(Lp,Hp,DW);var LW=Xu,FW=fo,jW=TypeError,z_=function(e){if(LW(e))return e;throw jW(FW(e)+" is not a constructor")},Fp=Ve,VW=z_,WW=Rr,BW=Oe,zW=BW("species"),UW=function(e,t){var r=Fp(e).constructor,n;return r===void 0||WW(n=Fp(r)[zW])?t:VW(n)},YW=Zn,Io=Ge,ay=ee,GW=Zv,KW=Ve,XW=Rr,qW=ny,jp=cr,ZW=UW,QW=Qv,JW=vo,_f=Je,eB=ho,Vp=pv,Wp=ey,tB=oc,rB=qv,nB=Q,ii=rB.UNSUPPORTED_Y,Bp=4294967295,iB=Math.min,U_=[].push,oB=ay(/./.exec),oi=ay(U_),ko=ay("".slice),aB=!nB(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});GW("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=_f(jp(this)),l=o===void 0?Bp:o>>>0;if(l===0)return[];if(i===void 0)return[a];if(!qW(i))return Io(t,a,i,l);for(var s=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,f=new RegExp(i.source,u+"g"),h,v,m;(h=Io(tB,f,a))&&(v=f.lastIndex,!(v>c&&(oi(s,ko(a,c,h.index)),h.length>1&&h.index<a.length&&YW(U_,s,Vp(h,1)),m=h[0].length,c=v,s.length>=l)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(m||!oB(f,""))&&oi(s,""):oi(s,ko(a,c)),s.length>l?Vp(s,0,l):s}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:Io(t,this,i,o)}:n=t,[function(o,a){var l=jp(this),s=XW(o)?void 0:eB(o,e);return s?Io(s,o,l,a):Io(n,_f(l),o,a)},function(i,o){var a=KW(this),l=_f(i),s=r(n,a,l,o,n!==t);if(s.done)return s.value;var u=ZW(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ii?"g":"y"),h=new u(ii?"^(?:"+a.source+")":a,f),v=o===void 0?Bp:o>>>0;if(v===0)return[];if(l.length===0)return Wp(h,l)===null?[l]:[];for(var m=0,p=0,b=[];p<l.length;){h.lastIndex=ii?0:p;var C=Wp(h,ii?ko(l,p):l),T;if(C===null||(T=iB(JW(h.lastIndex+(ii?p:0)),l.length))===m)p=QW(l,p,c);else{if(oi(b,ko(l,m,p)),b.length===v)return b;for(var I=1;I<=C.length-1;I++)if(oi(b,C[I]),b.length===v)return b;p=m=T}}return oi(b,ko(l,m)),b}]},!aB,ii);function lB(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function zp(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Tf(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function lc(e,t,r,n){var i=-1,o=e,a=r;Array.isArray(e)||(o=Array.from(e));var l=o.length;for(n&&l&&(i+=1,a=o[i]),i+=1;i<l;)a=t(a,o[i],i,o),i+=1;return a}function ly(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],a=-1;r<i;){var l=n[r];t(l,r,n)&&(a+=1,o[a]=l),r+=1}return o}function Dn(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],a=-1;r<i;){var l=n[r];a+=1,o[a]=t(l,r,n),r+=1}return o}function ve(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function Up(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],o=n.slice(1),a=i;return ve(o,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function Yp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function Gp(e,t,r){return t=sB(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sB(e){var t=uB(e,"string");return Wr(t)==="symbol"?t:String(t)}function uB(e,t){if(Wr(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wr(e){return Wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wr(e)}function na(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Te(e,function(r,n){n!=="__children"&&(r&&Wr(r)==="object"&&!Array.isArray(r)?t[n]=na(r):Array.isArray(r)?r.length&&Wr(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[na(r[0])]:t[n]=[]:t[n]=null)})),t}function cB(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function $i(e,t,r){var n=Array.isArray(r);return Te(t,function(i,o){(n===!1||r.includes(o))&&(e[o]=i)}),e}function Y_(e,t){Te(t,function(r,n){t[n]&&Wr(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Y_(e[n],t[n])):e[n]=t[n]})}function vn(e){return Wr(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Be(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ve(r,function(i){e.MIXINS.push(i.MIXIN_NAME),Te(i,function(o,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")e.prototype[a]=o;else{var l=function(c,f){var h="_".concat(c),v=function(p){var b=p;return(Array.isArray(b)||Br(b))&&(b=vn(b)),b};return function(){return this[h]===void 0&&(this[h]=v(f)),this[h]}},s=function(c){var f="_".concat(c);return function(h){this[f]=h}};Object.defineProperty(e.prototype,a,{get:l(a,o),set:s(a),configurable:!0})}})}),e}function G_(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Br(e){return Object.prototype.toString.call(e)==="[object Object]"}function mn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Te(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function fB(e,t){var r=t.split("."),n=e;return Te(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function Rf(e,t,r){var n=t.split("."),i=e;n.forEach(function(o,a){a!==n.length-1?(Ii(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function sy(e){if(!Br(e))return 0;var t=function r(n){var i=0;return Br(n)?Te(n,function(o,a){a!=="__children"&&(i+=r(o))}):i+=1,i};return t(e)}function Pi(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},Gp(t,n,e),Gp(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function Ii(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Rt=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},Er={chrome:Rt(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Rt(function(e){return/CriOS/.test(e)}),edge:Rt(function(e){return/Edge/.test(e)}),edgeWebKit:Rt(function(e){return/EdgiOS/.test(e)}),firefox:Rt(function(e){return/Firefox/.test(e)}),firefoxWebKit:Rt(function(e){return/FxiOS/.test(e)}),ie:Rt(function(e){return/Trident/.test(e)}),ie9:Rt(function(){return!!document.documentMode}),mobile:Rt(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Rt(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},sc={mac:Rt(function(e){return/^Mac/.test(e)}),win:Rt(function(e){return/^Win/.test(e)}),linux:Rt(function(e){return/^Linux/.test(e)}),ios:Rt(function(e){return/iPhone|iPad|iPod/i.test(e)})};function hB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;Te(Er,function(o){var a=o.test;return void a(r,i)})}function dB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Te(sc,function(n){var i=n.test;return void i(r)})}hB();dB();function vB(){return Er.chrome.value}function yB(){return Er.chromeWebKit.value}function Ef(){return Er.firefox.value}function mB(){return Er.firefoxWebKit.value}function gB(){return Er.safari.value}function pB(){return Er.edge.value}function bB(){return Er.ie.value}function wB(){return Er.ie9.value}function Pn(){return Er.mobile.value}function K_(){return sc.ios.value}function SB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&sc.mac.value}function Kp(){return sc.mac.value}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function rn(e){return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(e)}function Hh(e,t){return Hh=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Hh(e,t)}function OB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ts(e,t,r){return OB()?Ts=Reflect.construct:Ts=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&Hh(u,a.prototype),u},Ts.apply(null,arguments)}function nr(e){return CB(e)||_B(e)||TB(e)||RB()}function CB(e){if(Array.isArray(e))return Lh(e)}function _B(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TB(e,t){if(e){if(typeof e=="string")return Lh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lh(e,t)}}function Lh(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var EB=Object.hasOwnProperty,Xp=Object.setPrototypeOf,$B=Object.isFrozen,PB=Object.getPrototypeOf,IB=Object.getOwnPropertyDescriptor,St=Object.freeze,lr=Object.seal,kB=Object.create,X_=typeof Reflect<"u"&&Reflect,Xs=X_.apply,Fh=X_.construct;Xs||(Xs=function(t,r,n){return t.apply(r,n)});St||(St=function(t){return t});lr||(lr=function(t){return t});Fh||(Fh=function(t,r){return Ts(t,nr(r))});var AB=Xt(Array.prototype.forEach),qp=Xt(Array.prototype.pop),Ao=Xt(Array.prototype.push),Rs=Xt(String.prototype.toLowerCase),$f=Xt(String.prototype.toString),MB=Xt(String.prototype.match),tr=Xt(String.prototype.replace),xB=Xt(String.prototype.indexOf),NB=Xt(String.prototype.trim),pt=Xt(RegExp.prototype.test),Pf=DB(TypeError);function Xt(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Xs(e,t,n)}}function DB(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Fh(e,r)}}function J(e,t,r){r=r||Rs,Xp&&Xp(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var o=r(i);o!==i&&($B(t)||(t[n]=o),i=o)}e[i]=!0}return e}function On(e){var t=kB(null),r;for(r in e)Xs(EB,e,[r])===!0&&(t[r]=e[r]);return t}function Jl(e,t){for(;e!==null;){var r=IB(e,t);if(r){if(r.get)return Xt(r.get);if(typeof r.value=="function")return Xt(r.value)}e=PB(e)}function n(i){return console.warn("fallback value for",i),null}return n}var Zp=St(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),If=St(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),kf=St(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),HB=St(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Af=St(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),LB=St(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qp=St(["#text"]),Jp=St(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Mf=St(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eb=St(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),es=St(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),FB=lr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),jB=lr(/<%[\w\W]*|[\w\W]*%>/gm),VB=lr(/\${[\w\W]*}/gm),WB=lr(/^data-[\-\w.\u00B7-\uFFFF]/),BB=lr(/^aria-[\-\w]+$/),zB=lr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),UB=lr(/^(?:\w+script|data):/i),YB=lr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),GB=lr(/^html$/i),KB=function(){return typeof window>"u"?null:window},XB=function(t,r){if(rn(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function q_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:KB(),t=function(O){return q_(O)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,o=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,c=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,f=e.HTMLFormElement,h=e.DOMParser,v=e.trustedTypes,m=l.prototype,p=Jl(m,"cloneNode"),b=Jl(m,"nextSibling"),C=Jl(m,"childNodes"),T=Jl(m,"parentNode");if(typeof o=="function"){var I=n.createElement("template");I.content&&I.content.ownerDocument&&(n=I.content.ownerDocument)}var P=XB(v,r),E=P?P.createHTML(""):"",q=n,Y=q.implementation,ne=q.createNodeIterator,me=q.createDocumentFragment,dt=q.getElementsByTagName,et=r.importNode,ze={};try{ze=On(n).documentMode?n.documentMode:{}}catch{}var ie={};t.isSupported=typeof T=="function"&&Y&&typeof Y.createHTMLDocument<"u"&&ze!==9;var Pe=FB,Ke=jB,Ce=VB,Me=WB,xe=BB,d=UB,y=YB,g=zB,w=null,S=J({},[].concat(nr(Zp),nr(If),nr(kf),nr(Af),nr(Qp))),_=null,R=J({},[].concat(nr(Jp),nr(Mf),nr(eb),nr(es))),$=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),k=null,H=null,N=!0,B=!0,te=!1,z=!0,G=!1,se=!1,ge=!1,He=!1,we=!1,Se=!1,We=!1,Xe=!0,er=!1,Vt="user-content-",at=!0,At=!1,tt={},rt=null,hr=J({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),qr=null,gn=J({},["audio","video","img","source","image","track"]),dr=null,vr=J({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Wt="http://www.w3.org/1998/Math/MathML",yr="http://www.w3.org/2000/svg",vt="http://www.w3.org/1999/xhtml",Mt=vt,mr=!1,xt=null,nt=J({},[Wt,yr,vt],$f),lt,pe=["application/xhtml+xml","text/html"],de="text/html",ae,_e=null,yt=n.createElement("form"),mt=function(O){return O instanceof RegExp||O instanceof Function},gt=function(O){_e&&_e===O||((!O||rn(O)!=="object")&&(O={}),O=On(O),lt=pe.indexOf(O.PARSER_MEDIA_TYPE)===-1?lt=de:lt=O.PARSER_MEDIA_TYPE,ae=lt==="application/xhtml+xml"?$f:Rs,w="ALLOWED_TAGS"in O?J({},O.ALLOWED_TAGS,ae):S,_="ALLOWED_ATTR"in O?J({},O.ALLOWED_ATTR,ae):R,xt="ALLOWED_NAMESPACES"in O?J({},O.ALLOWED_NAMESPACES,$f):nt,dr="ADD_URI_SAFE_ATTR"in O?J(On(vr),O.ADD_URI_SAFE_ATTR,ae):vr,qr="ADD_DATA_URI_TAGS"in O?J(On(gn),O.ADD_DATA_URI_TAGS,ae):gn,rt="FORBID_CONTENTS"in O?J({},O.FORBID_CONTENTS,ae):hr,k="FORBID_TAGS"in O?J({},O.FORBID_TAGS,ae):{},H="FORBID_ATTR"in O?J({},O.FORBID_ATTR,ae):{},tt="USE_PROFILES"in O?O.USE_PROFILES:!1,N=O.ALLOW_ARIA_ATTR!==!1,B=O.ALLOW_DATA_ATTR!==!1,te=O.ALLOW_UNKNOWN_PROTOCOLS||!1,z=O.ALLOW_SELF_CLOSE_IN_ATTR!==!1,G=O.SAFE_FOR_TEMPLATES||!1,se=O.WHOLE_DOCUMENT||!1,we=O.RETURN_DOM||!1,Se=O.RETURN_DOM_FRAGMENT||!1,We=O.RETURN_TRUSTED_TYPE||!1,He=O.FORCE_BODY||!1,Xe=O.SANITIZE_DOM!==!1,er=O.SANITIZE_NAMED_PROPS||!1,at=O.KEEP_CONTENT!==!1,At=O.IN_PLACE||!1,g=O.ALLOWED_URI_REGEXP||g,Mt=O.NAMESPACE||vt,$=O.CUSTOM_ELEMENT_HANDLING||{},O.CUSTOM_ELEMENT_HANDLING&&mt(O.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=O.CUSTOM_ELEMENT_HANDLING.tagNameCheck),O.CUSTOM_ELEMENT_HANDLING&&mt(O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),O.CUSTOM_ELEMENT_HANDLING&&typeof O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),G&&(B=!1),Se&&(we=!0),tt&&(w=J({},nr(Qp)),_=[],tt.html===!0&&(J(w,Zp),J(_,Jp)),tt.svg===!0&&(J(w,If),J(_,Mf),J(_,es)),tt.svgFilters===!0&&(J(w,kf),J(_,Mf),J(_,es)),tt.mathMl===!0&&(J(w,Af),J(_,eb),J(_,es))),O.ADD_TAGS&&(w===S&&(w=On(w)),J(w,O.ADD_TAGS,ae)),O.ADD_ATTR&&(_===R&&(_=On(_)),J(_,O.ADD_ATTR,ae)),O.ADD_URI_SAFE_ATTR&&J(dr,O.ADD_URI_SAFE_ATTR,ae),O.FORBID_CONTENTS&&(rt===hr&&(rt=On(rt)),J(rt,O.FORBID_CONTENTS,ae)),at&&(w["#text"]=!0),se&&J(w,["html","head","body"]),w.table&&(J(w,["tbody"]),delete k.tbody),St&&St(O),_e=O)},gr=J({},["mi","mo","mn","ms","mtext"]),pn=J({},["foreignobject","desc","title","annotation-xml"]),Zr=J({},["title","style","font","a","script"]),ti=J({},If);J(ti,kf),J(ti,HB);var Ec=J({},Af);J(Ec,LB);var E$=function(O){var M=T(O);(!M||!M.tagName)&&(M={namespaceURI:Mt,tagName:"template"});var F=Rs(O.tagName),fe=Rs(M.tagName);return xt[O.namespaceURI]?O.namespaceURI===yr?M.namespaceURI===vt?F==="svg":M.namespaceURI===Wt?F==="svg"&&(fe==="annotation-xml"||gr[fe]):!!ti[F]:O.namespaceURI===Wt?M.namespaceURI===vt?F==="math":M.namespaceURI===yr?F==="math"&&pn[fe]:!!Ec[F]:O.namespaceURI===vt?M.namespaceURI===yr&&!pn[fe]||M.namespaceURI===Wt&&!gr[fe]?!1:!Ec[F]&&(Zr[F]||!ti[F]):!!(lt==="application/xhtml+xml"&&xt[O.namespaceURI]):!1},Ir=function(O){Ao(t.removed,{element:O});try{O.parentNode.removeChild(O)}catch{try{O.outerHTML=E}catch{O.remove()}}},$c=function(O,M){try{Ao(t.removed,{attribute:M.getAttributeNode(O),from:M})}catch{Ao(t.removed,{attribute:null,from:M})}if(M.removeAttribute(O),O==="is"&&!_[O])if(we||Se)try{Ir(M)}catch{}else try{M.setAttribute(O,"")}catch{}},im=function(O){var M,F;if(He)O="<remove></remove>"+O;else{var fe=MB(O,/^[\r\n\t ]+/);F=fe&&fe[0]}lt==="application/xhtml+xml"&&Mt===vt&&(O='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+O+"</body></html>");var Ct=P?P.createHTML(O):O;if(Mt===vt)try{M=new h().parseFromString(Ct,lt)}catch{}if(!M||!M.documentElement){M=Y.createDocument(Mt,"template",null);try{M.documentElement.innerHTML=mr?E:Ct}catch{}}var st=M.body||M.documentElement;return O&&F&&st.insertBefore(n.createTextNode(F),st.childNodes[0]||null),Mt===vt?dt.call(M,se?"html":"body")[0]:se?M.documentElement:st},om=function(O){return ne.call(O.ownerDocument||O,O,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},$$=function(O){return O instanceof f&&(typeof O.nodeName!="string"||typeof O.textContent!="string"||typeof O.removeChild!="function"||!(O.attributes instanceof c)||typeof O.removeAttribute!="function"||typeof O.setAttribute!="function"||typeof O.namespaceURI!="string"||typeof O.insertBefore!="function"||typeof O.hasChildNodes!="function")},_o=function(O){return rn(a)==="object"?O instanceof a:O&&rn(O)==="object"&&typeof O.nodeType=="number"&&typeof O.nodeName=="string"},kr=function(O,M,F){ie[O]&&AB(ie[O],function(fe){fe.call(t,M,F,_e)})},am=function(O){var M;if(kr("beforeSanitizeElements",O,null),$$(O)||pt(/[\u0080-\uFFFF]/,O.nodeName))return Ir(O),!0;var F=ae(O.nodeName);if(kr("uponSanitizeElement",O,{tagName:F,allowedTags:w}),O.hasChildNodes()&&!_o(O.firstElementChild)&&(!_o(O.content)||!_o(O.content.firstElementChild))&&pt(/<[/\w]/g,O.innerHTML)&&pt(/<[/\w]/g,O.textContent)||F==="select"&&pt(/<template/i,O.innerHTML))return Ir(O),!0;if(!w[F]||k[F]){if(!k[F]&&sm(F)&&($.tagNameCheck instanceof RegExp&&pt($.tagNameCheck,F)||$.tagNameCheck instanceof Function&&$.tagNameCheck(F)))return!1;if(at&&!rt[F]){var fe=T(O)||O.parentNode,Ct=C(O)||O.childNodes;if(Ct&&fe)for(var st=Ct.length,it=st-1;it>=0;--it)fe.insertBefore(p(Ct[it],!0),b(O))}return Ir(O),!0}return O instanceof l&&!E$(O)||(F==="noscript"||F==="noembed")&&pt(/<\/no(script|embed)/i,O.innerHTML)?(Ir(O),!0):(G&&O.nodeType===3&&(M=O.textContent,M=tr(M,Pe," "),M=tr(M,Ke," "),M=tr(M,Ce," "),O.textContent!==M&&(Ao(t.removed,{element:O.cloneNode()}),O.textContent=M)),kr("afterSanitizeElements",O,null),!1)},lm=function(O,M,F){if(Xe&&(M==="id"||M==="name")&&(F in n||F in yt))return!1;if(!(B&&!H[M]&&pt(Me,M))){if(!(N&&pt(xe,M))){if(!_[M]||H[M]){if(!(sm(O)&&($.tagNameCheck instanceof RegExp&&pt($.tagNameCheck,O)||$.tagNameCheck instanceof Function&&$.tagNameCheck(O))&&($.attributeNameCheck instanceof RegExp&&pt($.attributeNameCheck,M)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(M))||M==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&pt($.tagNameCheck,F)||$.tagNameCheck instanceof Function&&$.tagNameCheck(F))))return!1}else if(!dr[M]){if(!pt(g,tr(F,y,""))){if(!((M==="src"||M==="xlink:href"||M==="href")&&O!=="script"&&xB(F,"data:")===0&&qr[O])){if(!(te&&!pt(d,tr(F,y,"")))){if(F)return!1}}}}}}return!0},sm=function(O){return O.indexOf("-")>0},um=function(O){var M,F,fe,Ct;kr("beforeSanitizeAttributes",O,null);var st=O.attributes;if(st){var it={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_};for(Ct=st.length;Ct--;){M=st[Ct];var jl=M,qe=jl.name,Pc=jl.namespaceURI;if(F=qe==="value"?M.value:NB(M.value),fe=ae(qe),it.attrName=fe,it.attrValue=F,it.keepAttr=!0,it.forceKeepAttr=void 0,kr("uponSanitizeAttribute",O,it),F=it.attrValue,!it.forceKeepAttr&&($c(qe,O),!!it.keepAttr)){if(!z&&pt(/\/>/i,F)){$c(qe,O);continue}G&&(F=tr(F,Pe," "),F=tr(F,Ke," "),F=tr(F,Ce," "));var cm=ae(O.nodeName);if(lm(cm,fe,F)){if(er&&(fe==="id"||fe==="name")&&($c(qe,O),F=Vt+F),P&&rn(v)==="object"&&typeof v.getAttributeType=="function"&&!Pc)switch(v.getAttributeType(cm,fe)){case"TrustedHTML":F=P.createHTML(F);break;case"TrustedScriptURL":F=P.createScriptURL(F);break}try{Pc?O.setAttributeNS(Pc,qe,F):O.setAttribute(qe,F),qp(t.removed)}catch{}}}}kr("afterSanitizeAttributes",O,null)}},P$=function V(O){var M,F=om(O);for(kr("beforeSanitizeShadowDOM",O,null);M=F.nextNode();)kr("uponSanitizeShadowNode",M,null),!am(M)&&(M.content instanceof i&&V(M.content),um(M));kr("afterSanitizeShadowDOM",O,null)};return t.sanitize=function(V){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M,F,fe,Ct,st;if(mr=!V,mr&&(V="<!-->"),typeof V!="string"&&!_o(V)){if(typeof V.toString!="function")throw Pf("toString is not a function");if(V=V.toString(),typeof V!="string")throw Pf("dirty is not a string, aborting")}if(!t.isSupported){if(rn(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof V=="string")return e.toStaticHTML(V);if(_o(V))return e.toStaticHTML(V.outerHTML)}return V}if(ge||gt(O),t.removed=[],typeof V=="string"&&(At=!1),At){if(V.nodeName){var it=ae(V.nodeName);if(!w[it]||k[it])throw Pf("root node is forbidden and cannot be sanitized in-place")}}else if(V instanceof a)M=im("<!---->"),F=M.ownerDocument.importNode(V,!0),F.nodeType===1&&F.nodeName==="BODY"||F.nodeName==="HTML"?M=F:M.appendChild(F);else{if(!we&&!G&&!se&&V.indexOf("<")===-1)return P&&We?P.createHTML(V):V;if(M=im(V),!M)return we?null:We?E:""}M&&He&&Ir(M.firstChild);for(var jl=om(At?V:M);fe=jl.nextNode();)fe.nodeType===3&&fe===Ct||am(fe)||(fe.content instanceof i&&P$(fe.content),um(fe),Ct=fe);if(Ct=null,At)return V;if(we){if(Se)for(st=me.call(M.ownerDocument);M.firstChild;)st.appendChild(M.firstChild);else st=M;return(_.shadowroot||_.shadowrootmod)&&(st=et.call(r,st,!0)),st}var qe=se?M.outerHTML:M.innerHTML;return se&&w["!doctype"]&&M.ownerDocument&&M.ownerDocument.doctype&&M.ownerDocument.doctype.name&&pt(GB,M.ownerDocument.doctype.name)&&(qe="<!DOCTYPE "+M.ownerDocument.doctype.name+`>
`+qe),G&&(qe=tr(qe,Pe," "),qe=tr(qe,Ke," "),qe=tr(qe,Ce," ")),P&&We?P.createHTML(qe):qe},t.setConfig=function(V){gt(V),ge=!0},t.clearConfig=function(){_e=null,ge=!1},t.isValidAttribute=function(V,O,M){_e||gt({});var F=ae(V),fe=ae(O);return lm(F,fe,M)},t.addHook=function(V,O){typeof O=="function"&&(ie[V]=ie[V]||[],Ao(ie[V],O))},t.removeHook=function(V){if(ie[V])return qp(ie[V])},t.removeHooks=function(V){ie[V]&&(ie[V]=[])},t.removeAllHooks=function(){ie={}},t}var qB=q_(),ZB=K,QB=Bv.codeAt;ZB({target:"String",proto:!0},{codePointAt:function(t){return QB(this,t)}});var JB=Xn,e2=Je,t2=cr,r2=RangeError,n2=function(t){var r=e2(t2(this)),n="",i=JB(t);if(i<0||i==1/0)throw r2("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},Z_=ee,i2=vo,tb=Je,o2=n2,a2=cr,l2=Z_(o2),s2=Z_("".slice),u2=Math.ceil,rb=function(e){return function(t,r,n){var i=tb(a2(t)),o=i2(r),a=i.length,l=n===void 0?" ":tb(n),s,u;return o<=a||l==""?i:(s=o-a,u=l2(l,u2(s/l.length)),u.length>s&&(u=s2(u,0,s)),e?i+u:u+i)}},c2={start:rb(!1),end:rb(!0)},f2=Un,h2=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(f2),d2=K,v2=c2.start,y2=h2;d2({target:"String",proto:!0,forced:y2},{padStart:function(t){return v2(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Q_;function L(){return Q_.apply(null,arguments)}function m2(e){Q_=e}function sr(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Mn(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function ue(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function uy(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(ue(e,t))return!1;return!0}function Tt(e){return e===void 0}function zr(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Il(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function J_(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function an(e,t){for(var r in t)ue(t,r)&&(e[r]=t[r]);return ue(t,"toString")&&(e.toString=t.toString),ue(t,"valueOf")&&(e.valueOf=t.valueOf),e}function $r(e,t,r,n){return CT(e,t,r,n,!0).utc()}function g2(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Z(e){return e._pf==null&&(e._pf=g2()),e._pf}var jh;Array.prototype.some?jh=Array.prototype.some:jh=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function cy(e){if(e._isValid==null){var t=Z(e),r=jh.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function uc(e){var t=$r(NaN);return e!=null?an(Z(t),e):Z(t).userInvalidated=!0,t}var nb=L.momentProperties=[],xf=!1;function fy(e,t){var r,n,i,o=nb.length;if(Tt(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tt(t._i)||(e._i=t._i),Tt(t._f)||(e._f=t._f),Tt(t._l)||(e._l=t._l),Tt(t._strict)||(e._strict=t._strict),Tt(t._tzm)||(e._tzm=t._tzm),Tt(t._isUTC)||(e._isUTC=t._isUTC),Tt(t._offset)||(e._offset=t._offset),Tt(t._pf)||(e._pf=Z(t)),Tt(t._locale)||(e._locale=t._locale),o>0)for(r=0;r<o;r++)n=nb[r],i=t[n],Tt(i)||(e[n]=i);return e}function kl(e){fy(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),xf===!1&&(xf=!0,L.updateOffset(this),xf=!1)}function ur(e){return e instanceof kl||e!=null&&e._isAMomentObject!=null}function eT(e){L.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Qt(e,t){var r=!0;return an(function(){if(L.deprecationHandler!=null&&L.deprecationHandler(null,e),r){var n=[],i,o,a,l=arguments.length;for(o=0;o<l;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(a in arguments[0])ue(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}eT(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var ib={};function tT(e,t){L.deprecationHandler!=null&&L.deprecationHandler(e,t),ib[e]||(eT(t),ib[e]=!0)}L.suppressDeprecationWarnings=!1;L.deprecationHandler=null;function Pr(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function p2(e){var t,r;for(r in e)ue(e,r)&&(t=e[r],Pr(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Vh(e,t){var r=an({},e),n;for(n in t)ue(t,n)&&(Mn(e[n])&&Mn(t[n])?(r[n]={},an(r[n],e[n]),an(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)ue(e,n)&&!ue(t,n)&&Mn(e[n])&&(r[n]=an({},r[n]));return r}function hy(e){e!=null&&this.set(e)}var Wh;Object.keys?Wh=Object.keys:Wh=function(e){var t,r=[];for(t in e)ue(e,t)&&r.push(t);return r};var b2={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function w2(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Pr(n)?n.call(t,r):n}function _r(e,t,r){var n=""+Math.abs(e),i=t-n.length,o=e>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var dy=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ts=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Nf={},Si={};function U(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Si[e]=i),t&&(Si[t[0]]=function(){return _r(i.apply(this,arguments),t[1],t[2])}),r&&(Si[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function S2(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function O2(e){var t=e.match(dy),r,n;for(r=0,n=t.length;r<n;r++)Si[t[r]]?t[r]=Si[t[r]]:t[r]=S2(t[r]);return function(i){var o="",a;for(a=0;a<n;a++)o+=Pr(t[a])?t[a].call(i,e):t[a];return o}}function Es(e,t){return e.isValid()?(t=rT(t,e.localeData()),Nf[t]=Nf[t]||O2(t),Nf[t](e)):e.localeData().invalidDate()}function rT(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(ts.lastIndex=0;r>=0&&ts.test(e);)e=e.replace(ts,n),ts.lastIndex=0,r-=1;return e}var C2={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function _2(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(dy).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var T2="Invalid date";function R2(){return this._invalidDate}var E2="%d",$2=/\d{1,2}/;function P2(e){return this._ordinal.replace("%d",e)}var I2={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function k2(e,t,r,n){var i=this._relativeTime[r];return Pr(i)?i(e,t,r,n):i.replace(/%d/i,e)}function A2(e,t){var r=this._relativeTime[e>0?"future":"past"];return Pr(r)?r(t):r.replace(/%s/i,t)}var Yo={};function ft(e,t){var r=e.toLowerCase();Yo[r]=Yo[r+"s"]=Yo[t]=e}function Jt(e){return typeof e=="string"?Yo[e]||Yo[e.toLowerCase()]:void 0}function vy(e){var t={},r,n;for(n in e)ue(e,n)&&(r=Jt(n),r&&(t[r]=e[n]));return t}var nT={};function ht(e,t){nT[e]=t}function M2(e){var t=[],r;for(r in e)ue(e,r)&&t.push({unit:r,priority:nT[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function cc(e){return e%4===0&&e%100!==0||e%400===0}function Ut(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function re(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Ut(t)),r}function bo(e,t){return function(r){return r!=null?(iT(this,e,r),L.updateOffset(this,t),this):qs(this,e)}}function qs(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function iT(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&cc(e.year())&&e.month()===1&&e.date()===29?(r=re(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),mc(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function x2(e){return e=Jt(e),Pr(this[e])?this[e]():this}function N2(e,t){if(typeof e=="object"){e=vy(e);var r=M2(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=Jt(e),Pr(this[e]))return this[e](t);return this}var oT=/\d/,jt=/\d\d/,aT=/\d{3}/,yy=/\d{4}/,fc=/[+-]?\d{6}/,$e=/\d\d?/,lT=/\d\d\d\d?/,sT=/\d\d\d\d\d\d?/,hc=/\d{1,3}/,my=/\d{1,4}/,dc=/[+-]?\d{1,6}/,wo=/\d+/,vc=/[+-]?\d+/,D2=/Z|[+-]\d\d:?\d\d/gi,yc=/Z|[+-]\d\d(?::?\d\d)?/gi,H2=/[+-]?\d+(\.\d{1,3})?/,Al=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Zs;Zs={};function j(e,t,r){Zs[e]=Pr(t)?t:function(n,i){return n&&r?r:t}}function L2(e,t){return ue(Zs,e)?Zs[e](t._strict,t._locale):new RegExp(F2(e))}function F2(e){return Dt(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,o){return r||n||i||o}))}function Dt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Bh={};function ye(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),zr(t)&&(n=function(o,a){a[t]=re(o)}),i=e.length,r=0;r<i;r++)Bh[e[r]]=n}function Ml(e,t){ye(e,function(r,n,i,o){i._w=i._w||{},t(r,i._w,i,o)})}function j2(e,t,r){t!=null&&ue(Bh,e)&&Bh[e](t,r._a,r,e)}var ct=0,Hr=1,Or=2,Ye=3,ar=4,Lr=5,In=6,V2=7,W2=8;function B2(e,t){return(e%t+t)%t}var Le;Array.prototype.indexOf?Le=Array.prototype.indexOf:Le=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function mc(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=B2(t,12);return e+=(t-r)/12,r===1?cc(e)?29:28:31-r%7%2}U("M",["MM",2],"Mo",function(){return this.month()+1});U("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});U("MMMM",0,0,function(e){return this.localeData().months(this,e)});ft("month","M");ht("month",8);j("M",$e);j("MM",$e,jt);j("MMM",function(e,t){return t.monthsShortRegex(e)});j("MMMM",function(e,t){return t.monthsRegex(e)});ye(["M","MM"],function(e,t){t[Hr]=re(e)-1});ye(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[Hr]=i:Z(r).invalidMonth=e});var z2="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),uT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),cT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,U2=Al,Y2=Al;function G2(e,t){return e?sr(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||cT).test(t)?"format":"standalone"][e.month()]:sr(this._months)?this._months:this._months.standalone}function K2(e,t){return e?sr(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[cT.test(t)?"format":"standalone"][e.month()]:sr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function X2(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=$r([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?t==="MMM"?(i=Le.call(this._shortMonthsParse,a),i!==-1?i:null):(i=Le.call(this._longMonthsParse,a),i!==-1?i:null):t==="MMM"?(i=Le.call(this._shortMonthsParse,a),i!==-1?i:(i=Le.call(this._longMonthsParse,a),i!==-1?i:null)):(i=Le.call(this._longMonthsParse,a),i!==-1?i:(i=Le.call(this._shortMonthsParse,a),i!==-1?i:null))}function q2(e,t,r){var n,i,o;if(this._monthsParseExact)return X2.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=$r([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function fT(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=re(t);else if(t=e.localeData().monthsParse(t),!zr(t))return e}return r=Math.min(e.date(),mc(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function hT(e){return e!=null?(fT(this,e),L.updateOffset(this,!0),this):qs(this,"Month")}function Z2(){return mc(this.year(),this.month())}function Q2(e){return this._monthsParseExact?(ue(this,"_monthsRegex")||dT.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(ue(this,"_monthsShortRegex")||(this._monthsShortRegex=U2),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function J2(e){return this._monthsParseExact?(ue(this,"_monthsRegex")||dT.call(this),e?this._monthsStrictRegex:this._monthsRegex):(ue(this,"_monthsRegex")||(this._monthsRegex=Y2),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function dT(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=$r([2e3,i]),t.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Dt(t[i]),r[i]=Dt(r[i]);for(i=0;i<24;i++)n[i]=Dt(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}U("Y",0,0,function(){var e=this.year();return e<=9999?_r(e,4):"+"+e});U(0,["YY",2],0,function(){return this.year()%100});U(0,["YYYY",4],0,"year");U(0,["YYYYY",5],0,"year");U(0,["YYYYYY",6,!0],0,"year");ft("year","y");ht("year",1);j("Y",vc);j("YY",$e,jt);j("YYYY",my,yy);j("YYYYY",dc,fc);j("YYYYYY",dc,fc);ye(["YYYYY","YYYYYY"],ct);ye("YYYY",function(e,t){t[ct]=e.length===2?L.parseTwoDigitYear(e):re(e)});ye("YY",function(e,t){t[ct]=L.parseTwoDigitYear(e)});ye("Y",function(e,t){t[ct]=parseInt(e,10)});function Go(e){return cc(e)?366:365}L.parseTwoDigitYear=function(e){return re(e)+(re(e)>68?1900:2e3)};var vT=bo("FullYear",!0);function ez(){return cc(this.year())}function tz(e,t,r,n,i,o,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,i,o,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,i,o,a),l}function ia(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Qs(e,t,r){var n=7+t-r,i=(7+ia(e,0,n).getUTCDay()-t)%7;return-i+n-1}function yT(e,t,r,n,i){var o=(7+r-n)%7,a=Qs(e,n,i),l=1+7*(t-1)+o+a,s,u;return l<=0?(s=e-1,u=Go(s)+l):l>Go(e)?(s=e+1,u=l-Go(e)):(s=e,u=l),{year:s,dayOfYear:u}}function oa(e,t,r){var n=Qs(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,o,a;return i<1?(a=e.year()-1,o=i+Fr(a,t,r)):i>Fr(e.year(),t,r)?(o=i-Fr(e.year(),t,r),a=e.year()+1):(a=e.year(),o=i),{week:o,year:a}}function Fr(e,t,r){var n=Qs(e,t,r),i=Qs(e+1,t,r);return(Go(e)-n+i)/7}U("w",["ww",2],"wo","week");U("W",["WW",2],"Wo","isoWeek");ft("week","w");ft("isoWeek","W");ht("week",5);ht("isoWeek",5);j("w",$e);j("ww",$e,jt);j("W",$e);j("WW",$e,jt);Ml(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=re(e)});function rz(e){return oa(e,this._week.dow,this._week.doy).week}var nz={dow:0,doy:6};function iz(){return this._week.dow}function oz(){return this._week.doy}function az(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function lz(e){var t=oa(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}U("d",0,"do","day");U("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});U("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});U("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});U("e",0,0,"weekday");U("E",0,0,"isoWeekday");ft("day","d");ft("weekday","e");ft("isoWeekday","E");ht("day",11);ht("weekday",11);ht("isoWeekday",11);j("d",$e);j("e",$e);j("E",$e);j("dd",function(e,t){return t.weekdaysMinRegex(e)});j("ddd",function(e,t){return t.weekdaysShortRegex(e)});j("dddd",function(e,t){return t.weekdaysRegex(e)});Ml(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:Z(r).invalidWeekday=e});Ml(["d","e","E"],function(e,t,r,n){t[n]=re(e)});function sz(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function uz(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function gy(e,t){return e.slice(t,7).concat(e.slice(0,t))}var cz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),mT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),fz="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),hz=Al,dz=Al,vz=Al;function yz(e,t){var r=sr(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?gy(r,this._week.dow):e?r[e.day()]:r}function mz(e){return e===!0?gy(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function gz(e){return e===!0?gy(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function pz(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=$r([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?t==="dddd"?(i=Le.call(this._weekdaysParse,a),i!==-1?i:null):t==="ddd"?(i=Le.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=Le.call(this._minWeekdaysParse,a),i!==-1?i:null):t==="dddd"?(i=Le.call(this._weekdaysParse,a),i!==-1||(i=Le.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=Le.call(this._minWeekdaysParse,a),i!==-1?i:null)):t==="ddd"?(i=Le.call(this._shortWeekdaysParse,a),i!==-1||(i=Le.call(this._weekdaysParse,a),i!==-1)?i:(i=Le.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=Le.call(this._minWeekdaysParse,a),i!==-1||(i=Le.call(this._weekdaysParse,a),i!==-1)?i:(i=Le.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function bz(e,t,r){var n,i,o;if(this._weekdaysParseExact)return pz.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=$r([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function wz(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=sz(e,this.localeData()),this.add(e-t,"d")):t}function Sz(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Oz(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=uz(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Cz(e){return this._weekdaysParseExact?(ue(this,"_weekdaysRegex")||py.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(ue(this,"_weekdaysRegex")||(this._weekdaysRegex=hz),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function _z(e){return this._weekdaysParseExact?(ue(this,"_weekdaysRegex")||py.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ue(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=dz),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Tz(e){return this._weekdaysParseExact?(ue(this,"_weekdaysRegex")||py.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ue(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=vz),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function py(){function e(c,f){return f.length-c.length}var t=[],r=[],n=[],i=[],o,a,l,s,u;for(o=0;o<7;o++)a=$r([2e3,1]).day(o),l=Dt(this.weekdaysMin(a,"")),s=Dt(this.weekdaysShort(a,"")),u=Dt(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),i.push(l),i.push(s),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function by(){return this.hours()%12||12}function Rz(){return this.hours()||24}U("H",["HH",2],0,"hour");U("h",["hh",2],0,by);U("k",["kk",2],0,Rz);U("hmm",0,0,function(){return""+by.apply(this)+_r(this.minutes(),2)});U("hmmss",0,0,function(){return""+by.apply(this)+_r(this.minutes(),2)+_r(this.seconds(),2)});U("Hmm",0,0,function(){return""+this.hours()+_r(this.minutes(),2)});U("Hmmss",0,0,function(){return""+this.hours()+_r(this.minutes(),2)+_r(this.seconds(),2)});function gT(e,t){U(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}gT("a",!0);gT("A",!1);ft("hour","h");ht("hour",13);function pT(e,t){return t._meridiemParse}j("a",pT);j("A",pT);j("H",$e);j("h",$e);j("k",$e);j("HH",$e,jt);j("hh",$e,jt);j("kk",$e,jt);j("hmm",lT);j("hmmss",sT);j("Hmm",lT);j("Hmmss",sT);ye(["H","HH"],Ye);ye(["k","kk"],function(e,t,r){var n=re(e);t[Ye]=n===24?0:n});ye(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ye(["h","hh"],function(e,t,r){t[Ye]=re(e),Z(r).bigHour=!0});ye("hmm",function(e,t,r){var n=e.length-2;t[Ye]=re(e.substr(0,n)),t[ar]=re(e.substr(n)),Z(r).bigHour=!0});ye("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[Ye]=re(e.substr(0,n)),t[ar]=re(e.substr(n,2)),t[Lr]=re(e.substr(i)),Z(r).bigHour=!0});ye("Hmm",function(e,t,r){var n=e.length-2;t[Ye]=re(e.substr(0,n)),t[ar]=re(e.substr(n))});ye("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[Ye]=re(e.substr(0,n)),t[ar]=re(e.substr(n,2)),t[Lr]=re(e.substr(i))});function Ez(e){return(e+"").toLowerCase().charAt(0)==="p"}var $z=/[ap]\.?m?\.?/i,Pz=bo("Hours",!0);function Iz(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var bT={calendar:b2,longDateFormat:C2,invalidDate:T2,ordinal:E2,dayOfMonthOrdinalParse:$2,relativeTime:I2,months:z2,monthsShort:uT,week:nz,weekdays:cz,weekdaysMin:fz,weekdaysShort:mT,meridiemParse:$z},Ie={},Mo={},aa;function kz(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function ob(e){return e&&e.toLowerCase().replace("_","-")}function Az(e){for(var t=0,r,n,i,o;t<e.length;){for(o=ob(e[t]).split("-"),r=o.length,n=ob(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=gc(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&kz(o,n)>=r-1)break;r--}t++}return aa}function Mz(e){return e.match("^[^/\\\\]*$")!=null}function gc(e){var t=null,r;if(Ie[e]===void 0&&typeof module<"u"&&module&&module.exports&&Mz(e))try{t=aa._abbr,r=require,r("./locale/"+e),fn(t)}catch{Ie[e]=null}return Ie[e]}function fn(e,t){var r;return e&&(Tt(t)?r=Kr(e):r=wy(e,t),r?aa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),aa._abbr}function wy(e,t){if(t!==null){var r,n=bT;if(t.abbr=e,Ie[e]!=null)tT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ie[e]._config;else if(t.parentLocale!=null)if(Ie[t.parentLocale]!=null)n=Ie[t.parentLocale]._config;else if(r=gc(t.parentLocale),r!=null)n=r._config;else return Mo[t.parentLocale]||(Mo[t.parentLocale]=[]),Mo[t.parentLocale].push({name:e,config:t}),null;return Ie[e]=new hy(Vh(n,t)),Mo[e]&&Mo[e].forEach(function(i){wy(i.name,i.config)}),fn(e),Ie[e]}else return delete Ie[e],null}function xz(e,t){if(t!=null){var r,n,i=bT;Ie[e]!=null&&Ie[e].parentLocale!=null?Ie[e].set(Vh(Ie[e]._config,t)):(n=gc(e),n!=null&&(i=n._config),t=Vh(i,t),n==null&&(t.abbr=e),r=new hy(t),r.parentLocale=Ie[e],Ie[e]=r),fn(e)}else Ie[e]!=null&&(Ie[e].parentLocale!=null?(Ie[e]=Ie[e].parentLocale,e===fn()&&fn(e)):Ie[e]!=null&&delete Ie[e]);return Ie[e]}function Kr(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return aa;if(!sr(e)){if(t=gc(e),t)return t;e=[e]}return Az(e)}function Nz(){return Wh(Ie)}function Sy(e){var t,r=e._a;return r&&Z(e).overflow===-2&&(t=r[Hr]<0||r[Hr]>11?Hr:r[Or]<1||r[Or]>mc(r[ct],r[Hr])?Or:r[Ye]<0||r[Ye]>24||r[Ye]===24&&(r[ar]!==0||r[Lr]!==0||r[In]!==0)?Ye:r[ar]<0||r[ar]>59?ar:r[Lr]<0||r[Lr]>59?Lr:r[In]<0||r[In]>999?In:-1,Z(e)._overflowDayOfYear&&(t<ct||t>Or)&&(t=Or),Z(e)._overflowWeeks&&t===-1&&(t=V2),Z(e)._overflowWeekday&&t===-1&&(t=W2),Z(e).overflow=t),e}var Dz=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hz=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lz=/Z|[+-]\d\d(?::?\d\d)?/,rs=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Df=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Fz=/^\/?Date\((-?\d+)/i,jz=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Vz={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function wT(e){var t,r,n=e._i,i=Dz.exec(n)||Hz.exec(n),o,a,l,s,u=rs.length,c=Df.length;if(i){for(Z(e).iso=!0,t=0,r=u;t<r;t++)if(rs[t][1].exec(i[1])){a=rs[t][0],o=rs[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(i[3]){for(t=0,r=c;t<r;t++)if(Df[t][1].exec(i[3])){l=(i[2]||" ")+Df[t][0];break}if(l==null){e._isValid=!1;return}}if(!o&&l!=null){e._isValid=!1;return}if(i[4])if(Lz.exec(i[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),Cy(e)}else e._isValid=!1}function Wz(e,t,r,n,i,o){var a=[Bz(e),uT.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function Bz(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function zz(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Uz(e,t,r){if(e){var n=mT.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return Z(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Yz(e,t,r){if(e)return Vz[e];if(t)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function ST(e){var t=jz.exec(zz(e._i)),r;if(t){if(r=Wz(t[4],t[3],t[2],t[5],t[6],t[7]),!Uz(t[1],r,e))return;e._a=r,e._tzm=Yz(t[8],t[9],t[10]),e._d=ia.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Z(e).rfc2822=!0}else e._isValid=!1}function Gz(e){var t=Fz.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(wT(e),e._isValid===!1)delete e._isValid;else return;if(ST(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:L.createFromInputFallback(e)}L.createFromInputFallback=Qt("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function vi(e,t,r){return e??t??r}function Kz(e){var t=new Date(L.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Oy(e){var t,r,n=[],i,o,a;if(!e._d){for(i=Kz(e),e._w&&e._a[Or]==null&&e._a[Hr]==null&&Xz(e),e._dayOfYear!=null&&(a=vi(e._a[ct],i[ct]),(e._dayOfYear>Go(a)||e._dayOfYear===0)&&(Z(e)._overflowDayOfYear=!0),r=ia(a,0,e._dayOfYear),e._a[Hr]=r.getUTCMonth(),e._a[Or]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Ye]===24&&e._a[ar]===0&&e._a[Lr]===0&&e._a[In]===0&&(e._nextDay=!0,e._a[Ye]=0),e._d=(e._useUTC?ia:tz).apply(null,n),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ye]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==o&&(Z(e).weekdayMismatch=!0)}}function Xz(e){var t,r,n,i,o,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(o=1,a=4,r=vi(t.GG,e._a[ct],oa(Re(),1,4).year),n=vi(t.W,1),i=vi(t.E,1),(i<1||i>7)&&(s=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,u=oa(Re(),o,a),r=vi(t.gg,e._a[ct],u.year),n=vi(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(s=!0)):t.e!=null?(i=t.e+o,(t.e<0||t.e>6)&&(s=!0)):i=o),n<1||n>Fr(r,o,a)?Z(e)._overflowWeeks=!0:s!=null?Z(e)._overflowWeekday=!0:(l=yT(r,n,i,o,a),e._a[ct]=l.year,e._dayOfYear=l.dayOfYear)}L.ISO_8601=function(){};L.RFC_2822=function(){};function Cy(e){if(e._f===L.ISO_8601){wT(e);return}if(e._f===L.RFC_2822){ST(e);return}e._a=[],Z(e).empty=!0;var t=""+e._i,r,n,i,o,a,l=t.length,s=0,u,c;for(i=rT(e._f,e._locale).match(dy)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(t.match(L2(o,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Z(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),Si[o]?(n?Z(e).empty=!1:Z(e).unusedTokens.push(o),j2(o,n,e)):e._strict&&!n&&Z(e).unusedTokens.push(o);Z(e).charsLeftOver=l-s,t.length>0&&Z(e).unusedInput.push(t),e._a[Ye]<=12&&Z(e).bigHour===!0&&e._a[Ye]>0&&(Z(e).bigHour=void 0),Z(e).parsedDateParts=e._a.slice(0),Z(e).meridiem=e._meridiem,e._a[Ye]=qz(e._locale,e._a[Ye],e._meridiem),u=Z(e).era,u!==null&&(e._a[ct]=e._locale.erasConvertYear(u,e._a[ct])),Oy(e),Sy(e)}function qz(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Zz(e){var t,r,n,i,o,a,l=!1,s=e._f.length;if(s===0){Z(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<s;i++)o=0,a=!1,t=fy({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],Cy(t),cy(t)&&(a=!0),o+=Z(t).charsLeftOver,o+=Z(t).unusedTokens.length*10,Z(t).score=o,l?o<n&&(n=o,r=t):(n==null||o<n||a)&&(n=o,r=t,a&&(l=!0));an(e,r||t)}function Qz(e){if(!e._d){var t=vy(e._i),r=t.day===void 0?t.date:t.day;e._a=J_([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),Oy(e)}}function Jz(e){var t=new kl(Sy(OT(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function OT(e){var t=e._i,r=e._f;return e._locale=e._locale||Kr(e._l),t===null||r===void 0&&t===""?uc({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),ur(t)?new kl(Sy(t)):(Il(t)?e._d=t:sr(r)?Zz(e):r?Cy(e):eU(e),cy(e)||(e._d=null),e))}function eU(e){var t=e._i;Tt(t)?e._d=new Date(L.now()):Il(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Gz(e):sr(t)?(e._a=J_(t.slice(0),function(r){return parseInt(r,10)}),Oy(e)):Mn(t)?Qz(e):zr(t)?e._d=new Date(t):L.createFromInputFallback(e)}function CT(e,t,r,n,i){var o={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Mn(e)&&uy(e)||sr(e)&&e.length===0)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,Jz(o)}function Re(e,t,r,n){return CT(e,t,r,n,!1)}var tU=Qt("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Re.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:uc()}),rU=Qt("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Re.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:uc()});function _T(e,t){var r,n;if(t.length===1&&sr(t[0])&&(t=t[0]),!t.length)return Re();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function nU(){var e=[].slice.call(arguments,0);return _T("isBefore",e)}function iU(){var e=[].slice.call(arguments,0);return _T("isAfter",e)}var oU=function(){return Date.now?Date.now():+new Date},xo=["year","quarter","month","week","day","hour","minute","second","millisecond"];function aU(e){var t,r=!1,n,i=xo.length;for(t in e)if(ue(e,t)&&!(Le.call(xo,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[xo[n]]){if(r)return!1;parseFloat(e[xo[n]])!==re(e[xo[n]])&&(r=!0)}return!0}function lU(){return this._isValid}function sU(){return fr(NaN)}function pc(e){var t=vy(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=aU(t),this._milliseconds=+c+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Kr(),this._bubble()}function $s(e){return e instanceof pc}function zh(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function uU(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&re(e[a])!==re(t[a]))&&o++;return o+i}function TT(e,t){U(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+_r(~~(r/60),2)+t+_r(~~r%60,2)})}TT("Z",":");TT("ZZ","");j("Z",yc);j("ZZ",yc);ye(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=_y(yc,e)});var cU=/([\+\-]|\d\d)/gi;function _y(e,t){var r=(t||"").match(e),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(cU)||["-",0,0],o=+(i[1]*60)+re(i[2]),o===0?0:i[0]==="+"?o:-o)}function Ty(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(ur(e)||Il(e)?e.valueOf():Re(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),L.updateOffset(r,!1),r):Re(e).local()}function Uh(e){return-Math.round(e._d.getTimezoneOffset())}L.updateOffset=function(){};function fU(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=_y(yc,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=Uh(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?$T(this,fr(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,L.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Uh(this)}function hU(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function dU(e){return this.utcOffset(0,e)}function vU(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Uh(this),"m")),this}function yU(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=_y(D2,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function mU(e){return this.isValid()?(e=e?Re(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function gU(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pU(){if(!Tt(this._isDSTShifted))return this._isDSTShifted;var e={},t;return fy(e,this),e=OT(e),e._a?(t=e._isUTC?$r(e._a):Re(e._a),this._isDSTShifted=this.isValid()&&uU(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function bU(){return this.isValid()?!this._isUTC:!1}function wU(){return this.isValid()?this._isUTC:!1}function RT(){return this.isValid()?this._isUTC&&this._offset===0:!1}var SU=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,OU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function fr(e,t){var r=e,n=null,i,o,a;return $s(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:zr(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=SU.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:re(n[Or])*i,h:re(n[Ye])*i,m:re(n[ar])*i,s:re(n[Lr])*i,ms:re(zh(n[In]*1e3))*i}):(n=OU.exec(e))?(i=n[1]==="-"?-1:1,r={y:Cn(n[2],i),M:Cn(n[3],i),w:Cn(n[4],i),d:Cn(n[5],i),h:Cn(n[6],i),m:Cn(n[7],i),s:Cn(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=CU(Re(r.from),Re(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),o=new pc(r),$s(e)&&ue(e,"_locale")&&(o._locale=e._locale),$s(e)&&ue(e,"_isValid")&&(o._isValid=e._isValid),o}fr.fn=pc.prototype;fr.invalid=sU;function Cn(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function ab(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function CU(e,t){var r;return e.isValid()&&t.isValid()?(t=Ty(t,e),e.isBefore(t)?r=ab(e,t):(r=ab(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function ET(e,t){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(tT(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=fr(r,n),$T(this,i,e),this}}function $T(e,t,r,n){var i=t._milliseconds,o=zh(t._days),a=zh(t._months);e.isValid()&&(n=n??!0,a&&fT(e,qs(e,"Month")+a*r),o&&iT(e,"Date",qs(e,"Date")+o*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&L.updateOffset(e,o||a))}var _U=ET(1,"add"),TU=ET(-1,"subtract");function PT(e){return typeof e=="string"||e instanceof String}function RU(e){return ur(e)||Il(e)||PT(e)||zr(e)||$U(e)||EU(e)||e===null||e===void 0}function EU(e){var t=Mn(e)&&!uy(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,a=n.length;for(i=0;i<a;i+=1)o=n[i],r=r||ue(e,o);return t&&r}function $U(e){var t=sr(e),r=!1;return t&&(r=e.filter(function(n){return!zr(n)&&PT(e)}).length===0),t&&r}function PU(e){var t=Mn(e)&&!uy(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||ue(e,o);return t&&r}function IU(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function kU(e,t){arguments.length===1&&(arguments[0]?RU(arguments[0])?(e=arguments[0],t=void 0):PU(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Re(),n=Ty(r,this).startOf("day"),i=L.calendarFormat(this,n)||"sameElse",o=t&&(Pr(t[i])?t[i].call(this,r):t[i]);return this.format(o||this.localeData().calendar(i,this,Re(r)))}function AU(){return new kl(this)}function MU(e,t){var r=ur(e)?e:Re(e);return this.isValid()&&r.isValid()?(t=Jt(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function xU(e,t){var r=ur(e)?e:Re(e);return this.isValid()&&r.isValid()?(t=Jt(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function NU(e,t,r,n){var i=ur(e)?e:Re(e),o=ur(t)?t:Re(t);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function DU(e,t){var r=ur(e)?e:Re(e),n;return this.isValid()&&r.isValid()?(t=Jt(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function HU(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function LU(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function FU(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(n=Ty(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=Jt(t),t){case"year":o=Ps(this,n)/12;break;case"month":o=Ps(this,n);break;case"quarter":o=Ps(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ut(o)}function Ps(e,t){if(e.date()<t.date())return-Ps(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,o;return t-n<0?(i=e.clone().add(r-1,"months"),o=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),o=(t-n)/(i-n)),-(r+o)||0}L.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";L.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function jU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function VU(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Es(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Pr(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Es(r,"Z")):Es(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function WU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,o;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]',this.format(r+n+i+o)}function BU(e){e||(e=this.isUtc()?L.defaultFormatUtc:L.defaultFormat);var t=Es(this,e);return this.localeData().postformat(t)}function zU(e,t){return this.isValid()&&(ur(e)&&e.isValid()||Re(e).isValid())?fr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function UU(e){return this.from(Re(),e)}function YU(e,t){return this.isValid()&&(ur(e)&&e.isValid()||Re(e).isValid())?fr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function GU(e){return this.to(Re(),e)}function IT(e){var t;return e===void 0?this._locale._abbr:(t=Kr(e),t!=null&&(this._locale=t),this)}var kT=Qt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function AT(){return this._locale}var Js=1e3,Oi=60*Js,eu=60*Oi,MT=(365*400+97)*24*eu;function Ci(e,t){return(e%t+t)%t}function xT(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-MT:new Date(e,t,r).valueOf()}function NT(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-MT:Date.UTC(e,t,r)}function KU(e){var t,r;if(e=Jt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?NT:xT,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Ci(t+(this._isUTC?0:this.utcOffset()*Oi),eu);break;case"minute":t=this._d.valueOf(),t-=Ci(t,Oi);break;case"second":t=this._d.valueOf(),t-=Ci(t,Js);break}return this._d.setTime(t),L.updateOffset(this,!0),this}function XU(e){var t,r;if(e=Jt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?NT:xT,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=eu-Ci(t+(this._isUTC?0:this.utcOffset()*Oi),eu)-1;break;case"minute":t=this._d.valueOf(),t+=Oi-Ci(t,Oi)-1;break;case"second":t=this._d.valueOf(),t+=Js-Ci(t,Js)-1;break}return this._d.setTime(t),L.updateOffset(this,!0),this}function qU(){return this._d.valueOf()-(this._offset||0)*6e4}function ZU(){return Math.floor(this.valueOf()/1e3)}function QU(){return new Date(this.valueOf())}function JU(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function eY(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function tY(){return this.isValid()?this.toISOString():null}function rY(){return cy(this)}function nY(){return an({},Z(this))}function iY(){return Z(this).overflow}function oY(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}U("N",0,0,"eraAbbr");U("NN",0,0,"eraAbbr");U("NNN",0,0,"eraAbbr");U("NNNN",0,0,"eraName");U("NNNNN",0,0,"eraNarrow");U("y",["y",1],"yo","eraYear");U("y",["yy",2],0,"eraYear");U("y",["yyy",3],0,"eraYear");U("y",["yyyy",4],0,"eraYear");j("N",Ry);j("NN",Ry);j("NNN",Ry);j("NNNN",mY);j("NNNNN",gY);ye(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?Z(r).era=i:Z(r).invalidEra=e});j("y",wo);j("yy",wo);j("yyy",wo);j("yyyy",wo);j("yo",pY);ye(["y","yy","yyy","yyyy"],ct);ye(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ct]=r._locale.eraYearOrdinalParse(e,i):t[ct]=parseInt(e,10)});function aY(e,t){var r,n,i,o=this._eras||Kr("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=L(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=L(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function lY(e,t,r){var n,i,o=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,i=o.length;n<i;++n)if(a=o[n].name.toUpperCase(),l=o[n].abbr.toUpperCase(),s=o[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return o[n];break;case"NNNN":if(a===e)return o[n];break;case"NNNNN":if(s===e)return o[n];break}else if([a,l,s].indexOf(e)>=0)return o[n]}function sY(e,t){var r=e.since<=e.until?1:-1;return t===void 0?L(e.since).year():L(e.since).year()+(t-e.offset)*r}function uY(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function cY(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function fY(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function hY(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-L(i[e].since).year())*r+i[e].offset;return this.year()}function dY(e){return ue(this,"_erasNameRegex")||Ey.call(this),e?this._erasNameRegex:this._erasRegex}function vY(e){return ue(this,"_erasAbbrRegex")||Ey.call(this),e?this._erasAbbrRegex:this._erasRegex}function yY(e){return ue(this,"_erasNarrowRegex")||Ey.call(this),e?this._erasNarrowRegex:this._erasRegex}function Ry(e,t){return t.erasAbbrRegex(e)}function mY(e,t){return t.erasNameRegex(e)}function gY(e,t){return t.erasNarrowRegex(e)}function pY(e,t){return t._eraYearOrdinalRegex||wo}function Ey(){var e=[],t=[],r=[],n=[],i,o,a=this.eras();for(i=0,o=a.length;i<o;++i)t.push(Dt(a[i].name)),e.push(Dt(a[i].abbr)),r.push(Dt(a[i].narrow)),n.push(Dt(a[i].name)),n.push(Dt(a[i].abbr)),n.push(Dt(a[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}U(0,["gg",2],0,function(){return this.weekYear()%100});U(0,["GG",2],0,function(){return this.isoWeekYear()%100});function bc(e,t){U(0,[e,e.length],0,t)}bc("gggg","weekYear");bc("ggggg","weekYear");bc("GGGG","isoWeekYear");bc("GGGGG","isoWeekYear");ft("weekYear","gg");ft("isoWeekYear","GG");ht("weekYear",1);ht("isoWeekYear",1);j("G",vc);j("g",vc);j("GG",$e,jt);j("gg",$e,jt);j("GGGG",my,yy);j("gggg",my,yy);j("GGGGG",dc,fc);j("ggggg",dc,fc);Ml(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=re(e)});Ml(["gg","GG"],function(e,t,r,n){t[n]=L.parseTwoDigitYear(e)});function bY(e){return DT.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function wY(e){return DT.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function SY(){return Fr(this.year(),1,4)}function OY(){return Fr(this.isoWeekYear(),1,4)}function CY(){var e=this.localeData()._week;return Fr(this.year(),e.dow,e.doy)}function _Y(){var e=this.localeData()._week;return Fr(this.weekYear(),e.dow,e.doy)}function DT(e,t,r,n,i){var o;return e==null?oa(this,n,i).year:(o=Fr(e,n,i),t>o&&(t=o),TY.call(this,e,t,r,n,i))}function TY(e,t,r,n,i){var o=yT(e,t,r,n,i),a=ia(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}U("Q",0,"Qo","quarter");ft("quarter","Q");ht("quarter",7);j("Q",oT);ye("Q",function(e,t){t[Hr]=(re(e)-1)*3});function RY(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}U("D",["DD",2],"Do","date");ft("date","D");ht("date",9);j("D",$e);j("DD",$e,jt);j("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ye(["D","DD"],Or);ye("Do",function(e,t){t[Or]=re(e.match($e)[0])});var HT=bo("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear");ft("dayOfYear","DDD");ht("dayOfYear",4);j("DDD",hc);j("DDDD",aT);ye(["DDD","DDDD"],function(e,t,r){r._dayOfYear=re(e)});function EY(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}U("m",["mm",2],0,"minute");ft("minute","m");ht("minute",14);j("m",$e);j("mm",$e,jt);ye(["m","mm"],ar);var $Y=bo("Minutes",!1);U("s",["ss",2],0,"second");ft("second","s");ht("second",15);j("s",$e);j("ss",$e,jt);ye(["s","ss"],Lr);var PY=bo("Seconds",!1);U("S",0,0,function(){return~~(this.millisecond()/100)});U(0,["SS",2],0,function(){return~~(this.millisecond()/10)});U(0,["SSS",3],0,"millisecond");U(0,["SSSS",4],0,function(){return this.millisecond()*10});U(0,["SSSSS",5],0,function(){return this.millisecond()*100});U(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});U(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});U(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});U(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ft("millisecond","ms");ht("millisecond",16);j("S",hc,oT);j("SS",hc,jt);j("SSS",hc,aT);var ln,LT;for(ln="SSSS";ln.length<=9;ln+="S")j(ln,wo);function IY(e,t){t[In]=re(("0."+e)*1e3)}for(ln="S";ln.length<=9;ln+="S")ye(ln,IY);LT=bo("Milliseconds",!1);U("z",0,0,"zoneAbbr");U("zz",0,0,"zoneName");function kY(){return this._isUTC?"UTC":""}function AY(){return this._isUTC?"Coordinated Universal Time":""}var A=kl.prototype;A.add=_U;A.calendar=kU;A.clone=AU;A.diff=FU;A.endOf=XU;A.format=BU;A.from=zU;A.fromNow=UU;A.to=YU;A.toNow=GU;A.get=x2;A.invalidAt=iY;A.isAfter=MU;A.isBefore=xU;A.isBetween=NU;A.isSame=DU;A.isSameOrAfter=HU;A.isSameOrBefore=LU;A.isValid=rY;A.lang=kT;A.locale=IT;A.localeData=AT;A.max=rU;A.min=tU;A.parsingFlags=nY;A.set=N2;A.startOf=KU;A.subtract=TU;A.toArray=JU;A.toObject=eY;A.toDate=QU;A.toISOString=VU;A.inspect=WU;typeof Symbol<"u"&&Symbol.for!=null&&(A[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});A.toJSON=tY;A.toString=jU;A.unix=ZU;A.valueOf=qU;A.creationData=oY;A.eraName=uY;A.eraNarrow=cY;A.eraAbbr=fY;A.eraYear=hY;A.year=vT;A.isLeapYear=ez;A.weekYear=bY;A.isoWeekYear=wY;A.quarter=A.quarters=RY;A.month=hT;A.daysInMonth=Z2;A.week=A.weeks=az;A.isoWeek=A.isoWeeks=lz;A.weeksInYear=CY;A.weeksInWeekYear=_Y;A.isoWeeksInYear=SY;A.isoWeeksInISOWeekYear=OY;A.date=HT;A.day=A.days=wz;A.weekday=Sz;A.isoWeekday=Oz;A.dayOfYear=EY;A.hour=A.hours=Pz;A.minute=A.minutes=$Y;A.second=A.seconds=PY;A.millisecond=A.milliseconds=LT;A.utcOffset=fU;A.utc=dU;A.local=vU;A.parseZone=yU;A.hasAlignedHourOffset=mU;A.isDST=gU;A.isLocal=bU;A.isUtcOffset=wU;A.isUtc=RT;A.isUTC=RT;A.zoneAbbr=kY;A.zoneName=AY;A.dates=Qt("dates accessor is deprecated. Use date instead.",HT);A.months=Qt("months accessor is deprecated. Use month instead",hT);A.years=Qt("years accessor is deprecated. Use year instead",vT);A.zone=Qt("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hU);A.isDSTShifted=Qt("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pU);function MY(e){return Re(e*1e3)}function xY(){return Re.apply(null,arguments).parseZone()}function FT(e){return e}var ce=hy.prototype;ce.calendar=w2;ce.longDateFormat=_2;ce.invalidDate=R2;ce.ordinal=P2;ce.preparse=FT;ce.postformat=FT;ce.relativeTime=k2;ce.pastFuture=A2;ce.set=p2;ce.eras=aY;ce.erasParse=lY;ce.erasConvertYear=sY;ce.erasAbbrRegex=vY;ce.erasNameRegex=dY;ce.erasNarrowRegex=yY;ce.months=G2;ce.monthsShort=K2;ce.monthsParse=q2;ce.monthsRegex=J2;ce.monthsShortRegex=Q2;ce.week=rz;ce.firstDayOfYear=oz;ce.firstDayOfWeek=iz;ce.weekdays=yz;ce.weekdaysMin=gz;ce.weekdaysShort=mz;ce.weekdaysParse=bz;ce.weekdaysRegex=Cz;ce.weekdaysShortRegex=_z;ce.weekdaysMinRegex=Tz;ce.isPM=Ez;ce.meridiem=Iz;function tu(e,t,r,n){var i=Kr(),o=$r().set(n,t);return i[r](o,e)}function jT(e,t,r){if(zr(e)&&(t=e,e=void 0),e=e||"",t!=null)return tu(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=tu(e,n,r,"month");return i}function $y(e,t,r,n){typeof e=="boolean"?(zr(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,zr(t)&&(r=t,t=void 0),t=t||"");var i=Kr(),o=e?i._week.dow:0,a,l=[];if(r!=null)return tu(t,(r+o)%7,n,"day");for(a=0;a<7;a++)l[a]=tu(t,(a+o)%7,n,"day");return l}function NY(e,t){return jT(e,t,"months")}function DY(e,t){return jT(e,t,"monthsShort")}function HY(e,t,r){return $y(e,t,r,"weekdays")}function LY(e,t,r){return $y(e,t,r,"weekdaysShort")}function FY(e,t,r){return $y(e,t,r,"weekdaysMin")}fn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=re(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});L.lang=Qt("moment.lang is deprecated. Use moment.locale instead.",fn);L.langData=Qt("moment.langData is deprecated. Use moment.localeData instead.",Kr);var Ar=Math.abs;function jY(){var e=this._data;return this._milliseconds=Ar(this._milliseconds),this._days=Ar(this._days),this._months=Ar(this._months),e.milliseconds=Ar(e.milliseconds),e.seconds=Ar(e.seconds),e.minutes=Ar(e.minutes),e.hours=Ar(e.hours),e.months=Ar(e.months),e.years=Ar(e.years),this}function VT(e,t,r,n){var i=fr(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function VY(e,t){return VT(this,e,t,1)}function WY(e,t){return VT(this,e,t,-1)}function lb(e){return e<0?Math.floor(e):Math.ceil(e)}function BY(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,o,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=lb(Yh(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Ut(e/1e3),n.seconds=i%60,o=Ut(i/60),n.minutes=o%60,a=Ut(o/60),n.hours=a%24,t+=Ut(a/24),s=Ut(WT(t)),r+=s,t-=lb(Yh(s)),l=Ut(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function WT(e){return e*4800/146097}function Yh(e){return e*146097/4800}function zY(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Jt(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+WT(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Yh(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function UY(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+re(this._months/12)*31536e6:NaN}function Xr(e){return function(){return this.as(e)}}var YY=Xr("ms"),GY=Xr("s"),KY=Xr("m"),XY=Xr("h"),qY=Xr("d"),ZY=Xr("w"),QY=Xr("M"),JY=Xr("Q"),eG=Xr("y");function tG(){return fr(this)}function rG(e){return e=Jt(e),this.isValid()?this[e+"s"]():NaN}function Qn(e){return function(){return this.isValid()?this._data[e]:NaN}}var nG=Qn("milliseconds"),iG=Qn("seconds"),oG=Qn("minutes"),aG=Qn("hours"),lG=Qn("days"),sG=Qn("months"),uG=Qn("years");function cG(){return Ut(this.days()/7)}var Nr=Math.round,bi={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function fG(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function hG(e,t,r,n){var i=fr(e).abs(),o=Nr(i.as("s")),a=Nr(i.as("m")),l=Nr(i.as("h")),s=Nr(i.as("d")),u=Nr(i.as("M")),c=Nr(i.as("w")),f=Nr(i.as("y")),h=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||c<=1&&["w"]||c<r.w&&["ww",c]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=t,h[3]=+e>0,h[4]=n,fG.apply(null,h)}function dG(e){return e===void 0?Nr:typeof e=="function"?(Nr=e,!0):!1}function vG(e,t){return bi[e]===void 0?!1:t===void 0?bi[e]:(bi[e]=t,e==="s"&&(bi.ss=t-1),!0)}function yG(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=bi,i,o;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},bi,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),o=hG(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Hf=Math.abs;function ai(e){return(e>0)-(e<0)||+e}function wc(){if(!this.isValid())return this.localeData().invalidDate();var e=Hf(this._milliseconds)/1e3,t=Hf(this._days),r=Hf(this._months),n,i,o,a,l=this.asSeconds(),s,u,c,f;return l?(n=Ut(e/60),i=Ut(n/60),e%=60,n%=60,o=Ut(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=ai(this._months)!==ai(l)?"-":"",c=ai(this._days)!==ai(l)?"-":"",f=ai(this._milliseconds)!==ai(l)?"-":"",s+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(t?c+t+"D":"")+(i||n||e?"T":"")+(i?f+i+"H":"")+(n?f+n+"M":"")+(e?f+a+"S":"")):"P0D"}var le=pc.prototype;le.isValid=lU;le.abs=jY;le.add=VY;le.subtract=WY;le.as=zY;le.asMilliseconds=YY;le.asSeconds=GY;le.asMinutes=KY;le.asHours=XY;le.asDays=qY;le.asWeeks=ZY;le.asMonths=QY;le.asQuarters=JY;le.asYears=eG;le.valueOf=UY;le._bubble=BY;le.clone=tG;le.get=rG;le.milliseconds=nG;le.seconds=iG;le.minutes=oG;le.hours=aG;le.days=lG;le.weeks=cG;le.months=sG;le.years=uG;le.humanize=yG;le.toISOString=wc;le.toString=wc;le.toJSON=wc;le.locale=IT;le.localeData=AT;le.toIsoString=Qt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",wc);le.lang=kT;U("X",0,0,"unix");U("x",0,0,"valueOf");j("x",vc);j("X",H2);ye("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ye("x",function(e,t,r){r._d=new Date(re(e))});//! moment.js
L.version="2.29.4";m2(Re);L.fn=A;L.min=nU;L.max=iU;L.now=oU;L.utc=$r;L.unix=MY;L.months=NY;L.isDate=Il;L.locale=fn;L.invalid=uc;L.duration=fr;L.isMoment=ur;L.weekdays=HY;L.parseZone=xY;L.localeData=Kr;L.isDuration=$s;L.monthsShort=DY;L.weekdaysMin=FY;L.defineLocale=wy;L.updateLocale=xz;L.locales=Nz;L.weekdaysShort=LY;L.normalizeUnits=Jt;L.relativeTimeRounding=dG;L.relativeTimeThreshold=vG;L.calendarFormat=IU;L.prototype=A;L.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Pt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=lc(e,function(o,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return o+s+u},"");return i.trim()}var sb,ub,cb,fb,hb,db;function _i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Gh(e){return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function BT(e){var t;switch(Gh(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function oe(e){return typeof e<"u"}function bt(e){return typeof e>"u"}function ki(e){return e===null||e===""||bt(e)}function mG(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var zo="length",Ko=function(t){return parseInt(t,16)},vb=function(t){return parseInt(t,10)},ru=function(t,r,n){return t.substr(r,n)},Xo=function(t){return t.codePointAt(0)-65},Kh=function(t){return"".concat(t).replace(/\-/g,"")},gG=function(t){return Ko(ru(Kh(t),Ko("12"),Xo("F")))/(Ko(ru(Kh(t),Xo("B"),~~![][zo]))||9)},pG=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},yb=!1,mb={invalid:function(){return Pt(sb||(sb=_i([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Pt(ub||(ub=_i([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Pt(cb||(cb=_i([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},gb={invalid:function(){return Pt(fb||(fb=_i([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Pt(hb||(hb=_i([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Pt(db||(db=_i([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function bG(e,t){var r=!ki(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",o,a="invalid",l="invalid";e=Kh(e||"");var s=wG(e);if(r||n||s)if(s){var u=L("28/03/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=gG(e);o=L((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(pG()&&(a="valid",l="valid"),!yb&&a!=="valid"){var h=mb[a]({keyValidityDate:o,hotVersion:i});h&&console[a==="non_commercial"?"info":"warn"](mb[a]({keyValidityDate:o,hotVersion:i})),yb=!0}if(l!=="valid"&&t.parentNode){var v=gb[l]({keyValidityDate:o,hotVersion:i});if(v){var m=document.createElement("div");m.className="hot-display-license-info",m.innerHTML=gb[l]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(m,t.nextSibling)}}}function wG(e){var t=[][zo],r=t;if(e[zo]!==Xo("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=Xo(i.shift());o;o=Xo(i.shift()||"A"))--o<""[zo]?r=r|(vb("".concat(vb(Ko(n)+(Ko(ru(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=ru(e,o,o?i[zo]===1?9:8:6);return r===t}function Py(e){return e[0].toUpperCase()+e.substr(1)}function zT(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function SG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function OG(e,t){return qB.sanitize(e,t)}function pb(e){return RG(e)||TG(e)||_G(e)||CG()}function CG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _G(e,t){if(e){if(typeof e=="string")return Xh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xh(e,t)}}function TG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RG(e){if(Array.isArray(e))return Xh(e)}function Xh(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EG(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function $G(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function bb(e){return $G(e)&&e.parent}function UT(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===i&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;f&&s===o?a=f:a=a.parentNode}return null}function ns(e,t,r){for(var n=[],i=e;i&&(i=UT(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function qh(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function PG(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function _n(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var Zh,Qh,Jh;function is(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(OW()){var wb=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};Zh=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},Qh=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=is(i),i.length>0)if(wb(n)){var o;(o=t.classList).add.apply(o,pb(i))}else for(var a=0;i[a];)t.classList.add(i[a]),a+=1},Jh=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=is(i),i.length>0)if(wb(n)){var o;(o=t.classList).remove.apply(o,pb(i))}else for(var a=0;i[a];)t.classList.remove(i[a]),a+=1}}else{var Lf=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};Zh=function(t,r){return t.className!==void 0&&Lf(r).test(t.className)},Qh=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=is(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!Lf(i[o]).test(n)&&(n+=" ".concat(i[o]));t.className=n},Jh=function(t,r){var n=0,i=t.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=is(o);o[n];)i=i.replace(Lf(o[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Ne(e,t){return Zh(e,t)}function he(e,t){Qh(e,t)}function Ue(e,t){Jh(e,t)}function YT(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)YT(t[r])}function Ai(e){for(var t;t=e.lastChild;)e.removeChild(t)}var IG=/(<(.*)>|&(.*);)/;function kG(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;IG.test(t)?e.innerHTML=r?OG(t):t:xl(e,t)}function xl(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?CW?r.textContent=t:r.data=t:(Ai(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function nu(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return nu(r.host.impl);if(r.host)return nu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function $t(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,o,a,l,s;if(B_()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return s=i.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,l=i;(i=i.offsetParent)&&i!==t.body;)o+=i.offsetLeft,a+=i.offsetTop,l=i;return l&&l.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:o,top:a}}function GT(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Iy(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function iu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?GT(t):e.scrollTop}function ed(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Iy(t):e.scrollLeft}function ou(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=_W(),o=e.parentNode;o&&o.style&&t.body!==o;){var a=o.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return o;if(i){var c=r.getComputedStyle(o);if(l=c.overflow,s=c.overflowX,u=c.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(u)||n.includes(l))||o.clientWidth<=o.scrollWidth+1&&(n.includes(s)||n.includes(l)))return o;o=o.parentNode}return r}function au(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Hn(n,r),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),l=i.getPropertyValue("overflow-y"),s=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(l)||o.includes(s))return n;n=n.parentNode}return r}function td(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=Hn(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function Hn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function Qe(e){return e.offsetWidth}function Kt(e){return B_()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function sn(e){return e.clientHeight||e.innerHeight}function Is(e){return e.clientWidth||e.innerWidth}function AG(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function Sb(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function KT(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var Ff;function MG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function wt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ff===void 0&&(Ff=MG(e)),Ff}function xG(e){return e.offsetWidth!==e.clientWidth}function NG(e){return e.offsetHeight!==e.clientHeight}function ky(e,t,r){wB()?(e.style.top=r,e.style.left=t):gB()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Sc(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function rd(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function XT(e){return rd(e)&&e.hasAttribute("data-hot-input")===!1}function DG(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}function ke(e){return typeof e=="function"}function HG(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function nd(e,t,r,n,i,o,a,l){return oe(l)?e.call(t,r,n,i,o,a,l):oe(a)?e.call(t,r,n,i,o,a):oe(o)?e.call(t,r,n,i,o):oe(i)?e.call(t,r,n,i):oe(n)?e.call(t,r,n):oe(r)?e.call(t,r):e.call(t)}function Ln(){if(oe(console)){var e;(e=console).warn.apply(e,arguments)}}function LG(){if(oe(console)){var e;(e=console).error.apply(e,arguments)}}var FG=ee,Ob=Vv,os=xn.getWeakData,jG=Lv,VG=Ve,WG=Rr,jf=je,BG=Hv,qT=qn,Cb=Ae,ZT=Gr,zG=ZT.set,UG=ZT.getterFor,YG=qT.find,GG=qT.findIndex,KG=FG([].splice),XG=0,as=function(e){return e.frozen||(e.frozen=new QT)},QT=function(){this.entries=[]},Vf=function(e,t){return YG(e.entries,function(r){return r[0]===t})};QT.prototype={get:function(e){var t=Vf(this,e);if(t)return t[1]},has:function(e){return!!Vf(this,e)},set:function(e,t){var r=Vf(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=GG(this.entries,function(r){return r[0]===e});return~t&&KG(this.entries,t,1),!!~t}};var qG={getConstructor:function(e,t,r,n){var i=e(function(s,u){jG(s,o),zG(s,{type:t,id:XG++,frozen:void 0}),WG(u)||BG(u,s[n],{that:s,AS_ENTRIES:r})}),o=i.prototype,a=UG(t),l=function(s,u,c){var f=a(s),h=os(VG(u),!0);return h===!0?as(f).set(u,c):h[f.id]=c,s};return Ob(o,{delete:function(s){var u=a(this);if(!jf(s))return!1;var c=os(s);return c===!0?as(u).delete(s):c&&Cb(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!jf(u))return!1;var f=os(u);return f===!0?as(c).has(u):f&&Cb(f,c.id)}}),Ob(o,r?{get:function(u){var c=a(this);if(jf(u)){var f=os(u);return f===!0?as(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return l(this,u,c)}}:{add:function(u){return l(this,u,!0)}}),i}},ZG=$v,_b=be,ks=ee,Tb=Vv,QG=xn,JG=jv,JT=qG,ls=je,ss=Gr.enforce,e3=Q,t3=XO,Nl=Object,r3=Array.isArray,us=Nl.isExtensible,eR=Nl.isFrozen,n3=Nl.isSealed,tR=Nl.freeze,i3=Nl.seal,Rb={},Eb={},o3=!_b.ActiveXObject&&"ActiveXObject"in _b,No,rR=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},nR=JG("WeakMap",rR,JT),yi=nR.prototype,As=ks(yi.set),a3=function(){return ZG&&e3(function(){var e=tR([]);return As(new nR,e,1),!eR(e)})};if(t3)if(o3){No=JT.getConstructor(rR,"WeakMap",!0),QG.enable();var $b=ks(yi.delete),cs=ks(yi.has),Pb=ks(yi.get);Tb(yi,{delete:function(e){if(ls(e)&&!us(e)){var t=ss(this);return t.frozen||(t.frozen=new No),$b(this,e)||t.frozen.delete(e)}return $b(this,e)},has:function(t){if(ls(t)&&!us(t)){var r=ss(this);return r.frozen||(r.frozen=new No),cs(this,t)||r.frozen.has(t)}return cs(this,t)},get:function(t){if(ls(t)&&!us(t)){var r=ss(this);return r.frozen||(r.frozen=new No),cs(this,t)?Pb(this,t):r.frozen.get(t)}return Pb(this,t)},set:function(t,r){if(ls(t)&&!us(t)){var n=ss(this);n.frozen||(n.frozen=new No),cs(this,t)?As(this,t,r):n.frozen.set(t,r)}else As(this,t,r);return this}})}else a3()&&Tb(yi,{set:function(t,r){var n;return r3(t)&&(eR(t)?n=Rb:n3(t)&&(n=Eb)),As(this,t,r),n==Rb&&tR(t),n==Eb&&i3(t),this}});var W={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ef()?182:174,AUDIO_MUTE:Ef()?181:173,AUDIO_UP:Ef()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},l3=[W.ALT,W.ARROW_DOWN,W.ARROW_LEFT,W.ARROW_RIGHT,W.ARROW_UP,W.AUDIO_DOWN,W.AUDIO_MUTE,W.AUDIO_UP,W.BACKSPACE,W.CAPS_LOCK,W.DELETE,W.END,W.ENTER,W.ESCAPE,W.F1,W.F2,W.F3,W.F4,W.F5,W.F6,W.F7,W.F8,W.F9,W.F10,W.F11,W.F12,W.F13,W.F14,W.F15,W.F16,W.F17,W.F18,W.F19,W.HOME,W.INSERT,W.MEDIA_NEXT,W.MEDIA_PLAY_PAUSE,W.MEDIA_PREV,W.MEDIA_STOP,W.NULL,W.NUM_LOCK,W.PAGE_DOWN,W.PAGE_UP,W.PAUSE,W.SCROLL_LOCK,W.SHIFT,W.TAB];function s3(e){return l3.includes(e)}function u3(e){return[W.CONTROL,W.COMMAND_LEFT,W.COMMAND_RIGHT,W.COMMAND_FIREFOX].includes(e)}function c3(e,t){var r=t.split("|"),n=!1;return ve(r,function(i){if(e===W[i])return n=!0,!1}),n}function Ay(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function mi(e){return e.isImmediatePropagationEnabled===!1}function id(e){return e.button===2}function iR(e){return e.button===0}function la(e){return la=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},la(e)}var Ib;function f3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d3(n.key),n)}}function h3(e,t,r){return t&&kb(e.prototype,t),r&&kb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d3(e){var t=v3(e,"string");return la(t)==="symbol"?t:String(t)}function v3(e,t){if(la(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(la(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y3(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var li=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],m3=Pt(Ib||(Ib=y3([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Wf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Bf=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),oR=function(){function e(){f3(this,e),this.globalBucket=this.createEmptyBucket()}return h3(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ve(li,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ve(n,function(s){return i.add(r,s,o)});else{Wf.has(r)&&Ln(SG(m3,{hookName:r,removedInVersion:Wf.get(r)})),Bf.has(r)&&Ln(Bf.get(r));var a=this.getBucket(o);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&ve(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ve(n,function(a){return i.once(r,a,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,a,l,s,u){{var c=this.globalBucket[n],f=c?c.length:0,h=0;if(f)for(;h<f;){if(!c[h]||c[h].skip){h+=1;continue}var v=nd(c[h],r,i,o,a,l,s,u);v!==void 0&&(i=v),c[h]&&c[h].runOnce&&this.remove(n,c[h]),h+=1}}{var m=this.getBucket(r)[n],p=m?m.length:0,b=0;if(p)for(;b<p;){if(!m[b]||m[b].skip){b+=1;continue}var C=nd(m[b],r,i,o,a,l,s,u);C!==void 0&&(i=C),m[b]&&m[b].runOnce&&this.remove(n,m[b],r),b+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Te(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||li.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&li.splice(li.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Bf.has(r)||Wf.has(r)}},{key:"isRegistered",value:function(r){return li.indexOf(r)>=0}},{key:"getRegistered",value:function(){return li}}],[{key:"getSingleton",value:function(){return p3()}}]),e}(),g3=new oR;function p3(){return g3}const Nt=oR;function Ab(e){return O3(e)||S3(e)||w3(e)||b3()}function b3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w3(e,t){if(e){if(typeof e=="string")return od(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return od(e,t)}}function S3(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O3(e){if(Array.isArray(e))return od(e)}function od(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var zf=new Map;function Jn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";zf.has(e)||zf.set(e,new Map);var t=zf.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function i(l){return t.has(l)}function o(){return Ab(t.keys())}function a(){return Ab(t.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:a}}var ad=new WeakMap,My=Jn("editors"),C3=My.register,aR=My.getItem,_3=My.hasItem;function T3(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Nt.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function R3(e,t){var r;if(typeof e=="function")ad.get(e)||lR(null,e),r=ad.get(e);else if(typeof e=="string")r=aR(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function Mb(e){if(typeof e=="function")return e;if(!_3(e))throw Error('No registered editor found under "'.concat(e,'" name'));return aR(e).getConstructor()}function lR(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new T3(t);typeof e=="string"&&C3(e,r),ad.set(t,r)}function sa(e){return sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sa(e)}function E3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P3(n.key),n)}}function $3(e,t,r){return t&&xb(e.prototype,t),r&&xb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P3(e){var t=I3(e,"string");return sa(t)==="symbol"?t:String(t)}function I3(e,t){if(sa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k3=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;E3(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return $3(e,[{key:"addEventListener",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){i.call(this,A3(s))}return typeof a!="boolean"&&!EW()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(i&&i!==l.callback||o&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;i.createEvent?(l=i.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):l=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function A3(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Ay(this)},e}const Dl=k3;function ua(e){return ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ua(e)}function M3(e,t){return H3(e)||D3(e,t)||N3(e,t)||x3()}function x3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N3(e,t){if(e){if(typeof e=="string")return Nb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nb(e,t)}}function Nb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D3(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function H3(e){if(Array.isArray(e))return e}function L3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Db(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j3(n.key),n)}}function F3(e,t,r){return t&&Db(e.prototype,t),r&&Db(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j3(e){var t=V3(e,"string");return ua(t)==="symbol"?t:String(t)}function V3(e,t){if(ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xy="editorManager.navigation",Ms="editorManager.handlingEditor",ld=function(){function e(t,r,n){var i=this;L3(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Dl(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return i.onCellDblClick(a,l,s)})}return F3(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),a={group:Ms};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),i.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),Ay(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),l=i,s=o;if(Array.isArray(a)){var u=M3(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var c=this.instance.rootDocument.activeElement;if(c&&XT(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(i,o,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),v=this.instance.colToProp(s),m=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=R3(h,this.instance),this.activeEditor.prepare(i,o,v,f,m,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,a=o.row,l=o.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(i))||s.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!s3(i)&&!u3(i)&&!o&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return oe(n.instance.getSelected())},group:xy};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),Hb=new WeakMap;ld.getInstance=function(e,t,r){var n=Hb.get(e);return n||(n=new ld(e,t,r),Hb.set(e,n)),n};const W3=ld;var B3=K,z3=It,sR=wl,U3=Q,Y3=U3(function(){sR(1)});B3({target:"Object",stat:!0,forced:Y3},{keys:function(t){return sR(z3(t))}});var G3=Ge,K3=Zv,X3=Ve,q3=Rr,Z3=vo,Uf=Je,Q3=cr,J3=ho,eK=Qv,Lb=ey;K3("match",function(e,t,r){return[function(i){var o=Q3(this),a=q3(i)?void 0:J3(i,e);return a?G3(a,i,o):new RegExp(i)[e](Uf(o))},function(n){var i=X3(this),o=Uf(n),a=r(t,i,o);if(a.done)return a.value;if(!i.global)return Lb(i,o);var l=i.unicode;i.lastIndex=0;for(var s=[],u=0,c;(c=Lb(i,o))!==null;){var f=Uf(c[0]);s[u]=f,f===""&&(i.lastIndex=eK(o,Z3(i.lastIndex),l)),u++}return u===0?null:s}]});var tK=Zn,rK=Ft,nK=Xn,iK=Zt,oK=po,aK=Math.min,sd=[].lastIndexOf,uR=!!sd&&1/[1].lastIndexOf(1,-0)<0,lK=oK("lastIndexOf"),sK=uR||!lK,uK=sK?function(t){if(uR)return tK(sd,this,arguments)||0;var r=rK(this),n=iK(r),i=n-1;for(arguments.length>1&&(i=aK(i,nK(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:sd,cK=K,Fb=uK;cK({target:"Array",proto:!0,forced:Fb!==[].lastIndexOf},{lastIndexOf:Fb});var fK=Yn,hK=It,dK=hl,vK=Zt,yK=TypeError,jb=function(e){return function(t,r,n,i){fK(r);var o=hK(t),a=dK(o),l=vK(o),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){i=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw yK("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(i=r(i,a[s],s,o));return i}},mK={left:jb(!1),right:jb(!0)},gK=K,pK=mK.left,bK=po,Vb=dl,wK=I_,SK=!wK&&Vb>79&&Vb<83,OK=SK||!bK("reduce");gK({target:"Array",proto:!0,forced:OK},{reduce:function(t){var r=arguments.length;return pK(this,t,r,r>1?arguments[1]:void 0)}});var CK=K,_K=qn.findIndex,TK=Rl,ud="findIndex",cR=!0;ud in[]&&Array(1)[ud](function(){cR=!1});CK({target:"Array",proto:!0,forced:cR},{findIndex:function(t){return _K(this,t,arguments.length>1?arguments[1]:void 0)}});TK(ud);var RK={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"};new RegExp(Object.keys(RK).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function Wb(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),o=i.length,a=o>0?i[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=t?1:0,h=0;h<o;h+=1){for(var v=t&&h===0,m=[],p=0;p<a;p+=1){var b=!v&&r&&p===0,C="";if(v)C="<th>".concat(e.getColHeader(p-c),"</th>");else if(b)C="<th>".concat(e.getRowHeader(h-f),"</th>");else{var T=i[h][p],I=e.getCellMeta(h-f,p-c),P=I.hidden,E=I.rowspan,q=I.colspan;if(!P){var Y=[];if(E&&Y.push('rowspan="'.concat(E,'"')),q&&Y.push('colspan="'.concat(q,'"')),ki(T))C="<td ".concat(Y.join(" "),"></td>");else{var ne=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C="<td ".concat(Y.join(" "),">").concat(ne,"</td>")}}}m.push(C)}var me=["<tr>"].concat(m,["</tr>"]).join("");v?s.splice(1,0,me):u.splice(-1,0,me)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function EK(e){return kK(e)||IK(e)||PK(e)||$K()}function $K(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PK(e,t){if(e){if(typeof e=="string")return cd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cd(e,t)}}function IK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kK(e){if(Array.isArray(e))return cd(e)}function cd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fd(e){return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function fR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=fd(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(EK(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function AK(e){return fR(e,[","])}function Yt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Bb(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function MK(e){return DK(e)||NK(e)||hR(e)||xK()}function xK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DK(e){if(Array.isArray(e))return hd(e)}function HK(e,t){return jK(e)||FK(e,t)||hR(e,t)||LK()}function LK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hR(e,t){if(e){if(typeof e=="string")return hd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hd(e,t)}}function hd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function jK(e){if(Array.isArray(e))return e}var dd="asc",VK="desc",zb=new Map([[dd,[-1,1]],[VK,[1,-1]]]),WK=function(t){return"The priority '".concat(t,"' is already declared in a map.")},BK=function(t){return"The priority '".concat(t,"' is not a number.")};function zK(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=ke(t)?t:WK,r=ke(r)?r:BK;function i(a,l){if(!fR(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dd,l=zb.get(a)||zb.get(dd),s=HK(l,2),u=s[0],c=s[1];return MK(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:i,getItems:o}}var UK=K,YK=qn.find,GK=Rl,vd="find",dR=!0;vd in[]&&Array(1)[vd](function(){dR=!1});UK({target:"Array",proto:!0,forced:dR},{find:function(t){return YK(this,t,arguments.length>1?arguments[1]:void 0)}});GK(vd);function KK(e){return ZK(e)||qK(e)||vR(e)||XK()}function XK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZK(e){if(Array.isArray(e))return yd(e)}function Ub(e,t){return e4(e)||JK(e,t)||vR(e,t)||QK()}function QK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vR(e,t){if(e){if(typeof e=="string")return yd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yd(e,t)}}function yd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function e4(e){if(Array.isArray(e))return e}var t4=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Oc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=ke(t)?t:t4;function n(c,f){if(u(c))throw new Error(t(c));r.set(c,f)}function i(c){return r.delete(c)}function o(){r.clear()}function a(c){var f=s().find(function(m){var p=Ub(m,2),b=p[0],C=p[1];return c===C?b:!1})||[null],h=Ub(f,1),v=h[0];return v}function l(c){return r.get(c)}function s(){return KK(r)}function u(c){return r.has(c)}return{addItem:n,clear:o,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:i}}function r4(e){return a4(e)||o4(e)||i4(e)||n4()}function n4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i4(e,t){if(e){if(typeof e=="string")return md(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return md(e,t)}}function o4(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a4(e){if(Array.isArray(e))return md(e)}function md(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l4=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function s4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=ke(t)?t:l4;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function i(){return r4(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function Yb(e){return h4(e)||f4(e)||c4(e)||u4()}function u4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c4(e,t){if(e){if(typeof e=="string")return gd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gd(e,t)}}function f4(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function h4(e){if(Array.isArray(e))return gd(e)}function gd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yR=function(t){return'There is already registered "'.concat(t,'" plugin.')},d4=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},v4=function(t){return'The priority "'.concat(t,'" is not a number.')},y4=zK({errorPriorityExists:d4,errorPriorityNaN:v4}),m4=s4({errorItemExists:yR}),g4=Oc({errorIdExists:yR});function p4(){return[].concat(Yb(y4.getItems()),Yb(m4.getItems()))}function b4(e){var t=Py(e);return g4.getItem(t)}var Ny=Jn("renderers"),w4=Ny.register,S4=Ny.getItem,O4=Ny.hasItem;function Gb(e){if(typeof e=="function")return e;if(!O4(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return S4(e)}function C4(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),w4(e,t)}var Dy=Jn("validators"),_4=Dy.register,T4=Dy.getItem,R4=Dy.hasItem;function E4(e){if(typeof e=="function")return e;if(!R4(e))throw Error('No registered validator found under "'.concat(e,'" name'));return T4(e)}function $4(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),_4(e,t)}var $n=1,ut=2;function ca(e){return ca=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ca(e)}function P4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k4(n.key),n)}}function I4(e,t,r){return t&&Kb(e.prototype,t),r&&Kb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k4(e){var t=A4(e,"string");return ca(t)==="symbol"?t:String(t)}function A4(e,t){if(ca(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ca(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var si=new WeakMap,M4=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=t.inlineStartOffset;P4(this,e),si.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:l,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return I4(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,a=0,l=0,s=si.get(this),u=s.calculationType,c=s.overrideFn,f=s.scrollOffset,h=Math.max(s.scrollOffset,0),v=s.totalColumns,m=s.viewportWidth,p=h>0?m+1:m,b=0;b<v;b++)if(o=this._getColumnWidth(b),r<=h&&u!==ut&&(this.startColumn=b,a=o),r>=h&&r+(u===ut?o:0)<=h+p&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,a=o),this.endColumn=b),i.push(r),r+=o,l=o,u!==ut&&(this.endColumn=b),r>=h+m){n=!1;break}var C=f+m-p,T=u===ut?0:l,I=u===ut?a:0;if(C<-1*s.inlineStartOffset||f>i.at(-1)+T||-1*s.scrollOffset-s.viewportWidth>-1*I?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===v-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var P=i[this.endColumn]+o-i[this.startColumn-1];if((P<=m||u!==ut)&&(this.startColumn-=1),P>m)break}u===$n&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),v<this.endColumn&&(this.endColumn=v-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=si.get(this),o=i.totalColumns,a=0,l=0;l<o;l++){var s=this._getColumnWidth(l),u=i.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(o-1),h=c+f;this.stretchLastWidth=h>=0?h:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=si.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=o.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=si.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=si.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const mR=M4;function fa(e){return fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fa(e)}function x4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D4(n.key),n)}}function N4(e,t,r){return t&&Xb(e.prototype,t),r&&Xb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D4(e){var t=H4(e,"string");return fa(t)==="symbol"?t:String(t)}function H4(e,t){if(fa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qb=new WeakMap,L4=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;x4(this,e),qb.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return N4(e,[{key:"calculate",value:function(){for(var r=qb.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,c=r.horizontalScrollbarHeight||0,f=0,h=!0,v=[],m,p=0,b=0,C=0;C<s;C++)if(m=o(C),isNaN(m)&&(m=e.DEFAULT_HEIGHT),f<=l&&n!==ut&&(this.startRow=C,p=m),f>=l&&f+(n===ut?m:0)<=l+u-c&&(this.startRow===null&&(this.startRow=C,p=m),this.endRow=C),v.push(f),f+=m,b=m,n!==ut&&(this.endRow=C),f>=l+u-c){h=!1;break}var T=a+u-c,I=n===ut?p:0,P=n===ut?0:b;if(T<I||a>v.at(-1)+P?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var E=v[this.endRow]+m-v[this.startRow-1];if((E<=u-c||n!==ut)&&(this.startRow-=1),E>=u-c)break}n===$n&&this.startRow!==null&&i&&i(this),this.startPosition=v[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const F4=L4;function ha(e){return ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ha(e)}function j4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gR(n.key),n)}}function V4(e,t,r){return t&&Zb(e.prototype,t),r&&Zb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W4(e,t,r){B4(e,t),t.set(e,r)}function B4(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qb(e,t,r){return t=gR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gR(e){var t=z4(e,"string");return ha(t)==="symbol"?t:String(t)}function z4(e,t){if(ha(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ha(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Do(e,t){var r=pR(e,t,"get");return U4(e,r)}function U4(e,t){return t.get?t.get.call(e):t.value}function Y4(e,t,r){var n=pR(e,t,"set");return G4(e,n,r),r}function pR(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function G4(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Tn=new WeakMap,K4=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;j4(this,e),Qb(this,"row",null),Qb(this,"col",null),W4(this,Tn,{writable:!0,value:!1}),Y4(this,Tn,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return V4(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Do(this,Tn)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Do(this,Tn)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Do(this,Tn)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Do(this,Tn)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Do(this,Tn))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const lu=K4;function da(e){return da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},da(e)}function X4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bR(n.key),n)}}function q4(e,t,r){return t&&Jb(e.prototype,t),r&&Jb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z4(e,t,r){Q4(e,t),t.set(e,r)}function Q4(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yf(e,t,r){return t=bR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bR(e){var t=J4(e,"string");return da(t)==="symbol"?t:String(t)}function J4(e,t){if(da(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(da(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function br(e,t){var r=wR(e,t,"get");return e6(e,r)}function e6(e,t){return t.get?t.get.call(e):t.value}function t6(e,t,r){var n=wR(e,t,"set");return r6(e,n,r),r}function wR(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function r6(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Bt=new WeakMap,n6=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;X4(this,e),Yf(this,"highlight",null),Yf(this,"from",null),Yf(this,"to",null),Z4(this,Bt,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),t6(this,Bt,i)}return q4(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(i.row,l.row),f=Math.max(i.col,l.col),h=this._createCellCoords(s,u),v=this._createCellCoords(c,f);return this.from=h,this.to=v,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return br(this,Bt)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return br(this,Bt)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return br(this,Bt)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return br(this,Bt)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return br(this,Bt)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return br(this,Bt)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return br(this,Bt)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return br(this,Bt)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof lu))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)r.row===o&&r.col===a?i.push(r):n.row===o&&n.col===a?i.push(n):i.push(this._createCellCoords(o,a));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var l=r(o,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,br(this,Bt))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new lu(r,n,br(this,Bt))}}]),e}();const Hy=n6;var i6=K,o6=Av;i6({target:"Object",stat:!0},{setPrototypeOf:o6});var SR=ee,a6=Yn,l6=je,s6=Ae,ew=_l,u6=ul,OR=Function,c6=SR([].concat),f6=SR([].join),Gf={},h6=function(e,t,r){if(!s6(Gf,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";Gf[t]=OR("C,a","return new C("+f6(n,",")+")")}return Gf[t](e,r)},d6=u6?OR.bind:function(t){var r=a6(this),n=r.prototype,i=ew(arguments,1),o=function(){var l=c6(i,ew(arguments));return this instanceof o?h6(r,l.length,l):r.apply(t,l)};return l6(n)&&(o.prototype=n),o},v6=K,y6=Yr,Kf=Zn,m6=d6,tw=z_,g6=Ve,rw=je,p6=yo,CR=Q,Ly=y6("Reflect","construct"),b6=Object.prototype,w6=[].push,_R=CR(function(){function e(){}return!(Ly(function(){},[],e)instanceof e)}),TR=!CR(function(){Ly(function(){})}),nw=_R||TR;v6({target:"Reflect",stat:!0,forced:nw,sham:nw},{construct:function(t,r){tw(t),g6(r);var n=arguments.length<3?t:tw(arguments[2]);if(TR&&!_R)return Ly(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return Kf(w6,i,r),new(Kf(m6,t,i))}var o=n.prototype,a=p6(rw(o)?o:b6),l=Kf(t,a,r);return rw(l)?l:a}});function va(e){return va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(e)}function S6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C6(n.key),n)}}function O6(e,t,r){return t&&iw(e.prototype,t),r&&iw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C6(e){var t=_6(e,"string");return va(t)==="symbol"?t:String(t)}function _6(e,t){if(va(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(va(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ui=new WeakMap,T6=function(){function e(t,r,n,i,o,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;S6(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=a,this.parent=l,this.eventManager=i,this.facadeGetter=t,ui.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return O6(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};Pn()?n():(TW()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=ui.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[o.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return l===s&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=ns(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Ne(r,"wtBorder")&&Ne(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Ne(r,"wtBorder")&&Ne(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=ui.get(this),i=this.domBindings.rootDocument.activeElement,o=HG(EG,r.target),a=r.target;if(!(a===i||o(0)===i||o(1)===i)){var l=this.parentCell(a);Ne(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=ns(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&qh(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=ns(r.target,["TD","TH"],n),o=ns(r.relatedTarget,["TD","TH"],n);i&&i!==o&&qh(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=ui.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Ne(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=ui.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=oe(o)&&o.row>=0&&o.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];K_()&&(yB()||mB())&&this.selectedCellWasTouched(i)&&!s.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var a=this.wtSettings.getSettingPure(r);a&&a(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=ui.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const RR=T6;function ya(e){return ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ya(e)}function R6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ow(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$6(n.key),n)}}function E6(e,t,r){return t&&ow(e.prototype,t),r&&ow(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $6(e){var t=P6(e,"string");return ya(t)==="symbol"?t:String(t)}function P6(e,t){if(ya(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ya(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I6=function(){function e(t,r,n){R6(this,e),this.offset=t,this.total=r,this.countTH=n}return E6(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const k6=I6;function ma(e){return ma=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ma(e)}function A6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x6(n.key),n)}}function M6(e,t,r){return t&&aw(e.prototype,t),r&&aw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x6(e){var t=N6(e,"string");return ma(t)==="symbol"?t:String(t)}function N6(e,t){if(ma(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ma(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D6=function(){function e(t,r,n){A6(this,e),this.offset=t,this.total=r,this.countTH=n}return M6(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const H6=D6;var L6=0,su=1,uu=2;function ga(e){return ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ga(e)}function F6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V6(n.key),n)}}function j6(e,t,r){return t&&lw(e.prototype,t),r&&lw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V6(e){var t=W6(e,"string");return ga(t)==="symbol"?t:String(t)}function W6(e,t){if(ga(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ga(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sw=function(){function e(){F6(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return j6(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function pa(e){return pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pa(e)}function B6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U6(n.key),n)}}function z6(e,t,r){return t&&uw(e.prototype,t),r&&uw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U6(e){var t=Y6(e,"string");return pa(t)==="symbol"?t:String(t)}function Y6(e,t){if(pa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G6=function(){function e(){B6(this,e),this.size=new sw,this.workingSpace=L6,this.sharedSize=null}return z6(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof sw}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=su,r.workingSpace=uu,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=uu,r.workingSpace=su,this.sharedSize=r.getViewSize()}}]),e}();function ba(e){return ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ba(e)}function K6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q6(n.key),n)}}function X6(e,t,r){return t&&cw(e.prototype,t),r&&cw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q6(e){var t=Z6(e,"string");return ba(t)==="symbol"?t:String(t)}function Z6(e,t){if(ba(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ba(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ER=function(){function e(t,r,n){K6(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new G6,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return X6(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(su))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!i||i&&n.isPlaceOn(uu)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=i&&n.isPlaceOn(su);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(uu)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Mi(e){return Mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi(e)}function Q6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e8(n.key),n)}}function J6(e,t,r){return t&&fw(e.prototype,t),r&&fw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e8(e){var t=t8(e,"string");return Mi(t)==="symbol"?t:String(t)}function t8(e,t){if(Mi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pd(e,t)}function pd(e,t){return pd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pd(e,t)}function n8(e){var t=a8();return function(){var n=cu(e),i;if(t){var o=cu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return i8(this,i)}}function i8(e,t){if(t&&(Mi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o8(e)}function o8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cu(e){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cu(e)}var $R=function(e){r8(r,e);var t=n8(r);function r(){return Q6(this,r),t.apply(this,arguments)}return J6(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(ER);function wa(e){return wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wa(e)}function l8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u8(n.key),n)}}function s8(e,t,r){return t&&hw(e.prototype,t),r&&hw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u8(e){var t=c8(e,"string");return wa(t)==="symbol"?t:String(t)}function c8(e,t){if(wa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f8=function(){function e(t){l8(this,e),this.nodeType=t.toUpperCase()}return s8(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Sa(e){return Sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sa(e)}function h8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v8(n.key),n)}}function d8(e,t,r){return t&&dw(e.prototype,t),r&&dw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v8(e){var t=y8(e,"string");return Sa(t)==="symbol"?t:String(t)}function y8(e,t){if(Sa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hl=function(){function e(t,r){h8(this,e),this.nodesPool=typeof t=="string"?new f8(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return d8(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function xi(e){return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(e)}function m8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p8(n.key),n)}}function g8(e,t,r){return t&&vw(e.prototype,t),r&&vw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p8(e){var t=b8(e,"string");return xi(t)==="symbol"?t:String(t)}function b8(e,t){if(xi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bd(e,t)}function bd(e,t){return bd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bd(e,t)}function S8(e){var t=_8();return function(){var n=fu(e),i;if(t){var o=fu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return O8(this,i)}}function O8(e,t){if(t&&(xi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C8(e)}function C8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fu(e){return fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fu(e)}var T8=function(e){w8(r,e);var t=S8(r);function r(){var n;return m8(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return g8(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new $R(i,function(l){return o.nodesPool.obtain(o.sourceRowIndex,l)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,l=i.rowHeadersCount,s=i.rows,u=i.cells,c=0;c<o;c++){var f=this.table.renderedRowToSource(c),h=s.getRenderedNode(c);this.sourceRowIndex=f;var v=this.obtainOrderView(h),m=u.obtainOrderView(h);v.appendView(m).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<l;p++){v.render();var b=v.getCurrentNode();b.className="",b.removeAttribute("style"),a[p](f,b,p)}v.end()}}}]),r}(Hl);function Ni(e){return Ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ni(e)}function R8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$8(n.key),n)}}function E8(e,t,r){return t&&yw(e.prototype,t),r&&yw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $8(e){var t=P8(e,"string");return Ni(t)==="symbol"?t:String(t)}function P8(e,t){if(Ni(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ni(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wd(e,t)}function wd(e,t){return wd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wd(e,t)}function k8(e){var t=x8();return function(){var n=hu(e),i;if(t){var o=hu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A8(this,i)}}function A8(e,t){if(t&&(Ni(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M8(e)}function M8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hu(e){return hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hu(e)}var N8=function(e){I8(r,e);var t=k8(r);function r(n){return R8(this,r),t.call(this,null,n)}return E8(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,l=this.rootNode.firstChild;if(o){for(var s=this.table.columnsToRender,u=s+a,c=0,f=o;c<f;c++){for(l=this.rootNode.childNodes[c],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>o)for(var v=o;v<h;v++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Ai(l)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[o],f=-1*u;f<s;f+=1){var h=this.table.renderedColumnToSource(f),v=c.childNodes[f+u];v.className="",v.removeAttribute("style"),l[o](h,v,o)}}}]),r}(Hl);function Di(e){return Di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Di(e)}function D8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L8(n.key),n)}}function H8(e,t,r){return t&&mw(e.prototype,t),r&&mw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L8(e){var t=F8(e,"string");return Di(t)==="symbol"?t:String(t)}function F8(e,t){if(Di(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Di(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sd(e,t)}function Sd(e,t){return Sd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Sd(e,t)}function V8(e){var t=z8();return function(){var n=du(e),i;if(t){var o=du(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W8(this,i)}}function W8(e,t){if(t&&(Di(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B8(e)}function B8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},du(e)}var U8=function(e){j8(r,e);var t=V8(r);function r(n){return D8(this,r),t.call(this,null,n)}return H8(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,l=o+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var c=0;c<o;c++){var f=this.table.renderedColumnToSource(c),h=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(h,"px")}var v=this.rootNode.firstChild;v&&he(v,"rowHeader")}}]),r}(Hl);function Hi(e){return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(e)}var gw;function Y8(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function G8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X8(n.key),n)}}function K8(e,t,r){return t&&pw(e.prototype,t),r&&pw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X8(e){var t=q8(e,"string");return Hi(t)==="symbol"?t:String(t)}function q8(e,t){if(Hi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Od(e,t)}function Od(e,t){return Od=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Od(e,t)}function Q8(e){var t=t5();return function(){var n=vu(e),i;if(t){var o=vu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J8(this,i)}}function J8(e,t){if(t&&(Hi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e5(e)}function e5(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}var bw=!1,r5=function(e){Z8(r,e);var t=Q8(r);function r(n){var i;return G8(this,r),i=t.call(this,"TR",n),i.orderView=new ER(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return K8(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!bw&&i>1e3&&(bw=!0,Ln(Pt(gw||(gw=Y8([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(Hl);function Li(e){return Li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Li(e)}function n5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ww(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o5(n.key),n)}}function i5(e,t,r){return t&&ww(e.prototype,t),r&&ww(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o5(e){var t=a5(e,"string");return Li(t)==="symbol"?t:String(t)}function a5(e,t){if(Li(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Li(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l5(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cd(e,t)}function Cd(e,t){return Cd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Cd(e,t)}function s5(e){var t=f5();return function(){var n=yu(e),i;if(t){var o=yu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u5(this,i)}}function u5(e,t){if(t&&(Li(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c5(e)}function c5(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yu(e){return yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yu(e)}var h5=function(e){l5(r,e);var t=s5(r);function r(){var n;return n5(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return i5(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new $R(i,function(l){return o.nodesPool.obtain(o.sourceRowIndex,l)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,l=i.rows,s=i.rowHeaders,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=l.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),v=s.obtainOrderView(f);h.prependView(v).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<a;m++){h.render();var p=h.getCurrentNode(),b=this.table.renderedColumnToSource(m);Ne(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),this.table.cellRenderer(c,b,p)}h.end()}}}]),r}(Hl);function Oa(e){return Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oa(e)}function d5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y5(n.key),n)}}function v5(e,t,r){return t&&Sw(e.prototype,t),r&&Sw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y5(e){var t=m5(e,"string");return Oa(t)==="symbol"?t:String(t)}function m5(e,t){if(Oa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g5=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;d5(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return v5(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),l=this.rowUtils.getHeight(a);l?o.firstChild.style.height="".concat(l-1,"px"):o.firstChild.style.height=""}}}}]),e}();function Ca(e){return Ca=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ca(e)}function p5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ow(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w5(n.key),n)}}function b5(e,t,r){return t&&Ow(e.prototype,t),r&&Ow(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w5(e){var t=S5(e,"string");return Ca(t)==="symbol"?t:String(t)}function S5(e,t){if(Ca(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ca(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O5=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,o=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;p5(this,e),this.renderer=new g5(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new T8,columnHeaders:new N8(n),colGroup:new U8(i),rows:new r5(o),cells:new h5}),this.renderer.setAxisUtils(a,l)}return b5(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function _a(e){return _a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_a(e)}function C5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T5(n.key),n)}}function _5(e,t,r){return t&&Cw(e.prototype,t),r&&Cw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T5(e){var t=R5(e,"string");return _a(t)==="symbol"?t:String(t)}function R5(e,t){if(_a(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E5=function(){function e(t,r){C5(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return _5(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:i.holder,s=l.offsetHeight<l.scrollHeight?wt():0,u=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),h=0;h<c;h++){var v=Array.isArray(u)?u[h]:u;v=v??f,this.headerWidths.set(h,v)}}}]),e}();function Ta(e){return Ta=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ta(e)}function $5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I5(n.key),n)}}function P5(e,t,r){return t&&_w(e.prototype,t),r&&_w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I5(e){var t=k5(e,"string");return Ta(t)==="symbol"?t:String(t)}function k5(e,t){if(Ta(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ta(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A5=function(){function e(t,r){$5(this,e),this.dataAccessObject=t,this.wtSettings=r}return P5(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function Ra(e){return Ra=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ra(e)}function M5(e){return D5(e)||N5(e)||PR(e)||x5()}function x5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N5(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D5(e){if(Array.isArray(e))return _d(e)}function H5(e,t){return j5(e)||F5(e,t)||PR(e,t)||L5()}function L5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PR(e,t){if(e){if(typeof e=="string")return _d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _d(e,t)}}function _d(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F5(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function j5(e){if(Array.isArray(e))return e}function V5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IR(n.key),n)}}function W5(e,t,r){return t&&Tw(e.prototype,t),r&&Tw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wr(e,t,r){return t=IR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IR(e){var t=B5(e,"string");return Ra(t)==="symbol"?t:String(t)}function B5(e,t){if(Ra(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ra(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z5=function(){function e(t,r,n,i,o){var a=this;V5(this,e),wr(this,"wtSettings",null),wr(this,"domBindings",void 0),wr(this,"TBODY",null),wr(this,"THEAD",null),wr(this,"COLGROUP",null),wr(this,"hasTableHeight",!0),wr(this,"hasTableWidth",!0),wr(this,"isTableVisible",!1),wr(this,"tableOffset",0),wr(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,YT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new A5(this.dataAccessObject,this.wtSettings),this.columnUtils=new E5(this.dataAccessObject,this.wtSettings),this.tableRenderer=new O5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return W5(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,a=i.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),h=f.length,v=!1,m=r;if(this.isMaster&&(this.holderOffset=$t(this.holder),m=a.createRenderCalculators(m),c&&!n.getSetting("fixedColumnsStart"))){var p=o.inlineStartOverlay.getScrollPosition(),b=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,b!==this.correctHeaderWidth&&(m=!1)}if(this.isMaster&&(v=o.updateStateOfRendering()),m)this.isMaster&&a.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=$t(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var C=l>0?this.getFirstRenderedRow():0,T=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new H6(C,l,h),this.columnFilter=new k6(T,s,c);var I=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var P={};this.wtSettings.getSetting("beforeDraw",!0,P),I=P.skipRender!==!0}if(I){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(Cr)||this.is(hn))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var E;if(this.isMaster&&(E=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Cr))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var q=Qe(this.hider),Y=Qe(this.TABLE);q!==0&&Y!==q&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),E!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Cr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var ne=!1;return this.isMaster&&(ne=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(ne=o.bottomOverlay.resetFixedPosition()||ne),ne=o.inlineStartOverlay.resetFixedPosition()||ne,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),ne?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(m),v&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.getColumnHeaderHeight(i),l=this.getColumnHeader(n,i),l&&(s=sn(l),(!a&&o<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=s),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),a=0,l=o.length;a<l;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Cr))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var a=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)Ue(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var o=Array.from(i),a=o.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=o[s].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,h=u.highlightColumnClassName,v=o[s].classNames,m=v.length,p=0;p<m;p++)l.includes(v[p])||l.push(v[p]);c&&!l.includes(c)&&l.push(c),f&&!l.includes(f)&&l.push(f),h&&!l.includes(h)&&l.push(h)}var b=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(b))for(var C=0;C<b.length;C++)l.push(b[C]);for(var T=l.length,I=0;I<T;I++)this.removeClassFromCells(l[I])}for(var P=0;P<a;P++)o[P].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=H5(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[o];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=UT(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=PG(i),l=n.cellIndex;if(_n(Vn,n,this.wtRootElement)||_n(Fn,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(_n(hn,n,this.wtRootElement)||_n(Cr,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return _n(Vn,n,this.wtRootElement)||_n(jn,n,this.wtRootElement)||_n(hn,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=sn(this.TBODY)-1,o,a,l,s,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),o=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=sn(u):a=sn(s)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<a||o<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Qe(this.TABLE)}},{key:"getHeight",value:function(){return Kt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=Qe(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Kt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return nu(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=ke(r)?r():null;return Array.isArray(n)?(n=M5(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const So=z5;var U5="stickyRowsBottom",kR={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};mn(kR,"MIXIN_NAME",U5,{writable:!1,enumerable:!1});const AR=kR;var Y5="stickyColumnsStart",MR={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};mn(MR,"MIXIN_NAME",Y5,{writable:!1,enumerable:!1});const Fy=MR;function Fi(e){return Fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(e)}function Rw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K5(n.key),n)}}function G5(e,t,r){return t&&Rw(e.prototype,t),r&&Rw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K5(e){var t=X5(e,"string");return Fi(t)==="symbol"?t:String(t)}function X5(e,t){if(Fi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z5(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Td(e,t)}function Td(e,t){return Td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Td(e,t)}function Q5(e){var t=tX();return function(){var n=mu(e),i;if(t){var o=mu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J5(this,i)}}function J5(e,t){if(t&&(Fi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eX(e)}function eX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}var jy=function(e){Z5(r,e);var t=Q5(r);function r(n,i,o,a){return q5(this,r),t.call(this,n,i,o,a,hn)}return G5(r)}(So);Be(jy,AR);Be(jy,Fy);const rX=jy;var Fn="top",Cr="bottom",jn="inline_start",Vn="top_inline_start_corner",hn="bottom_inline_start_corner",nX=[Fn,Cr,jn,Vn,hn],iX=new Map([[Fn,"ht_clone_".concat(Fn)],[Cr,"ht_clone_".concat(Cr)],[jn,"ht_clone_".concat(jn," ht_clone_left")],[Vn,"ht_clone_".concat(Vn," ht_clone_top_left_corner")],[hn,"ht_clone_".concat(hn," ht_clone_bottom_left_corner")]]);function Ea(e){return Ea=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ea(e)}function oX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ew(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xR(n.key),n)}}function aX(e,t,r){return t&&Ew(e.prototype,t),r&&Ew(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xf(e,t,r){return t=xR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xR(e){var t=lX(e,"string");return Ea(t)==="symbol"?t:String(t)}function lX(e,t){if(Ea(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ea(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sX=function(){function e(t){oX(this,e),Xf(this,"dataAccessObject",void 0),Xf(this,"lastScrolledColumnPos",-1),Xf(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return aX(e,[{key:"scrollViewport",value:function(r,n,i,o,a){var l=this.scrollViewportHorizontally(r.col,i,a),s=this.scrollViewportVertically(r.row,n,o);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,l=o.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedColumnsStart,v=f.inlineStartOverlay;if(c&&r<h)return!1;var m=!1;return s===-1?m=v.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<s||r>u)||!c)&&(m=v.scrollTo(r,c?r>u:n)),m&&(this.lastScrolledColumnPos=r),m}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,l=o.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedRowsBottom,v=f.fixedRowsTop,m=f.topOverlay;if(c&&(r<v||r>l-h-1))return!1;var p=!1;return s===-1?p=m.scrollTo(r,c?r>this.lastScrolledRowPos:i):(c&&(r<s||r>u)||!c)&&(p=m.scrollTo(r,c?r>u:i)),p&&(this.lastScrolledRowPos=r),p}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var c=$t(i.wtRootElement),f=sn(i.hider),h=sn(s),v=iu(s,s);if(c.top+f-h<=v){var m=o.getColumnHeaderHeight();m+=n.sumCellSizes(0,l);for(var p=a;p>0;p--)if(m+=n.sumCellSizes(p-1,p),c.top+f-m<=v){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=i.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=$t(i.wtRootElement),c=iu(l,l);if(u.top>c){for(var f=sn(l),h=o.getColumnHeaderHeight(),v=1;v<=a;v++)if(h+=n.sumCellSizes(v-1,v),u.top+h-c>=f){s=v-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=$t(i.wtRootElement),c=Is(i.hider),f=Is(l),h=Math.abs(ed(l,l));if(u.left+c-f<=h){for(var v=o.getRowHeaderWidth(),m=a;m>0;m--)if(v+=n.sumCellSizes(m-1,m),u.left+c-v<=h){s=m;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=o.getLastVisibleColumn();if(i.mainTableScrollableElement===s){var c=n.getSetting("rtlMode"),f=null;if(c){var h=o.TABLE.getBoundingClientRect(),v=this.dataAccessObject.rootWindow.document,m=v.documentElement.offsetWidth;f=Math.abs(h.right-m)}else{var p=$t(o.wtRootElement);f=p.left}var b=Math.abs(ed(s,s));if(f>b){for(var C=Is(s),T=a.getRowHeaderWidth(),I=1;I<=l;I++)if(T+=i.sumCellSizes(I-1,I),f+T-b>=C){u=I-2;break}}}return u}}]),e}();const uX=sX;function $a(e){return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$a(e)}function cX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NR(n.key),n)}}function fX(e,t,r){return t&&$w(e.prototype,t),r&&$w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rr(e,t,r){return t=NR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NR(e){var t=hX(e,"string");return $a(t)==="symbol"?t:String(t)}function hX(e,t){if($a(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vy=function(){function e(t,r){cX(this,e),rr(this,"wtTable",void 0),rr(this,"wtScroll",void 0),rr(this,"wtViewport",void 0),rr(this,"wtOverlays",void 0),rr(this,"selections",void 0),rr(this,"wtEvent",void 0),rr(this,"guid","wt_".concat(zT())),rr(this,"drawInterrupted",!1),rr(this,"drawn",!1),rr(this,"domBindings",void 0),rr(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new uX(this.createScrollDao())}return fX(e,[{key:"eventManager",get:function(){return new Dl(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,a){xl(a,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new lu(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new Hy(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=i-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function ji(e){return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ji(e)}function Pw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DR(n.key),n)}}function dX(e,t,r){return t&&Pw(e.prototype,t),r&&Pw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rd(e,t)}function Rd(e,t){return Rd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rd(e,t)}function mX(e){var t=pX();return function(){var n=gu(e),i;if(t){var o=gu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gX(this,i)}}function gX(e,t){if(t&&(ji(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xs(e)}function xs(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gu(e){return gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gu(e)}function Iw(e,t,r){return t=DR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DR(e){var t=bX(e,"string");return ji(t)==="symbol"?t:String(t)}function bX(e,t){if(ji(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ji(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wX=function(e){yX(r,e);var t=mX(r);function r(n,i,o){var a;vX(this,r),a=t.call(this,n,i),Iw(xs(a),"cloneSource",void 0),Iw(xs(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",xs(a));return a.cloneSource=o.source,a.cloneOverlay=o.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=o.viewport,a.selections=o.selections,a.wtEvent=new RR(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,o.event),a.findOriginalHeaders(),a}return dX(r)}(Vy);function Pa(e){return Pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pa(e)}function SX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HR(n.key),n)}}function OX(e,t,r){return t&&kw(e.prototype,t),r&&kw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CX(e,t,r){return t=HR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HR(e){var t=_X(e,"string");return Pa(t)==="symbol"?t:String(t)}function _X(e,t){if(Pa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ll=function(){function e(t,r,n,i,o){SX(this,e),CX(this,"wtSettings",null),mn(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=au(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return OX(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=au(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ou(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Ln("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,a=i<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return o?h=this.getRelativeCellPositionWithinWindow(l,a,f,c):h=this.getRelativeCellPositionWithinHolder(l,s,a,f,c),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=o.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+wt())),l=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();s=c.top-a.top}else s=o.top;return{start:i.start+l,top:i.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(i||(s=l.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=l.vertical-a.top);return{start:o.start-s,top:o.top-u}}},{key:"makeClone",value:function(){if(nX.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=i.createElement("DIV"),l=i.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(iX.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Fn||u==="vertical"&&this.type===jn?this.mainTableScrollableElement=o:o.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=ou(r.TABLE),new wX(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,a=r.parentNode.style;ve([i,o,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Vi(e){return Vi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vi(e)}function Ns(e,t,r){return LR()?Ns=Reflect.construct.bind():Ns=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&pu(u,a.prototype),u},Ns.apply(null,arguments)}function TX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EX(n.key),n)}}function RX(e,t,r){return t&&Aw(e.prototype,t),r&&Aw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EX(e){var t=$X(e,"string");return Vi(t)==="symbol"?t:String(t)}function $X(e,t){if(Vi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pu(e,t)}function pu(e,t){return pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pu(e,t)}function IX(e){var t=LR();return function(){var n=bu(e),i;if(t){var o=bu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kX(this,i)}}function kX(e,t){if(t&&(Vi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AX(e)}function AX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var MX=function(e){PX(r,e);var t=IX(r);function r(n,i,o,a,l,s){var u;return TX(this,r),u=t.call(this,n,i,hn,o,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return RX(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Ns(rX,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(a,"px"),o.style.bottom="".concat(l,"px")}else Sc(o),this.repositionOverlay();var s=Kt(this.clone.wtTable.TABLE),u=Qe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),o.style.height="".concat(s,"px"),o.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=wt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Ll),xX="calculatedColumns",FR={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};mn(FR,"MIXIN_NAME",xX,{writable:!1,enumerable:!1});const Wy=FR;function Wi(e){return Wi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wi(e)}function Mw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DX(n.key),n)}}function NX(e,t,r){return t&&Mw(e.prototype,t),r&&Mw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DX(e){var t=HX(e,"string");return Wi(t)==="symbol"?t:String(t)}function HX(e,t){if(Wi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ed(e,t)}function Ed(e,t){return Ed=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ed(e,t)}function jX(e){var t=BX();return function(){var n=wu(e),i;if(t){var o=wu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VX(this,i)}}function VX(e,t){if(t&&(Wi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WX(e)}function WX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}var By=function(e){FX(r,e);var t=jX(r);function r(n,i,o,a){return LX(this,r),t.call(this,n,i,o,a,Cr)}return NX(r)}(So);Be(By,AR);Be(By,Wy);const zX=By;function Bi(e){return Bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bi(e)}function Ds(e,t,r){return VR()?Ds=Reflect.construct.bind():Ds=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&Su(u,a.prototype),u},Ds.apply(null,arguments)}function UX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WR(n.key),n)}}function YX(e,t,r){return t&&xw(e.prototype,t),r&&xw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Su(e,t)}function Su(e,t){return Su=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Su(e,t)}function KX(e){var t=VR();return function(){var n=Ou(e),i;if(t){var o=Ou(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return XX(this,i)}}function XX(e,t){if(t&&(Bi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jR(e)}function jR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ou(e){return Ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ou(e)}function qX(e,t,r){return t=WR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WR(e){var t=ZX(e,"string");return Bi(t)==="symbol"?t:String(t)}function ZX(e,t){if(Bi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QX=function(e){GX(r,e);var t=KX(r);function r(n,i,o,a){var l;return UX(this,r),l=t.call(this,n,i,Cr,o,a),qX(jR(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return YX(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Ds(zX,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),o.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=wt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(Iy(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),c=i,f=0;c<o;){var h=l.getRowHeight(c);f+=h===void 0?u:h,c+=1}return f}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,c=wt(s),f=this.clone.wtTable.holder.parentNode,h=f.style,v=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||v==="horizontal"){var m=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(m-=c),m=Math.min(m,o.wtRootElement.scrollWidth),h.width="".concat(m,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var p=Kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(p=0),h.height="".concat(p,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;o&&s.offsetHeight!==s.clientHeight&&(u=wt(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return iu(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||o===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,c=Ne(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(he(u,"innerBorderBottom"),s=!c):(Ue(u,"innerBorderBottom"),s=c)}return s}}]),r}(Ll),JX="calculatedRows",BR={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};mn(BR,"MIXIN_NAME",JX,{writable:!1,enumerable:!1});const zR=BR;function zi(e){return zi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(e)}function Nw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t7(n.key),n)}}function e7(e,t,r){return t&&Nw(e.prototype,t),r&&Nw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t7(e){var t=r7(e,"string");return zi(t)==="symbol"?t:String(t)}function r7(e,t){if(zi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function n7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$d(e,t)}function $d(e,t){return $d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$d(e,t)}function o7(e){var t=s7();return function(){var n=Cu(e),i;if(t){var o=Cu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a7(this,i)}}function a7(e,t){if(t&&(zi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l7(e)}function l7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}var zy=function(e){i7(r,e);var t=o7(r);function r(n,i,o,a){return n7(this,r),t.call(this,n,i,o,a,jn)}return e7(r)}(So);Be(zy,zR);Be(zy,Fy);const u7=zy;function Ui(e){return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ui(e)}function Hs(e,t,r){return UR()?Hs=Reflect.construct.bind():Hs=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&_u(u,a.prototype),u},Hs.apply(null,arguments)}function c7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h7(n.key),n)}}function f7(e,t,r){return t&&Dw(e.prototype,t),r&&Dw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h7(e){var t=d7(e,"string");return Ui(t)==="symbol"?t:String(t)}function d7(e,t){if(Ui(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ui(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_u(e,t)}function _u(e,t){return _u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_u(e,t)}function y7(e){var t=UR();return function(){var n=Tu(e),i;if(t){var o=Tu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m7(this,i)}}function m7(e,t){if(t&&(Ui(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g7(e)}function g7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(e){return Tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tu(e)}var p7=function(e){v7(r,e);var t=y7(r);function r(n,i,o,a){return c7(this,r),t.call(this,n,i,jn,o,a)}return f7(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Hs(u7,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===o&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),ky(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Sc(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,GT(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=i,s=0;l<o;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,l=o.rootWindow,s=wt(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||f==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,i.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var v=Qe(this.clone.wtTable.TABLE);c.width="".concat(v,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((i=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(o){var c=this.wot.wtTable.getColumnWidth(i),f=this.wot.wtViewport.getViewportWidth();c>f&&(o=!1)}return o&&s.offsetWidth!==s.clientWidth&&(u=wt(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(ed(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Ue(o,"emptyRows"):he(o,"emptyRows");var u=!1;if(l&&!a.length)he(o,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var c=Ne(o,"innerBorderInlineStart");i?(he(o,"innerBorderLeft innerBorderInlineStart"),u=!c):(Ue(o,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(Ll),b7="stickyRowsTop",YR={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};mn(YR,"MIXIN_NAME",b7,{writable:!1,enumerable:!1});const GR=YR;function Yi(e){return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi(e)}function Hw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S7(n.key),n)}}function w7(e,t,r){return t&&Hw(e.prototype,t),r&&Hw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S7(e){var t=O7(e,"string");return Yi(t)==="symbol"?t:String(t)}function O7(e,t){if(Yi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pd(e,t)}function Pd(e,t){return Pd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Pd(e,t)}function T7(e){var t=$7();return function(){var n=Ru(e),i;if(t){var o=Ru(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return R7(this,i)}}function R7(e,t){if(t&&(Yi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E7(e)}function E7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ru(e){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ru(e)}var Uy=function(e){_7(r,e);var t=T7(r);function r(n,i,o,a){return C7(this,r),t.call(this,n,i,o,a,Vn)}return w7(r)}(So);Be(Uy,GR);Be(Uy,Fy);const P7=Uy;function Gi(e){return Gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gi(e)}function Ls(e,t,r){return KR()?Ls=Reflect.construct.bind():Ls=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&Eu(u,a.prototype),u},Ls.apply(null,arguments)}function I7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XR(n.key),n)}}function k7(e,t,r){return t&&Lw(e.prototype,t),r&&Lw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Eu(e,t)}function Eu(e,t){return Eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Eu(e,t)}function M7(e){var t=KR();return function(){var n=$u(e),i;if(t){var o=$u(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return x7(this,i)}}function x7(e,t){if(t&&(Gi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Id(e)}function Id(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $u(e){return $u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$u(e)}function Fw(e,t,r){return t=XR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XR(e){var t=N7(e,"string");return Gi(t)==="symbol"?t:String(t)}function N7(e,t){if(Gi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D7=function(e){A7(r,e);var t=M7(r);function r(n,i,o,a,l,s){var u;return I7(this,r),u=t.call(this,n,i,Vn,o,a),Fw(Id(u),"topOverlay",void 0),Fw(Id(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return k7(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Ls(P7,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();ky(i,"".concat(o,"px"),"".concat(a,"px"))}else Sc(i);var l=Kt(this.clone.wtTable.TABLE),s=Qe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),i.style.height="".concat(l,"px"),i.style.width="".concat(s,"px"),!1}}]),r}(Ll);function Ki(e){return Ki=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ki(e)}function jw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L7(n.key),n)}}function H7(e,t,r){return t&&jw(e.prototype,t),r&&jw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L7(e){var t=F7(e,"string");return Ki(t)==="symbol"?t:String(t)}function F7(e,t){if(Ki(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ki(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kd(e,t)}function kd(e,t){return kd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kd(e,t)}function W7(e){var t=U7();return function(){var n=Pu(e),i;if(t){var o=Pu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return B7(this,i)}}function B7(e,t){if(t&&(Ki(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z7(e)}function z7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pu(e){return Pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pu(e)}var Yy=function(e){V7(r,e);var t=W7(r);function r(n,i,o,a){return j7(this,r),t.call(this,n,i,o,a,Fn)}return H7(r)}(So);Be(Yy,GR);Be(Yy,Wy);const Y7=Yy;function Xi(e){return Xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xi(e)}function Fs(e,t,r){return ZR()?Fs=Reflect.construct.bind():Fs=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&Iu(u,a.prototype),u},Fs.apply(null,arguments)}function G7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QR(n.key),n)}}function K7(e,t,r){return t&&Vw(e.prototype,t),r&&Vw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iu(e,t)}function Iu(e,t){return Iu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Iu(e,t)}function q7(e){var t=ZR();return function(){var n=ku(e),i;if(t){var o=ku(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Z7(this,i)}}function Z7(e,t){if(t&&(Xi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qR(e)}function qR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ku(e)}function Q7(e,t,r){return t=QR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QR(e){var t=J7(e,"string");return Xi(t)==="symbol"?t:String(t)}function J7(e,t){if(Xi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e9=function(e){X7(r,e);var t=q7(r);function r(n,i,o,a){var l;return G7(this,r),l=t.call(this,n,i,Fn,o,a),Q7(qR(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return K7(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Fs(Y7,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===o&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),h=i.offsetHeight;s=f===h,l=this.getOverlayOffset(),ky(i,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Sc(i);var v=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),v}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(Iy(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=i,s=0;l<o;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,l=o.rootWindow,s=wt(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||f==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,i.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var v=Kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(v=0),c.height="".concat(v,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((i=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,c=this.getTableParentOffset(),f=0;if(o){var h=this.wot.wtTable.getRowHeight(i),v=this.wot.wtViewport.getViewportHeight();h>v&&(o=!1)}if(o&&u.offsetHeight!==u.clientHeight&&(f=wt(this.domBindings.rootDocument)),o){var m=l.getSetting("fixedRowsBottom"),p=l.getSetting("totalRows");c+=this.sumCellSizes(0,i+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(p-m,p),c+=1}else c+=this.sumCellSizes(l.getSetting("fixedRowsTop"),i);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return iu(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Ue(a,"emptyColumns"):he(a,"emptyColumns");var s=!1;if(!o){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var h=Ne(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(he(a,"innerBorderTop"),s=!h):(Ue(a,"innerBorderTop"),s=h)}}return s}}]),r}(Ll);function Ia(e){return Ia=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ia(e)}function nn(e,t,r){return t9()?nn=Reflect.construct.bind():nn=function(i,o,a){var l=[null];l.push.apply(l,o);var s=Function.bind.apply(i,l),u=new s;return a&&Ad(u,a.prototype),u},nn.apply(null,arguments)}function t9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ad(e,t){return Ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ad(e,t)}function r9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ww(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JR(n.key),n)}}function n9(e,t,r){return t&&Ww(e.prototype,t),r&&Ww(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mr(e,t,r){return t=JR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JR(e){var t=i9(e,"string");return Ia(t)==="symbol"?t:String(t)}function i9(e,t){if(Ia(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ia(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o9=function(){function e(t,r,n,i,o,a){var l=this;r9(this,e),Mr(this,"wot",null),Mr(this,"topOverlay",null),Mr(this,"bottomOverlay",null),Mr(this,"inlineStartOverlay",null),Mr(this,"topInlineStartCornerOverlay",null),Mr(this,"bottomInlineStartCornerOverlay",null),Mr(this,"browserLineHeight",void 0),Mr(this,"wtSettings",null),Mr(this,"resizeObserver",new ResizeObserver(function(h){SW(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=wt(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:ou(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return n9(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),a=parseInt(o.lineHeight,10),l=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=nn(e9,r),this.bottomOverlay=nn(QX,r),this.inlineStartOverlay=nn(p7,r),this.topInlineStartCornerOverlay=nn(D7,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=nn(MX,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(m){return r.onKeyDown(m)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(m){return r.onTableScroll(m)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(m){return r.onTableScroll(m)},{passive:!0});var s=o.devicePixelRatio&&o.devicePixelRatio>1,u=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||s||!vB())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(m){return r.onCloneWheel(m,c)},f);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(m){if(m&&m.needFullRender){var p=m.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(b){return r.onCloneWheel(b,c)},f)}});var v;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(v),v=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(o!==n&&a!==n&&!r.target.contains(o)||i!==n&&a!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==i&&l!==i&&!l.contains(a),u=o!==i&&l!==i&&!l.contains(o);if(!(this.keyPressed&&(s||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=c3(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),a=this.scrollHorizontally(i);return o||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],l=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=ou(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,o),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,f=c.scrollHeight,h=c.scrollWidth,v=i.holder,m=v.scrollHeight,p=v.scrollWidth;this.hasScrollbarRight=f<m,this.hasScrollbarBottom=h<p,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ve(n,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ve(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const a9=o9;function ka(e){return ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ka(e)}function l9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eE(n.key),n)}}function s9(e,t,r){return t&&Bw(e.prototype,t),r&&Bw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zw(e,t,r){return t=eE(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eE(e){var t=u9(e,"string");return ka(t)==="symbol"?t:String(t)}function u9(e,t){if(ka(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ka(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var c9=function(){function e(t){var r=this;l9(this,e),zw(this,"settings",{}),zw(this,"defaults",Object.freeze(this.getDefaults())),Te(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return s9(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,a){var l=r.getSetting("data",i,o);xl(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?Te(r,function(o,a){i.settings[a]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,a){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function qi(e){return qi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(e)}function f9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d9(n.key),n)}}function h9(e,t,r){return t&&Uw(e.prototype,t),r&&Uw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d9(e){var t=v9(e,"string");return qi(t)==="symbol"?t:String(t)}function v9(e,t){if(qi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y9(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Md(e,t)}function Md(e,t){return Md=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Md(e,t)}function m9(e){var t=b9();return function(){var n=Au(e),i;if(t){var o=Au(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return g9(this,i)}}function g9(e,t){if(t&&(qi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p9(e)}function p9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}var Gy=function(e){y9(r,e);var t=m9(r);function r(n,i,o,a){return f9(this,r),t.call(this,n,i,o,a,"master")}return h9(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=au(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=i.parentElement,s=td(i,"height",o),u=td(i,"overflow",o),c=this.holder.style,f=i.scrollWidth,h=i.scrollHeight,v=i.getBoundingClientRect(),m=v.width,p=v.height,b=["auto","hidden","scroll"];if(l&&b.includes(u)){var C=i.cloneNode(!1);C.style.overflow="auto",C.style.position="absolute",i.nextElementSibling?l.insertBefore(C,i.nextElementSibling):l.appendChild(C);var T=parseInt(Hn(C,o).height,10);l.removeChild(C),T===0&&(p=0)}p=Math.min(p,h),c.height=s==="auto"?"auto":"".concat(p,"px"),m=Math.min(m,f),c.width="".concat(m,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:p>0,this.hasTableWidth=m>0}this.isTableVisible=nu(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,a="master",l=i.getSetting("columnHeaders"),s=l.length;if(s&&!o.hasOversizedColumnHeadersMarked[a]){for(var u=i.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var v=-1*c;v<f;v++)this.markIfOversizedColumnHeader(v);o.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(So);Be(Gy,zR);Be(Gy,Wy);const w9=Gy;function Aa(e){return Aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(e)}function S9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C9(n.key),n)}}function O9(e,t,r){return t&&Yw(e.prototype,t),r&&Yw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C9(e){var t=_9(e,"string");return Aa(t)==="symbol"?t:String(t)}function _9(e,t){if(Aa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Aa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T9=function(){function e(t,r,n,i,o){var a=this;S9(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return O9(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=Kt(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=i.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-l:f.left,v=l-h,m,p;if(u)return Qe(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?m=Math.min(v,l):m=Math.min(this.getContainerFillWidth(),v,l),a===o&&s>0&&this.sumColumnWidths(0,s-1)>m)return i.documentElement.clientWidth;if(a!==o&&(p=td(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(m,a.clientWidth);var b=r.getSetting("stretchH");return b==="none"||!b?Math.max(m,Qe(this.wtTable.TABLE)):m}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return $t(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Kt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=Qe(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$n,n=this.wtSettings,i=this.wtTable,o,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===$n?o=1/0:o=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,o-=l),c&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),o-=l),i.holder.clientHeight===i.holder.offsetHeight?a=0:a=wt(this.domBindings.rootDocument),new F4({viewportSize:o,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(v){return i.getRowHeight(v)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$n,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,o-=s}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=wt(this.domBindings.rootDocument)),new mR({viewportSize:o,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return i.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(ut),o=this.createColumnsCalculator(ut);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator($n),this.columnsRenderCalculator=this.createColumnsCalculator($n)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(ut),this.columnsVisibleCalculator=this.createColumnsCalculator(ut)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Te(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const R9=T9;function Zi(e){return Zi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zi(e)}function E9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P9(n.key),n)}}function $9(e,t,r){return t&&Gw(e.prototype,t),r&&Gw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P9(e){var t=I9(e,"string");return Zi(t)==="symbol"?t:String(t)}function I9(e,t){if(Zi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k9(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xd(e,t)}function xd(e,t){return xd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xd(e,t)}function A9(e){var t=x9();return function(){var n=Mu(e),i;if(t){var o=Mu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return M9(this,i)}}function M9(e,t){if(t&&(Zi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nd(e)}function Nd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mu(e){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mu(e)}var N9=function(e){k9(r,e);var t=A9(r);function r(n,i){var o;E9(this,r),o=t.call(this,n,new c9(i));var a=o.wtSettings.getSetting("facade",Nd(o));return o.wtTable=new w9(o.getTableDao(),a,o.domBindings,o.wtSettings),o.wtViewport=new R9(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new RR(a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new a9(Nd(o),a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return $9(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];Te(o,function(s,u){i.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Ue(this.wtTable.wtRootElement.parentNode,a),he(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(Vy);function Ma(e){return Ma=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(e)}function D9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L9(n.key),n)}}function H9(e,t,r){return t&&Kw(e.prototype,t),r&&Kw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L9(e){var t=F9(e,"string");return Ma(t)==="symbol"?t:String(t)}function F9(e,t){if(Ma(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ma(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j9=function(){function e(t){D9(this,e),t instanceof Vy?this._wot=t:this._initFromSettings(t)}return H9(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new N9(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wot.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,a){return this._wot.wtSettings.getSetting(r,n,i,o,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),V9=Fe,tE=ee,W9=wl,B9=Ft,z9=cl.f,U9=tE(z9),Y9=tE([].push),Xw=function(e){return function(t){for(var r=B9(t),n=W9(r),i=n.length,o=0,a=[],l;i>o;)l=n[o++],(!V9||U9(r,l))&&Y9(a,e?[l,r[l]]:r[l]);return a}},G9={entries:Xw(!0),values:Xw(!1)},K9=K,X9=G9.values;K9({target:"Object",stat:!0},{values:function(t){return X9(t)}});function xa(e){return xa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xa(e)}function qf(e,t){return J9(e)||Q9(e,t)||Z9(e,t)||q9()}function q9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z9(e,t){if(e){if(typeof e=="string")return qw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qw(e,t)}}function qw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q9(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function J9(e){if(Array.isArray(e))return e}function eq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rq(n.key),n)}}function tq(e,t,r){return t&&Zw(e.prototype,t),r&&Zw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rq(e){var t=nq(e,"string");return xa(t)==="symbol"?t:String(t)}function nq(e,t){if(xa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iq=function(){function e(t,r){eq(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return tq(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[s])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Ay(r);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(i.eventManager.removeEventListener(o,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var l=i[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),o=s.style,o.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,o.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Pn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};Te(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Te(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,v=c.bottom,m=c.bottomHitArea,p=parseInt(f.borderWidth,10),b=parseInt(f.width,10),C=parseInt(h.width,10),T=this.wot.wtTable.getWidth(),I=this.wot.wtTable.getHeight();f.top="".concat(parseInt(i-b-1,10),"px"),f[u]="".concat(parseInt(o-b-1,10),"px"),h.top="".concat(parseInt(i-C/4*3,10),"px"),h[u]="".concat(parseInt(o-C/4*3,10),"px");var P=Math.min(parseInt(o+a,10),T-b-p*2),E=Math.min(parseInt(o+a-C/4,10),T-C-p*2);v[u]="".concat(P,"px"),m[u]="".concat(E,"px");var q=Math.min(parseInt(i+l,10),I-b-p*2),Y=Math.min(parseInt(i+l-C/4,10),I-C-p*2);v.top="".concat(q,"px"),m.top="".concat(Y,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(r,n)?(v.display="none",m.display="none"):(v.display="block",m.display="block")):(f.display="none",v.display="none",h.display="none",m.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,l,s,u,c,f,h,v=i.getRenderedRowsCount(),m=0;m<v;m+=1){var p=i.rowFilter.renderedToSource(m);if(p>=r[0]&&p<=r[2]){l=p,f=r[0];break}}for(var b=v-1;b>=0;b-=1){var C=i.rowFilter.renderedToSource(b);if(C>=r[0]&&C<=r[2]){s=C;break}}for(var T=i.getRenderedColumnsCount(),I=0;I<T;I+=1){var P=i.columnFilter.renderedToSource(I);if(P>=r[1]&&P<=r[3]){u=P,h=r[1];break}}for(var E=T-1;E>=0;E-=1){var q=i.columnFilter.renderedToSource(E);if(q>=r[1]&&q<=r[3]){c=q;break}}if(l===void 0||u===void 0){this.disappear();return}var Y=i.getCell(this.wot.createCellCoords(l,u)),ne=l!==s||u!==c,me=ne?i.getCell(this.wot.createCellCoords(s,c)):Y,dt=$t(Y),et=ne?$t(me):dt,ze=$t(i.TABLE),ie=Qe(i.TABLE),Pe=dt.top,Ke=dt.left,Ce=this.wot.wtSettings.getSetting("rtlMode"),Me=0,xe=0;if(Ce){var d=Qe(Y),y=a.innerWidth-ze.left-ie;xe=Ke+d-et.left,Me=a.innerWidth-Ke-d-y-1}else xe=et.left+Qe(me)-Ke,Me=Ke-ze.left-1;if(this.isEntireColumnSelected(l,s)){var g=this.getDimensionsFromHeader("columns",u,c,f,ze),w=null;if(g){var S=qf(g,3);w=S[0],Me=S[1],xe=S[2]}w&&(Y=w)}var _=Pe-ze.top-1,R=et.top+Kt(me)-Pe;if(this.isEntireRowSelected(u,c)){var $=this.getDimensionsFromHeader("rows",l,s,h,ze),k=null;if($){var H=qf($,3);k=H[0],_=H[1],R=H[2]}k&&(Y=k)}var N=Hn(Y,a);parseInt(N.borderTopWidth,10)>0&&(_+=1,R=R>0?R-1:0),parseInt(N[Ce?"borderRightWidth":"borderLeftWidth"],10)>0&&(Me+=1,xe=xe>0?xe-1:0);var B=Ce?"right":"left";this.topStyle.top="".concat(_,"px"),this.topStyle[B]="".concat(Me,"px"),this.topStyle.width="".concat(xe,"px"),this.topStyle.display="block",this.startStyle.top="".concat(_,"px"),this.startStyle[B]="".concat(Me,"px"),this.startStyle.height="".concat(R,"px"),this.startStyle.display="block";var te=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(_+R-te,"px"),this.bottomStyle[B]="".concat(Me,"px"),this.bottomStyle.width="".concat(xe,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(_,"px"),this.endStyle[B]="".concat(Me+xe-te,"px"),this.endStyle.height="".concat(R+1,"px"),this.endStyle.display="block";var z=this.settings.border.cornerVisible;z=typeof z=="function"?z(this.settings.layerLevel):z;var G=this.wot.getSetting("onModifyGetCellCoords",s,c),se=s,ge=c;if(G&&Array.isArray(G)){var He=qf(G,4);se=He[2],ge=He[3]}if(Pn()||!z||this.isPartRange(se,ge))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(_+R+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[B]="".concat(Me+xe+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var we=au(i.TABLE),Se=we===a;Se&&(we=o.documentElement);var We=parseInt(this.cornerDefaultStyle.width,10)/2,Xe=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var er=Se?me.getBoundingClientRect().left:me.offsetLeft,Vt=!1,at=0;Ce?(at=er-parseInt(this.cornerDefaultStyle.width,10)/2,Vt=at<0):(at=er+Qe(me)+parseInt(this.cornerDefaultStyle.width,10)/2,Vt=at>=Is(we)),Vt&&(this.cornerStyle[B]="".concat(Math.floor(Me+xe+this.cornerCenterPointOffset-We),"px"),this.cornerStyle[Ce?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var At=Se?me.getBoundingClientRect().top:me.offsetTop,tt=At+Kt(me)+parseInt(this.cornerDefaultStyle.height,10)/2,rt=tt>=sn(we);rt&&(this.cornerStyle.top="".concat(Math.floor(_+R+this.cornerCenterPointOffset-Xe),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Pn()&&this.updateMultipleSelectionHandlesPosition(s,c,_,Me,xe,R)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,c=null,f=null,h=null,v=null,m=null,p=null,b=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},c=function(){return Kt.apply(void 0,arguments)},f="ht__selection--rows",m="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},c=function(){return Qe.apply(void 0,arguments)},f="ht__selection--columns",m="left";break}if(s.classList.contains(f)){var C=this.wot.getSetting("columnHeaders").length;if(p=u(n,C-o),b=u(i,C-o),!p||!b)return!1;var T=$t(p),I=$t(b);return p&&b&&(h=T[m]-a[m]-1,v=I[m]+c(b)-T[m]),[p,h,v]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?he(this[r],"hidden"):(Ne(this[r],"hidden")&&Ue(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?he(this[r],"hidden"):Ue(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Pn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const oq=iq;function aq(e,t){return cq(e)||uq(e,t)||sq(e,t)||lq()}function lq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sq(e,t){if(e){if(typeof e=="string")return Qw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qw(e,t)}}function Qw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function cq(e){if(Array.isArray(e))return e}function Qi(e){return Qi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qi(e)}function fq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dq(n.key),n)}}function hq(e,t,r){return t&&Jw(e.prototype,t),r&&Jw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dq(e){var t=vq(e,"string");return Qi(t)==="symbol"?t:String(t)}function vq(e,t){if(Qi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yq=function(){function e(t,r){fq(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return hq(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new oq(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Qi(l)==="object"){var s=o;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),he(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(Ne(o,u)){var c=l+1;s="".concat(r,"-").concat(c)}else s=i(o,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=aq(o,4),l=a[0],s=a[1],u=a[2],c=a[3],f=this.settings,h=f.highlightHeaderClassName,v=f.highlightColumnClassName,m=f.highlightRowClassName,p=f.highlightOnlyClosestHeader,b=f.selectionType,C=b===void 0||["active-header","header"].includes(b);if(C&&s!==null&&c!==null)for(var T=0,I=0;I<i;I+=1){var P=r.wtTable.columnFilter.renderedToSource(I);if(P>=s&&P<=c){var E=r.wtTable.getColumnHeaders(P),q=E.length-1;p&&E.length>1&&(E=[E[q]]);for(var Y=0;Y<E.length;Y+=1){var ne=[],me=E[Y];h&&ne.push(h),v&&ne.push(v),Y=p?q:Y;var dt=r.getSetting("onBeforeHighlightingColumnHeader",P,Y,{selectionType:b,columnCursor:T,selectionWidth:c-s+1,classNames:ne});dt!==P&&(me=r.wtTable.getColumnHeader(dt,Y)),he(me,ne)}T+=1}}if(l!==null&&u!==null)for(var et=0,ze=0;ze<n;ze+=1){var ie=r.wtTable.rowFilter.renderedToSource(ze);if(C&&ie>=l&&ie<=u){var Pe=r.wtTable.getRowHeaders(ie),Ke=Pe.length-1;p&&Pe.length>1&&(Pe=[Pe[Ke]]);for(var Ce=0;Ce<Pe.length;Ce+=1){var Me=[],xe=Pe[Ce];h&&Me.push(h),m&&Me.push(m),Ce=p?Ke:Ce;var d=r.getSetting("onBeforeHighlightingRowHeader",ie,Ce,{selectionType:b,rowCursor:et,selectionHeight:u-l+1,classNames:Me});d!==ie&&(xe=r.wtTable.getRowHeader(d,Ce)),he(xe,Me)}et+=1}if(s!==null&&c!==null)for(var y=0;y<i;y+=1){var g=r.wtTable.columnFilter.renderedToSource(y);ie>=l&&ie<=u&&g>=s&&g<=c?this.settings.className&&this.addClassAtCoords(r,ie,g,this.settings.className,this.settings.markIntersections):ie>=l&&ie<=u?m&&this.addClassAtCoords(r,ie,g,m):g>=s&&g<=c&&v&&this.addClassAtCoords(r,ie,g,v);var w=r.getSetting("onAfterDrawSelection",ie,g,this.settings.layerLevel);typeof w=="string"&&this.addClassAtCoords(r,ie,g,w)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const mq=yq;function eS(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,o=e.selection,a=e.controller,l=e.cellCoordsFactory,s=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(t&&s)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(l(i.row,i.col)):u&&i.row<0&&!a.column?o.setRangeEnd(l(s.to.row,i.col)):c&&i.col<0&&!a.row?o.setRangeEnd(l(i.row,s.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!a.row?o.selectRows(Math.max(s.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!a.column&&o.selectColumns(Math.max(s.from.col,0),i.col,i.row);else{var f=!o.inInSelection(i),h=r||n&&f;i.row<0&&i.col>=0&&!a.column?h&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?h&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?h&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function gq(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!i.column?n.setRangeEnd(o(u-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,s-1)):i.cell||n.setRangeEnd(r)}}var pq=new Map([["mousedown",eS],["mouseover",gq],["touchstart",eS]]);function tS(e,t){var r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;pq.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:iR(e)||e.type==="touchstart",isRightClick:id(e)})}var rE=new WeakMap,Ky=Symbol("rootInstance");function bq(e){rE.set(e,!0)}function wq(e){return e===Ky}function Dd(e){return rE.has(e)}function Na(e){return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Na(e)}function Ho(e,t){return Cq(e)||Oq(e,t)||nE(e,t)||Sq()}function Sq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function Cq(e){if(Array.isArray(e))return e}function rS(e){return Rq(e)||Tq(e)||nE(e)||_q()}function _q(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nE(e,t){if(e){if(typeof e=="string")return Hd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hd(e,t)}}function Tq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rq(e){if(Array.isArray(e))return Hd(e)}function Hd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Eq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iE(n.key),n)}}function $q(e,t,r){return t&&nS(e.prototype,t),r&&nS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iS(e,t,r){Pq(e,t),t.set(e,r)}function Pq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(e,t,r){return t=iE(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iE(e){var t=Iq(e,"string");return Na(t)==="symbol"?t:String(t)}function Iq(e,t){if(Na(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Na(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oS(e,t){var r=oE(e,t,"get");return kq(e,r)}function kq(e,t){return t.get?t.get.call(e):t.value}function aS(e,t,r){var n=oE(e,t,"set");return Aq(e,n,r),r}function oE(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Aq(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Rn=new WeakMap,Zf=new WeakMap,Qf=new WeakMap,Mq=function(){function e(t){Eq(this,e),Jr(this,"instance",void 0),Jr(this,"eventManager",void 0),Jr(this,"settings",void 0),Jr(this,"THEAD",void 0),Jr(this,"TBODY",void 0),Jr(this,"_wt",void 0),Jr(this,"activeWt",void 0),iS(this,Zf,{writable:!0,value:0}),iS(this,Qf,{writable:!0,value:0}),Jr(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Dl(this.instance),this.settings=this.instance.getSettings(),Rn.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return $q(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wt.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Rn.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),he(i,"handsontable"),r.table=o.createElement("TABLE"),he(r.table,"htCore"),this.instance.getSettings().tableClassName&&he(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Rn.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,l=i.selection,s=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;Sb(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&Sb(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&iR(u)&&l.finish(),n.mouseDown=!1,(XT(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!o.contains(u.target)&&!id(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&id(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,h=u.y||u.clientY,v=u.target;if(!(n.mouseDown||!o||!r.instance.view)){var m=r.instance.view._wt.wtTable.holder;if(v===m){var p=wt(a);if(a.elementFromPoint(f+p,h)!==m||a.elementFromPoint(f,h+p)!==m)return}else for(;v!==s;){if(v===null){if(u.isTargetWebComponent)break;return}if(v===o)return;v=v.parentNode}var b=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;b?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||rd(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,rS(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var a=i.getNearestNotHiddenIndex(r,n),l=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=o-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Rn.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return Dd(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var h;return(h=r.instance).getDataAtCell.apply(h,rS(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,h){var v=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(v,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),aS(r,Qf,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,h){var v=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(v,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),aS(r,Zf,c.length),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,h){var v=r.translateFromRenderableToVisualIndex(c,f),m=Ho(v,2),p=m[0],b=m[1],C=r.instance.runHooks("modifyGetCellCoords",p,b),T=p,I=b;if(Array.isArray(C)){var P=Ho(C,2);T=P[0],I=P[1]}var E=r.instance.getCellMeta(T,I),q=r.instance.colToProp(I),Y=r.instance.getDataAtRowProp(T,q);r.instance.hasHook("beforeValueRender")&&(Y=r.instance.runHooks("beforeValueRender",Y,E)),r.instance.runHooks("beforeRenderer",h,p,b,q,Y,E),r.instance.getCellRenderer(E)(r.instance,h,p,b,q,Y,E),r.instance.runHooks("afterRenderer",h,p,b,q,Y,E)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,f,h,v){var m=r.translateFromRenderableToVisualCoords(f),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=v,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,m,h,p),!mi(c)&&(tS(c,{coords:m,selection:r.instance.selection,controller:p,cellCoordsFactory:function(C,T){return r.instance._createCellCoords(C,T)}}),r.instance.runHooks("afterOnCellMouseDown",c,m,h),r.activeWt=r._wt)},onCellContextMenu:function(c,f,h,v){var m=r.translateFromRenderableToVisualCoords(f);r.activeWt=v,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,m,h),!mi(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,m,h),r.activeWt=r._wt)},onCellMouseOut:function(c,f,h,v){var m=r.translateFromRenderableToVisualCoords(f);r.activeWt=v,r.instance.runHooks("beforeOnCellMouseOut",c,m,h),!mi(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,m,h),r.activeWt=r._wt)},onCellMouseOver:function(c,f,h,v){var m=r.translateFromRenderableToVisualCoords(f),p={row:!1,column:!1,cell:!1};r.activeWt=v,r.instance.runHooks("beforeOnCellMouseOver",c,m,h,p),!mi(c)&&(n.mouseDown&&tS(c,{coords:m,selection:r.instance.selection,controller:p,cellCoordsFactory:function(C,T){return r.instance._createCellCoords(C,T)}}),r.instance.runHooks("afterOnCellMouseOver",c,m,h),r.activeWt=r._wt)},onCellMouseUp:function(c,f,h,v){var m=r.translateFromRenderableToVisualCoords(f);r.activeWt=v,r.instance.runHooks("beforeOnCellMouseUp",c,m,h),!(mi(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,m,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,h){var v=r.instance.rowIndexMapper,m=v.getVisualFromRenderableIndex(c),p=r.instance.runHooks("beforeHighlightingRowHeader",m,f,h);return v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(c,f,h){var v=r.instance.columnIndexMapper,m=v.getVisualFromRenderableIndex(c),p=r.instance.runHooks("beforeHighlightingColumnHeader",m,f,h);return v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(c,f,h){var v,m=r.translateFromRenderableToVisualIndex(c,f),p=Ho(m,2),b=p[0],C=p[1],T=r.instance.selection.getSelectedRange(),I=T.size();if(I>0){var P=(h??0)+1-I,E=T.peekByIndex(P);v=[E.from.row,E.from.col,E.to.row,E.to.col]}return r.instance.runHooks("afterDrawSelection",b,C,v,h)},onBeforeDrawBorders:function(c,f){var h=Ho(c,4),v=h[0],m=h[1],p=h[2],b=h[3],C=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(v),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(b)];return r.instance.runHooks("beforeDrawBorders",C,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,h)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,h){var v=r.instance.rowIndexMapper,m=r.instance.columnIndexMapper,p=f>=0?m.getVisualFromRenderableIndex(f):f,b=c>=0?v.getVisualFromRenderableIndex(c):c,C=r.instance.runHooks("modifyGetCellCoords",b,p,h);if(Array.isArray(C)){var T=Ho(C,4),I=T[0],P=T[1],E=T[2],q=T[3];return[I>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(I,1)):I,P>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(P,1)):P,E>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(E,-1)):E,q>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(q,-1)):q]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var h=r.countRenderableRows(),v=c.startRow,m=c.endRow;if(typeof f=="number")c.startRow=Math.max(v-f,0),c.endRow=Math.min(m+f,h-1);else if(f==="auto"){var p=Math.ceil(m/h*12);c.startRow=Math.max(v-p,0),c.endRow=Math.min(m+p,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var h=r.countRenderableColumns(),v=c.startColumn,m=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(v-f,0),c.endColumn=Math.min(m+f,h-1)),f==="auto"){var p=Math.ceil(m/h*6);c.startColumn=Math.max(v-p,0),c.endColumn=Math.min(m+p,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new j9(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(o,"mousedown",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(rd(r))return!0;var n=qh(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Rn.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Ne(i,"relative")){Ai(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,l=o.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;Ne(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,i,o):(Ai(n),this.appendColHeader(r,n,i,o))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,o),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Ne(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):Ne(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?kG(r,i(n,o)):(xl(r,String.fromCharCode(160)),he(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Rn.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=Rn.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return oS(this,Zf)}},{key:"getRowHeadersCount",value:function(){return oS(this,Qf)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const xq=Mq;var Nq="ABCDEFGHIJKLMNOPQRSTUVWXYZ",lS=Nq.length;function Dq(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%lS,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/lS,10);return r}function aE(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Br(e[0])&&(t=sy(e[0]))),t}function Da(e){return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(e)}function Hq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fq(n.key),n)}}function Lq(e,t,r){return t&&sS(e.prototype,t),r&&sS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fq(e){var t=jq(e,"string");return Da(t)==="symbol"?t:String(t)}function jq(e,t){if(Da(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Da(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vq=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Hq(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Lq(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ve(this.data,function(o,a){var l=n.getAtCell(a,r);i.push(l)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&i===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,v){u[v]=o.getAtPhysicalCell(r,v,s)}):Yt(n,i,function(h){u[h-n]=o.getAtPhysicalCell(r,h,s)});else if(Br(s)||ke(s))if(a?u=[]:u={},!l||a){var c=0,f=this.countFirstRowKeys()-1;Yt(c,f,function(h){var v=o.colToProp(h);if(h>=(n||c)&&h<=(i||f)&&!Number.isInteger(v)){var m=o.getAtPhysicalCell(r,v,s);a?u.push(m):Rf(u,v,m)}})}else Te(s,function(h,v){Rf(u,v,o.getAtPhysicalCell(r,v,s))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=Pi(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:Rf(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=fB(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=Pi(o);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,c=null;n===null||i===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,i.row),s=Math.min(n.col,i.col),u=Math.max(n.row,i.row),c=Math.max(n.col,i.col));var f=[];return Yt(l,u,function(h){f.push(a?r.getAtRow(h,void 0,void 0,o):r.getAtRow(h,s,c,o))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return aE(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Wq=Vq;var uS=Ae,Bq=function(e){return e!==void 0&&(uS(e,"value")||uS(e,"writable"))},zq=K,Uq=Ge,Yq=je,Gq=Ve,Kq=Bq,Xq=Ur,qq=tc;function lE(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(Gq(e)===r)return e[t];if(n=Xq.f(e,t),n)return Kq(n)?n.value:n.get===void 0?void 0:Uq(n.get,r);if(Yq(i=qq(e)))return lE(i,t,r)}zq({target:"Reflect",stat:!0},{get:lE});var Zq=K,Qq=Q,Jq=Ft,sE=Ur.f,uE=Fe,eZ=!uE||Qq(function(){sE(1)});Zq({target:"Object",stat:!0,forced:eZ,sham:!uE},{getOwnPropertyDescriptor:function(t,r){return sE(Jq(t),r)}});var tZ="localHooks",cE={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,o,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)nd(this._localHooks[t][u],this,r,n,i,o,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};mn(cE,"MIXIN_NAME",tZ,{writable:!1,enumerable:!1});const ei=cE;function Ha(e){return Ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(e)}function rZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iZ(n.key),n)}}function nZ(e,t,r){return t&&cS(e.prototype,t),r&&cS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iZ(e){var t=oZ(e,"string");return Ha(t)==="symbol"?t:String(t)}function oZ(e,t){if(Ha(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ha(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;rZ(this,e),this.indexedValues=[],this.initValueOrFn=t}return nZ(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ke(this.initValueOrFn)?Yt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):Yt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();Be(Fl,ei);function Jf(e){return uZ(e)||sZ(e)||lZ(e)||aZ()}function aZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lZ(e,t){if(e){if(typeof e=="string")return Ld(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ld(e,t)}}function sZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uZ(e){if(Array.isArray(e))return Ld(e)}function Ld(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fE(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(Jf(e.slice(0,i)),Jf(r.map(function(o,a){return ke(n)?n(o,a):n})),Jf(i===void 0?[]:e.slice(i)))}function hE(e,t){return ly(e,function(r,n){return t.includes(n)===!1})}function Ji(e){return Ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ji(e)}function cZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hZ(n.key),n)}}function fZ(e,t,r){return t&&fS(e.prototype,t),r&&fS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hZ(e){var t=dZ(e,"string");return Ji(t)==="symbol"?t:String(t)}function dZ(e,t){if(Ji(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ji(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qo(){return typeof Reflect<"u"&&Reflect.get?qo=Reflect.get.bind():qo=function(t,r,n){var i=vZ(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},qo.apply(this,arguments)}function vZ(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wn(e),e!==null););return e}function yZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fd(e,t)}function Fd(e,t){return Fd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Fd(e,t)}function mZ(e){var t=bZ();return function(){var n=Wn(e),i;if(t){var o=Wn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gZ(this,i)}}function gZ(e,t){if(t&&(Ji(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pZ(e)}function pZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wn(e){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wn(e)}var Xy=function(e){yZ(r,e);var t=mZ(r);function r(){return cZ(this,r),t.apply(this,arguments)}return fZ(r,[{key:"insert",value:function(i,o){this.indexedValues=fE(this.indexedValues,i,o,this.initValueOrFn),qo(Wn(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=hE(this.indexedValues,i),qo(Wn(r.prototype),"remove",this).call(this,i)}}]),r}(Fl);function eo(e){return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eo(e)}function wZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OZ(n.key),n)}}function SZ(e,t,r){return t&&hS(e.prototype,t),r&&hS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OZ(e){var t=CZ(e,"string");return eo(t)==="symbol"?t:String(t)}function CZ(e,t){if(eo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jd(e,t)}function jd(e,t){return jd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jd(e,t)}function TZ(e){var t=$Z();return function(){var n=xu(e),i;if(t){var o=xu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RZ(this,i)}}function RZ(e,t){if(t&&(eo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EZ(e)}function EZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var dE=function(e){_Z(r,e);var t=TZ(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return wZ(this,r),t.call(this,n)}return SZ(r,[{key:"getHiddenIndexes",value:function(){return lc(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(Xy);function eh(e){return AZ(e)||kZ(e)||IZ(e)||PZ()}function PZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IZ(e,t){if(e){if(typeof e=="string")return Vd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vd(e,t)}}function kZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function AZ(e){if(Array.isArray(e))return Vd(e)}function Vd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vE(e,t,r){return[].concat(eh(e.slice(0,t)),eh(r),eh(e.slice(t)))}function Nu(e,t){return ly(e,function(r){return t.includes(r)===!1})}function yE(e,t){return Dn(e,function(r){return r-t.filter(function(n){return n<r}).length})}function mE(e,t){var r=t[0],n=t.length;return Dn(e,function(i){return i>=r?i+n:i})}function to(e){return to=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(e)}function MZ(e){return HZ(e)||DZ(e)||NZ(e)||xZ()}function xZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NZ(e,t){if(e){if(typeof e=="string")return Wd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wd(e,t)}}function DZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HZ(e){if(Array.isArray(e))return Wd(e)}function Wd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pE(n.key),n)}}function FZ(e,t,r){return t&&dS(e.prototype,t),r&&dS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dr(){return typeof Reflect<"u"&&Reflect.get?Dr=Reflect.get.bind():Dr=function(t,r,n){var i=jZ(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Dr.apply(this,arguments)}function jZ(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=or(e),e!==null););return e}function VZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bd(e,t)}function Bd(e,t){return Bd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Bd(e,t)}function WZ(e){var t=zZ();return function(){var n=or(e),i;if(t){var o=or(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BZ(this,i)}}function BZ(e,t){if(t&&(to(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gE(e)}function gE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},or(e)}function UZ(e,t,r){return t=pE(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pE(e){var t=YZ(e,"string");return to(t)==="symbol"?t:String(t)}function YZ(e,t){if(to(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(to(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GZ=function(e){VZ(r,e);var t=WZ(r);function r(){var n;LZ(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o)),UZ(gE(n),"orderOfIndexes",[]),n}return FZ(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=MZ(Array(i.length).keys()),Dr(or(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=Nu(this.orderOfIndexes,[i]),ke(this.initValueOrFn)?Dr(or(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Dr(or(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Dr(or(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=fE(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=mE(this.orderOfIndexes,o),Dr(or(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=hE(this.indexedValues,i),this.orderOfIndexes=Nu(this.orderOfIndexes,i),this.orderOfIndexes=yE(this.orderOfIndexes,i),Dr(or(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(Fl);function ro(e){return ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ro(e)}function KZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qZ(n.key),n)}}function XZ(e,t,r){return t&&vS(e.prototype,t),r&&vS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qZ(e){var t=ZZ(e,"string");return ro(t)==="symbol"?t:String(t)}function ZZ(e,t){if(ro(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ro(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zd(e,t)}function zd(e,t){return zd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zd(e,t)}function JZ(e){var t=rQ();return function(){var n=Du(e),i;if(t){var o=Du(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eQ(this,i)}}function eQ(e,t){if(t&&(ro(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tQ(e)}function tQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Du(e)}var bE=function(e){QZ(r,e);var t=JZ(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return KZ(this,r),t.call(this,n)}return XZ(r,[{key:"getTrimmedIndexes",value:function(){return lc(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(Xy);function no(e){return no=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(e)}function nQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oQ(n.key),n)}}function iQ(e,t,r){return t&&yS(e.prototype,t),r&&yS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oQ(e){var t=aQ(e,"string");return no(t)==="symbol"?t:String(t)}function aQ(e,t){if(no(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(no(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zo(){return typeof Reflect<"u"&&Reflect.get?Zo=Reflect.get.bind():Zo=function(t,r,n){var i=lQ(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Zo.apply(this,arguments)}function lQ(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bn(e),e!==null););return e}function sQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ud(e,t)}function Ud(e,t){return Ud=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ud(e,t)}function uQ(e){var t=hQ();return function(){var n=Bn(e),i;if(t){var o=Bn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cQ(this,i)}}function cQ(e,t){if(t&&(no(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fQ(e)}function fQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bn(e){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bn(e)}var dQ=function(e){sQ(r,e);var t=uQ(r);function r(){return nQ(this,r),t.call(this,function(n){return n})}return iQ(r,[{key:"insert",value:function(i,o){var a=mE(this.indexedValues,o);this.indexedValues=vE(a,i,o),Zo(Bn(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Nu(this.indexedValues,i);this.indexedValues=yE(o,i),Zo(Bn(r.prototype),"remove",this).call(this,i)}}]),r}(Fl),mS=new Map([["hiding",dE],["index",Fl],["linkedPhysicalIndexToValue",GZ],["physicalIndexToValue",Xy],["trimming",bE]]);function vQ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mS.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(mS.get(e))(t)}function La(e){return La=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},La(e)}function yQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQ(n.key),n)}}function mQ(e,t,r){return t&&gS(e.prototype,t),r&&gS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gQ(e){var t=pQ(e,"string");return La(t)==="symbol"?t:String(t)}function pQ(e,t){if(La(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(La(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qy=function(){function e(){yQ(this,e),this.collection=new Map}return mQ(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);oe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return bt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();Be(qy,ei);function io(e){return io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},io(e)}function bQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SQ(n.key),n)}}function wQ(e,t,r){return t&&pS(e.prototype,t),r&&pS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SQ(e){var t=OQ(e,"string");return io(t)==="symbol"?t:String(t)}function OQ(e,t){if(io(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(io(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yd(e,t)}function Yd(e,t){return Yd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yd(e,t)}function _Q(e){var t=EQ();return function(){var n=Hu(e),i;if(t){var o=Hu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return TQ(this,i)}}function TQ(e,t){if(t&&(io(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RQ(e)}function RQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}var bS=function(e){CQ(r,e);var t=_Q(r);function r(n,i){var o;return bQ(this,r),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return wQ(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=Dn(this.get(),function(f){return f.getValues()}),a=[],l=oe(o[0])&&o[0].length||0,s=0;s<l;s+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(o[c][s]);a.push(u)}return Dn(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return oe(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(qy);function Fa(e){return Fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(e)}function $Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IQ(n.key),n)}}function PQ(e,t,r){return t&&wS(e.prototype,t),r&&wS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IQ(e){var t=kQ(e,"string");return Fa(t)==="symbol"?t:String(t)}function kQ(e,t){if(Fa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AQ(e,t,r){MQ(e,t),t.set(e,r)}function MQ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xQ(e,t,r){var n=wE(e,t,"set");return NQ(e,n,r),r}function NQ(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function DQ(e,t){var r=wE(e,t,"get");return HQ(e,r)}function wE(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HQ(e,t){return t.get?t.get.call(e):t.value}var th=new WeakMap,SE=function(){function e(){$Q(this,e),AQ(this,th,{writable:!0,value:[]})}return PQ(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(DQ(this,th)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){xQ(this,th,r)}}]),e}();Be(SE,ei);function SS(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function ja(e){return ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ja(e)}function LQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jQ(n.key),n)}}function FQ(e,t,r){return t&&OS(e.prototype,t),r&&OS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jQ(e){var t=VQ(e,"string");return ja(t)==="symbol"?t:String(t)}function VQ(e,t){if(ja(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ja(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lo(e,t,r){WQ(e,t),t.set(e,r)}function WQ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(e,t){var r=OE(e,t,"get");return BQ(e,r)}function BQ(e,t){return t.get?t.get.call(e):t.value}function fs(e,t,r){var n=OE(e,t,"set");return zQ(e,n,r),r}function OE(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function zQ(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var hs=new WeakMap,Fo=new WeakMap,ds=new WeakMap,vs=new WeakMap,ys=new WeakMap,UQ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;LQ(this,e),Lo(this,hs,{writable:!0,value:new Set}),Lo(this,Fo,{writable:!0,value:[]}),Lo(this,ds,{writable:!0,value:[]}),Lo(this,vs,{writable:!0,value:!1}),Lo(this,ys,{writable:!0,value:!1}),fs(this,ys,r??!1)}return FQ(e,[{key:"createObserver",value:function(){var r=this,n=new SE;return zt(this,hs).add(n),n.addLocalHook("unsubscribe",function(){zt(r,hs).delete(n)}),n._writeInitialChanges(SS(zt(this,Fo),zt(this,ds))),n}},{key:"emit",value:function(r){var n=zt(this,ds);(!zt(this,vs)||zt(this,Fo).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(zt(this,ys)):fs(this,Fo,new Array(r.length).fill(zt(this,ys))),zt(this,vs)||(fs(this,vs,!0),n=zt(this,Fo)));var i=SS(n,r);zt(this,hs).forEach(function(o){return o._write(i)}),fs(this,ds,r)}}]),e}();function Va(e){return Va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Va(e)}var CS;function rh(e){return XQ(e)||KQ(e)||GQ(e)||YQ()}function YQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQ(e,t){if(e){if(typeof e=="string")return Gd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gd(e,t)}}function KQ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XQ(e){if(Array.isArray(e))return Gd(e)}function Gd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qQ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ZQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JQ(n.key),n)}}function QQ(e,t,r){return t&&_S(e.prototype,t),r&&_S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JQ(e){var t=eJ(e,"string");return Va(t)==="symbol"?t:String(t)}function eJ(e,t){if(Va(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Va(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TS=new Set(["getFirstNotHiddenIndex"]),Kd=function(){function e(){var t=this;ZQ(this,e),this.indexesSequence=new dQ,this.trimmingMapsCollection=new bS(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new bS(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new qy,this.hidingChangesObservable=new UQ({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return QQ(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,vQ(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof bE?this.trimmingMapsCollection.register(r,n):n instanceof dE?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return oe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return oe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return oe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return oe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;TS.has("getFirstNotHiddenIndex")&&(TS.delete("getFirstNotHiddenIndex"),Ln(Pt(CS||(CS=qQ([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=rh(new Array(r).keys()),this.notHiddenIndexesCache=rh(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=rh(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=Dn(r,function(f){return i.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Nu(this.getIndexesSequence(),o),u=a-l;if(n+l<a){var c=s.filter(function(f){return i.isTrimmed(f)===!1})[n];u=s.indexOf(c)}this.setIndexesSequence(vE(s,u,o))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=oe(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),l=Dn(new Array(n).fill(o),function(s,u){return s+u});this.suspendOperations(),this.indexesSequence.insert(a,l),this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),e}();Be(Kd,ei);var RS;function tJ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rJ(e,t){return Te(t,function(r,n){bt(e[n])&&(e[n]=r)}),e}function CE(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function _E(e){oe(e)&&LG(Pt(RS||(RS=tJ(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function nJ(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var TE=Jn("phraseFormatters"),iJ=TE.register,oJ=TE.getValues;function aJ(e,t){iJ(e,t)}function lJ(){return oJ()}aJ("pluralize",nJ);var RE="ContextMenu:items",X=RE,EE="".concat(X,".noItems"),$E="".concat(X,".insertRowAbove"),PE="".concat(X,".insertRowBelow"),IE="".concat(X,".insertColumnOnTheLeft"),kE="".concat(X,".insertColumnOnTheRight"),AE="".concat(X,".removeRow"),ME="".concat(X,".removeColumn"),xE="".concat(X,".undo"),NE="".concat(X,".redo"),DE="".concat(X,".readOnly"),HE="".concat(X,".clearColumn"),LE="".concat(X,".copy"),FE="".concat(X,".copyWithHeaders"),jE="".concat(X,".copyWithGroupHeaders"),VE="".concat(X,".copyHeadersOnly"),WE="".concat(X,".cut"),BE="".concat(X,".freezeColumn"),zE="".concat(X,".unfreezeColumn"),UE="".concat(X,".mergeCells"),YE="".concat(X,".unmergeCells"),GE="".concat(X,".addComment"),KE="".concat(X,".editComment"),XE="".concat(X,".removeComment"),qE="".concat(X,".readOnlyComment"),ZE="".concat(X,".align"),QE="".concat(X,".align.left"),JE="".concat(X,".align.center"),e0="".concat(X,".align.right"),t0="".concat(X,".align.justify"),r0="".concat(X,".align.top"),n0="".concat(X,".align.middle"),i0="".concat(X,".align.bottom"),o0="".concat(X,".borders"),a0="".concat(X,".borders.top"),l0="".concat(X,".borders.right"),s0="".concat(X,".borders.bottom"),u0="".concat(X,".borders.left"),c0="".concat(X,".borders.remove"),f0="".concat(X,".nestedHeaders.insertChildRow"),h0="".concat(X,".nestedHeaders.detachFromParent"),d0="".concat(X,".hideColumn"),v0="".concat(X,".showColumn"),y0="".concat(X,".hideRow"),m0="".concat(X,".showRow"),kt="Filters:",De="".concat(kt,"conditions"),g0="".concat(De,".none"),p0="".concat(De,".isEmpty"),b0="".concat(De,".isNotEmpty"),w0="".concat(De,".isEqualTo"),S0="".concat(De,".isNotEqualTo"),O0="".concat(De,".beginsWith"),C0="".concat(De,".endsWith"),_0="".concat(De,".contains"),T0="".concat(De,".doesNotContain"),sJ="".concat(De,".byValue"),R0="".concat(De,".greaterThan"),E0="".concat(De,".greaterThanOrEqualTo"),$0="".concat(De,".lessThan"),P0="".concat(De,".lessThanOrEqualTo"),I0="".concat(De,".isBetween"),k0="".concat(De,".isNotBetween"),A0="".concat(De,".after"),M0="".concat(De,".before"),x0="".concat(De,".today"),N0="".concat(De,".tomorrow"),D0="".concat(De,".yesterday"),H0="".concat(kt,"labels.filterByCondition"),L0="".concat(kt,"labels.filterByValue"),F0="".concat(kt,"labels.conjunction"),j0="".concat(kt,"labels.disjunction"),V0="".concat(kt,"values.blankCells"),W0="".concat(kt,"buttons.selectAll"),B0="".concat(kt,"buttons.clear"),z0="".concat(kt,"buttons.ok"),U0="".concat(kt,"buttons.cancel"),Y0="".concat(kt,"buttons.placeholder.search"),G0="".concat(kt,"buttons.placeholder.value"),K0="".concat(kt,"buttons.placeholder.secondValue");const uJ=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:GE,CONTEXTMENU_ITEMS_ALIGNMENT:ZE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:i0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:JE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:t0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:QE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:n0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:e0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:r0,CONTEXTMENU_ITEMS_BORDERS:o0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:s0,CONTEXTMENU_ITEMS_BORDERS_LEFT:u0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:l0,CONTEXTMENU_ITEMS_BORDERS_TOP:a0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:HE,CONTEXTMENU_ITEMS_COPY:LE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:VE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:jE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:FE,CONTEXTMENU_ITEMS_CUT:WE,CONTEXTMENU_ITEMS_EDIT_COMMENT:KE,CONTEXTMENU_ITEMS_FREEZE_COLUMN:BE,CONTEXTMENU_ITEMS_HIDE_COLUMN:d0,CONTEXTMENU_ITEMS_HIDE_ROW:y0,CONTEXTMENU_ITEMS_INSERT_LEFT:IE,CONTEXTMENU_ITEMS_INSERT_RIGHT:kE,CONTEXTMENU_ITEMS_MERGE_CELLS:UE,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:h0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:f0,CONTEXTMENU_ITEMS_NO_ITEMS:EE,CONTEXTMENU_ITEMS_READ_ONLY:DE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:qE,CONTEXTMENU_ITEMS_REDO:NE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:c0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:ME,CONTEXTMENU_ITEMS_REMOVE_COMMENT:XE,CONTEXTMENU_ITEMS_REMOVE_ROW:AE,CONTEXTMENU_ITEMS_ROW_ABOVE:$E,CONTEXTMENU_ITEMS_ROW_BELOW:PE,CONTEXTMENU_ITEMS_SHOW_COLUMN:v0,CONTEXTMENU_ITEMS_SHOW_ROW:m0,CONTEXTMENU_ITEMS_UNDO:xE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:zE,CONTEXTMENU_ITEMS_UNMERGE_CELLS:YE,CONTEXT_MENU_ITEMS_NAMESPACE:RE,FILTERS_BUTTONS_CANCEL:U0,FILTERS_BUTTONS_CLEAR:B0,FILTERS_BUTTONS_OK:z0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Y0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:K0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:G0,FILTERS_BUTTONS_SELECT_ALL:W0,FILTERS_CONDITIONS_AFTER:A0,FILTERS_CONDITIONS_BEFORE:M0,FILTERS_CONDITIONS_BEGINS_WITH:O0,FILTERS_CONDITIONS_BETWEEN:I0,FILTERS_CONDITIONS_BY_VALUE:sJ,FILTERS_CONDITIONS_CONTAINS:_0,FILTERS_CONDITIONS_EMPTY:p0,FILTERS_CONDITIONS_ENDS_WITH:C0,FILTERS_CONDITIONS_EQUAL:w0,FILTERS_CONDITIONS_GREATER_THAN:R0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:E0,FILTERS_CONDITIONS_LESS_THAN:$0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:P0,FILTERS_CONDITIONS_NAMESPACE:De,FILTERS_CONDITIONS_NONE:g0,FILTERS_CONDITIONS_NOT_BETWEEN:k0,FILTERS_CONDITIONS_NOT_CONTAIN:T0,FILTERS_CONDITIONS_NOT_EMPTY:b0,FILTERS_CONDITIONS_NOT_EQUAL:S0,FILTERS_CONDITIONS_TODAY:x0,FILTERS_CONDITIONS_TOMORROW:N0,FILTERS_CONDITIONS_YESTERDAY:D0,FILTERS_DIVS_FILTER_BY_CONDITION:H0,FILTERS_DIVS_FILTER_BY_VALUE:L0,FILTERS_LABELS_CONJUNCTION:F0,FILTERS_LABELS_DISJUNCTION:j0,FILTERS_NAMESPACE:kt,FILTERS_VALUES_BLANK_CELLS:V0},Symbol.toStringTag,{value:"Module"}));function Wa(e){return Wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wa(e)}var x;function D(e,t,r){return t=cJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cJ(e){var t=fJ(e,"string");return Wa(t)==="symbol"?t:String(t)}function fJ(e,t){if(Wa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hJ=(x={languageCode:"en-US"},D(x,EE,"No available options"),D(x,$E,"Insert row above"),D(x,PE,"Insert row below"),D(x,IE,"Insert column left"),D(x,kE,"Insert column right"),D(x,AE,["Remove row","Remove rows"]),D(x,ME,["Remove column","Remove columns"]),D(x,xE,"Undo"),D(x,NE,"Redo"),D(x,DE,"Read only"),D(x,HE,"Clear column"),D(x,ZE,"Alignment"),D(x,QE,"Left"),D(x,JE,"Center"),D(x,e0,"Right"),D(x,t0,"Justify"),D(x,r0,"Top"),D(x,n0,"Middle"),D(x,i0,"Bottom"),D(x,BE,"Freeze column"),D(x,zE,"Unfreeze column"),D(x,o0,"Borders"),D(x,a0,"Top"),D(x,l0,"Right"),D(x,s0,"Bottom"),D(x,u0,"Left"),D(x,c0,"Remove border(s)"),D(x,GE,"Add comment"),D(x,KE,"Edit comment"),D(x,XE,"Delete comment"),D(x,qE,"Read-only comment"),D(x,UE,"Merge cells"),D(x,YE,"Unmerge cells"),D(x,LE,"Copy"),D(x,FE,["Copy with header","Copy with headers"]),D(x,jE,["Copy with group header","Copy with group headers"]),D(x,VE,["Copy header only","Copy headers only"]),D(x,WE,"Cut"),D(x,f0,"Insert child row"),D(x,h0,"Detach from parent"),D(x,d0,["Hide column","Hide columns"]),D(x,v0,["Show column","Show columns"]),D(x,y0,["Hide row","Hide rows"]),D(x,m0,["Show row","Show rows"]),D(x,g0,"None"),D(x,p0,"Is empty"),D(x,b0,"Is not empty"),D(x,w0,"Is equal to"),D(x,S0,"Is not equal to"),D(x,O0,"Begins with"),D(x,C0,"Ends with"),D(x,_0,"Contains"),D(x,T0,"Does not contain"),D(x,R0,"Greater than"),D(x,E0,"Greater than or equal to"),D(x,$0,"Less than"),D(x,P0,"Less than or equal to"),D(x,I0,"Is between"),D(x,k0,"Is not between"),D(x,A0,"After"),D(x,M0,"Before"),D(x,x0,"Today"),D(x,N0,"Tomorrow"),D(x,D0,"Yesterday"),D(x,V0,"Blank cells"),D(x,H0,"Filter by condition"),D(x,L0,"Filter by value"),D(x,F0,"And"),D(x,j0,"Or"),D(x,W0,"Select all"),D(x,B0,"Clear"),D(x,z0,"OK"),D(x,U0,"Cancel"),D(x,Y0,"Search"),D(x,G0,"Value"),D(x,K0,"Second value"),x);const X0=hJ;var Xd=X0.languageCode,Cc=Jn("languagesDictionaries"),dJ=Cc.register,q0=Cc.getItem,vJ=Cc.hasItem,yJ=Cc.getValues;Z0(X0);function Z0(e,t){var r=e,n=t;return Br(e)&&(n=e,r=n.languageCode),mJ(r,n),dJ(r,vn(n)),vn(n)}function mJ(e,t){e!==Xd&&rJ(t,q0(Xd))}function Q0(e){return Zy(e)?vn(q0(e)):null}function Zy(e){return vJ(e)}function gJ(){return yJ()}function J0(e,t,r){var n=Q0(e);if(n===null)return null;var i=n[t];if(bt(i))return null;var o=pJ(i,r);return Array.isArray(o)?o[0]:o}function pJ(e,t){var r=e;return ve(lJ(),function(n){r=n(e,t)}),r}function bJ(e){var t=CE(e);return Zy(t)||(t=Xd,_E(e)),t}var wJ=K,SJ=Fe,OJ=JO,CJ=Ft,_J=Ur,TJ=mo;wJ({target:"Object",stat:!0,sham:!SJ},{getOwnPropertyDescriptors:function(t){for(var r=CJ(t),n=_J.f,i=OJ(r),o={},a=0,l,s;i.length>a;)s=n(r,l=i[a++]),s!==void 0&&TJ(o,l,s);return o}});var Qy="active-header",_c="area",Ba="cell",Jy="fill",Tc="header",em="custom-selection";function oo(e){return oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oo(e)}function RJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ES(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t$(n.key),n)}}function EJ(e,t,r){return t&&ES(e.prototype,t),r&&ES(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function js(){return typeof Reflect<"u"&&Reflect.get?js=Reflect.get.bind():js=function(t,r,n){var i=$J(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},js.apply(this,arguments)}function $J(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ao(e),e!==null););return e}function PJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qd(e,t)}function qd(e,t){return qd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qd(e,t)}function IJ(e){var t=AJ();return function(){var n=ao(e),i;if(t){var o=ao(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kJ(this,i)}}function kJ(e,t){if(t&&(oo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e$(e)}function e$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ao(e)}function MJ(e,t,r){return t=t$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t$(e){var t=xJ(e,"string");return oo(t)==="symbol"?t:String(t)}function xJ(e,t){if(oo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NJ=function(e){PJ(r,e);var t=IJ(r);function r(n,i){var o;return RJ(this,r),o=t.call(this,n,null),MJ(e$(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return EJ(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,js(ao(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,a=i.to,l=this.getNearestNotHiddenCoords(o,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=o,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(i,o,a){if(o<0)return o;var l=i.getNearestNotHiddenIndex(o,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,a=i.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,a);if(l!==null&&i.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return i.setHighlight(l),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,l=o.row===null||a.row===null,s=o.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(o.row,a.row),s?null:Math.min(o.col,a.col)),c=this.settings.createCellCoords(l?null:Math.max(o.row,a.row),s?null:Math.max(o.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),l=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(a,a,l)}}]),r}(mq);const Oo=NJ;function za(e){return za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(e)}var DJ=["activeHeaderClassName"];function $S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$S(Object(r),!0).forEach(function(n){HJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$S(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HJ(e,t,r){return t=LJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LJ(e){var t=FJ(e,"string");return za(t)==="symbol"?t:String(t)}function FJ(e,t){if(za(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(za(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jJ(e,t){if(e==null)return{};var r=VJ(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function WJ(e){var t=e.activeHeaderClassName,r=jJ(e,DJ),n=new Oo(PS(PS({highlightHeaderClassName:t},r),{},{selectionType:Qy}));return n}function Ua(e){return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(e)}var BJ=["layerLevel","areaCornerVisible"];function IS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IS(Object(r),!0).forEach(function(n){zJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zJ(e,t,r){return t=UJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UJ(e){var t=YJ(e,"string");return Ua(t)==="symbol"?t:String(t)}function YJ(e,t){if(Ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GJ(e,t){if(e==null)return{};var r=KJ(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function XJ(e){var t=e.layerLevel,r=e.areaCornerVisible,n=GJ(e,BJ),i=new Oo(kS(kS({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:_c}));return i}function Ya(e){return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ya(e)}var qJ=["cellCornerVisible"];function AS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AS(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return t=QJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QJ(e){var t=JJ(e,"string");return Ya(t)==="symbol"?t:String(t)}function JJ(e,t){if(Ya(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ya(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eee(e,t){if(e==null)return{};var r=tee(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tee(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ree(e){var t=e.cellCornerVisible,r=eee(e,qJ),n=new Oo(MS(MS({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Ba}));return n}function Ga(e){return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(e)}var nee=["border","visualCellRange"];function xS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xS(Object(r),!0).forEach(function(n){iee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iee(e,t,r){return t=oee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oee(e){var t=aee(e,"string");return Ga(t)==="symbol"?t:String(t)}function aee(e,t){if(Ga(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ga(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lee(e,t){if(e==null)return{};var r=see(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function see(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function uee(e){var t=e.border,r=e.visualCellRange,n=lee(e,nee),i=new Oo(nh(nh(nh({},t),n),{},{selectionType:em}),r);return i}var NS=Fe,cee=ee,fee=Ge,hee=Q,ih=wl,dee=pl,vee=cl,yee=It,mee=hl,ci=Object.assign,DS=Object.defineProperty,gee=cee([].concat),pee=!ci||hee(function(){if(NS&&ci({b:1},ci(DS({},"a",{enumerable:!0,get:function(){DS(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),ci({},e)[r]!=7||ih(ci({},t)).join("")!=n})?function(t,r){for(var n=yee(t),i=arguments.length,o=1,a=dee.f,l=vee.f;i>o;)for(var s=mee(arguments[o++]),u=a?gee(ih(s),a(s)):ih(s),c=u.length,f=0,h;c>f;)h=u[f++],(!NS||fee(l,s,h))&&(n[h]=s[h]);return n}:ci,bee=K,HS=pee;bee({target:"Object",stat:!0,arity:2,forced:Object.assign!==HS},{assign:HS});function Ka(e){return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ka(e)}function LS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function FS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LS(Object(r),!0).forEach(function(n){wee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wee(e,t,r){return t=See(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function See(e){var t=Oee(e,"string");return Ka(t)==="symbol"?t:String(t)}function Oee(e,t){if(Ka(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ka(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cee(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function _ee(e){var t=Object.assign({},(Cee(e),e)),r=new Oo(FS(FS({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:Jy}));return r}function Xa(e){return Xa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xa(e)}var Tee=["headerClassName","rowClassName","columnClassName"];function jS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jS(Object(r),!0).forEach(function(n){Ree(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ree(e,t,r){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eee(e){var t=$ee(e,"string");return Xa(t)==="symbol"?t:String(t)}function $ee(e,t){if(Xa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pee(e,t){if(e==null)return{};var r=Iee(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Iee(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function kee(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=Pee(e,Tee),o=new Oo(VS(VS({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:Tc}));return o}function qa(e){return qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qa(e)}function WS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Aee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WS(Object(r),!0).forEach(function(n){Mee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mee(e,t,r){return t=xee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xee(e){var t=Nee(e,"string");return qa(t)==="symbol"?t:String(t)}function Nee(e,t){if(qa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r$=Jn("highlight/types"),Co=r$.register,Dee=r$.getItem;Co(Qy,WJ);Co(_c,XJ);Co(Ba,ree);Co(em,uee);Co(Jy,_ee);Co(Tc,kee);function fi(e,t){return Dee(e)(Aee({type:e},t))}function Za(e){return Za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Za(e)}function en(e){return jee(e)||Fee(e)||Lee(e)||Hee()}function Hee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lee(e,t){if(e){if(typeof e=="string")return Zd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zd(e,t)}}function Fee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jee(e){if(Array.isArray(e))return Zd(e)}function Zd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BS(Object(r),!0).forEach(function(n){Vee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vee(e,t,r){return t=n$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n$(n.key),n)}}function Bee(e,t,r){return t&&zS(e.prototype,t),r&&zS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n$(e){var t=zee(e,"string");return Za(t)==="symbol"?t:String(t)}function zee(e,t){if(Za(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Za(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uee=function(e){function t(r){Wee(this,t),this.options=r,this.layerLevel=0,this.cell=fi(Ba,r),this.fill=fi(Jy,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Bee(t,[{key:"isEnabledFor",value:function(n,i){var o=n;n===Ba&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=fi(_c,jo({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return en(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=fi(Tc,jo({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return en(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=fi(Qy,jo({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return en(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return en(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(fi(em,jo(jo({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ve(this.areas.values(),function(n){return void n.clear()}),ve(this.headers.values(),function(n){return void n.clear()}),ve(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(en(this.areas.values()),en(this.headers.values()),en(this.activeHeaders.values()),en(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Yee=Uee;function Qa(e){return Qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qa(e)}function Gee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function US(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xee(n.key),n)}}function Kee(e,t,r){return t&&US(e.prototype,t),r&&US(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xee(e){var t=qee(e,"string");return Qa(t)==="symbol"?t:String(t)}function qee(e,t){if(Qa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zee=function(e){function t(r){Gee(this,t),this.ranges=[],this.createCellRange=r}return Kee(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Qee=Zee;function Ja(e){return Ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ja(e)}function Jee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tte(n.key),n)}}function ete(e,t,r){return t&&YS(e.prototype,t),r&&YS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tte(e){var t=rte(e,"string");return Ja(t)==="symbol"?t:String(t)}function rte(e,t){if(Ja(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ja(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i$=function(){function e(t,r){Jee(this,e),this.range=t,this.options=r}return ete(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,c=a,f=0,h=0;if(this.runLocalHooks("beforeTransformStart",o),s!==null&&u!==null){var v=this.options.countRows(),m=this.options.countCols(),p=this.options.fixedRowsBottom(),b=this.options.minSpareRows(),C=this.options.minSpareCols(),T=this.options.autoWrapRow(),I=this.options.autoWrapCol();s+r>v-1?i&&b>0&&!(p&&s>=v-p-1)?(this.runLocalHooks("insertRowRequire",v),v=this.options.countRows()):I&&(o.row=1-v,o.col=u+o.col===m-1?1-m:1):I&&s+o.row<0&&u+o.col>=0&&(o.row=v-1,o.col=u+o.col===0?m-1:-1),u+o.col>m-1?i&&C>0?(this.runLocalHooks("insertColRequire",m),m=this.options.countCols()):T&&(o.row=s+o.row===v-1?1-v:1,o.col=1-m):T&&u+o.col<0&&s+o.row>=0&&(o.row=s+o.row===0?v-1:-1,o.col=m-1);var P=this.options.createCellCoords(s+o.row,u+o.col);f=0,h=0,P.row<0?(f=-1,P.row=0):P.row>0&&P.row>=v&&(f=1,P.row=v-1),P.col<0?(h=-1,P.col=0):P.col>0&&P.col>=m&&(h=1,P.col=m-1),c=this.options.renderableToVisualCoords(P)}return this.runLocalHooks("afterTransformStart",c,f,h),c}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),a=o.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(o.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var h=this.options.countRows(),v=this.options.countCols(),m=this.options.visualToRenderableCoords(o.to),p=m.row,b=m.col,C=this.options.createCellCoords(p+i.row,b+i.col);l=0,s=0,C.row<0?(l=-1,C.row=0):C.row>0&&C.row>=h&&(l=1,C.row=h-1),C.col<0?(s=-1,C.col=0):C.col>0&&C.col>=v&&(s=1,C.col=v-1),a=this.options.renderableToVisualCoords(C)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();Be(i$,ei);const nte=i$;function Qd(e){return Qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qd(e)}var o$=0,a$=1,l$=2,tm=3,ite=[tm,l$],ote=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],oh=Symbol("root"),GS=Symbol("child");function s$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oh;if(t!==oh&&t!==GS)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===oh,i=o$;if(r){var o=e[0];if(e.length===0)i=a$;else if(n&&o instanceof Hy)i=tm;else if(n&&Array.isArray(o))i=s$(o,GS);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!ote[s].includes(Qd(l))});a&&(i=l$)}}return i}function ate(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!ite.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=e===tm,l=a?o.from.row:o[0],s=a?o.from.col:o[1],u=a?o.to.row:o[2],c=a?o.to.col:o[3];if(typeof i=="function"&&(typeof s=="string"&&(s=i(s)),typeof c=="string"&&(c=i(c))),bt(u)&&(u=l),bt(c)&&(c=s),!n){var f=l,h=s,v=u,m=c;l=Math.min(f,v),s=Math.min(h,m),u=Math.max(f,v),c=Math.max(h,m)}return[l,s,u,c]}}function tn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function el(e){return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(e)}var KS;function XS(e,t){return cte(e)||ute(e,t)||ste(e,t)||lte()}function lte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ste(e,t){if(e){if(typeof e=="string")return qS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qS(e,t)}}function qS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ute(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function cte(e){if(Array.isArray(e))return e}function fte(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vte(n.key),n)}}function dte(e,t,r){return t&&ZS(e.prototype,t),r&&ZS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vte(e){var t=yte(e,"string");return el(t)==="symbol"?t:String(t)}function yte(e,t){if(el(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(el(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u$=function(){function e(t,r){var n=this;hte(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Qee(function(i,o,a){return n.tableProps.createCellRange(i,o,a)}),this.highlight=new Yee({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},createCellRange:function(o,a,l){return n.tableProps.createCellRange(o,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new nte(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return dte(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=bt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),c),(!o||o&&!a&&bt(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ba,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(ve(this.highlight.getAreas(),function(p){return void p.clear()}),ve(this.highlight.getHeaders(),function(p){return void p.clear()}),ve(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(_c,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Tc,i.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,h=i;if((c||f)&&(h=i.clone()),c&&(h.from.row=-1),f&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var v=this.tableProps.countCols()===i.getWidth();v&&s.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var m=this.tableProps.countRows()===i.getHeight();m&&s.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Pi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=s$(r);if(i===a$)return!1;if(i===o$)throw new Error(Pt(KS||(KS=fte([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=ate(i,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var c=o(u),f=XS(c,4),h=f[0],v=f[1],m=f[2],p=f[3],b=tn(h,a)&&tn(v,l)&&tn(m,a)&&tn(p,l);return!b});return s&&(this.clear(),ve(r,function(u){var c=o(u),f=XS(c,4),h=f[0],v=f[1],m=f[2],p=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,v),!1),n.setRangeEnd(n.tableProps.createCellCoords(m,p)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=tn(o,l)&&tn(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=tn(r,o)&&tn(n,o);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(i)}}}]),e}();Be(u$,ei);const mte=u$;var gte=K,c$=Ku,pte=Ur.f,bte=vo,QS=Je,wte=N_,Ste=cr,Ote=D_,JS=c$("".startsWith),Cte=c$("".slice),_te=Math.min,f$=Ote("startsWith"),Tte=!f$&&!!function(){var e=pte(String.prototype,"startsWith");return e&&!e.writable}();gte({target:"String",proto:!0,forced:!Tte&&!f$},{startsWith:function(t){var r=QS(Ste(this));wte(t);var n=bte(_te(arguments.length>1?arguments[1]:void 0,r.length)),i=QS(t);return JS?JS(r,i,n):Cte(r,n,n+i.length)===i}});function eO(e){var t,r,n,i,o="",a;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;t!==r-1&&(o+=`
`)}return o}function ah(e){return Pte(e)||$te(e)||Ete(e)||Rte()}function Rte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ete(e,t){if(e){if(typeof e=="string")return Jd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jd(e,t)}}function $te(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pte(e){if(Array.isArray(e))return Jd(e)}function Jd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lo(e){return lo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lo(e)}function Ite(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ate(n.key),n)}}function kte(e,t,r){return t&&tO(e.prototype,t),r&&tO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ate(e){var t=Mte(e,"string");return lo(t)==="symbol"?t:String(t)}function Mte(e,t){if(lo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xte=function(){function e(t,r,n){Ite(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return kte(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,l=!1;if(typeof n=="function"){var s=sy(r);o=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;o=Math.min(u,n.length)}for(i=0;i<o;i++){var c=l?n(i):n[i];if(Br(c)){if(typeof c.data<"u"){var f=l?a:i;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return aE(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,a=n,l=i,s;return typeof a>"u"&&(a=0,l=""),lo(r)==="object"&&!Array.isArray(r)&&Te(r,function(u,c){u===null?(s=l+c,o.colToPropCache.push(s),o.propToColCache.set(s,a),a+=1):a=o.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&oe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(oe(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?na(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.source,l=o.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),c=u,f=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(c=this.instance.toPhysicalRow(h));var v=this.instance.runHooks("beforeCreateRow",h,i,a);if(v===!1||c===null)return{delta:0};for(var m=this.tableMeta.maxRows,p=this.getSchema().length,b=[],C=function(){var P=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?P=vn(n.getSchema()):(P=[],Yt(p-1,function(){return P.push(null)})):n.instance.dataType==="function"?P=n.tableMeta.dataSchema(h+f):(P={},Y_(P,n.getSchema())),b.push(P),f+=1};f<i&&u+f<m;)C();this.instance.rowIndexMapper.insertIndexes(h,f),s==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,b);var T=this.instance.toVisualRow(c);return this.instance.countSourceRows()===b.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),f>0&&(r==null?this.metaManager.createRow(null,f):a!=="auto"&&this.metaManager.createRow(c,i)),this.instance.runHooks("afterCreateRow",T,f,a),this.instance.forceFullRender=!0,{delta:f,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,a=i.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),f=r;(typeof f!="number"||f>=c)&&(f=c);var h=this.instance.runHooks("beforeCreateCol",f,n,o);if(h===!1)return{delta:0};var v=c;f<this.instance.countCols()&&(v=this.instance.toPhysicalColumn(f));var m=this.instance.countSourceRows(),p=this.instance.countCols(),b=0,C=v;l==="end"&&(C=Math.min(C+1,c));for(var T=C;b<n&&p<u;){if(typeof f!="number"||f>=p)if(m>0)for(var I=0;I<m;I+=1)typeof s[I]>"u"&&(s[I]=[]),s[I].push(null);else s.push([null]);else for(var P=0;P<m;P++)s[P].splice(C,0,null);b+=1,C+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(f,b),b>0&&(r==null?this.metaManager.createColumn(null,b):o!=="auto"&&this.metaManager.createColumn(T,n));var E=this.instance.toVisualColumn(T);return this.instance.runHooks("afterCreateCol",E,b,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:b,startPhysicalIndex:T}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-i,l=this.visualRowsToPhysical(a,i),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,o);if(u===!1)return!1;var c=l.length;if(this.filterData(a,c,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var f=oe(this.tableMeta.columns)||oe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(v,m){return m-v});return h.forEach(function(v){n.metaManager.removeRow(v,1)}),this.instance.runHooks("afterRemoveRow",a,c,l,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),l=a.slice(0).sort(function(T,I){return I-T}),s=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(s===!1)return!1;for(var u=!0,c=l.length,f=this.dataSource,h=0;h<c;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var v=0,m=this.instance.countSourceRows();v<m;v++)f[v].splice(a[0],n),v===0&&this.metaManager.removeColumn(a[0],n);else for(var p=0,b=this.instance.countSourceRows();p<b;p++)for(var C=0;C<c;C++)f[p].splice(l[C],1),p===0&&this.metaManager.removeColumn(l[C],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),a=o.slice(n,n+i),l=o.slice(n+i),s=arguments.length,u=new Array(s>3?s-3:0),c=3;c<s;c++)u[c-3]=arguments[c];zp(u,l);for(var f=0;f<i;)u.push(null),f+=1;return lB(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),a=o.slice(n,n+i),l=o.slice(n+i),s=arguments.length,u=new Array(s>3?s-3:0),c=3;c<s;c++)u[c-3]=arguments[c];zp(u,l);for(var f=0;f<i;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,i){var o=this,a=this.instance.runHooks("beforeDataSplice",r,n,i);if(a!==!1){var l=[].concat(ah(this.dataSource.slice(0,r)),ah(i),ah(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return o.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,l){return i.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var l=null;if(o&&o.hasOwnProperty&&Ii(o,n))l=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=o;if(!u)return null;for(var c=0,f=s.length;c<f;c++)if(u=u[s[c]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=Pi(l);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),a=i,l=this.dataSource[o],s=this.instance.runHooks("modifyRowData",o);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Pi(a);this.instance.runHooks("modifyData",o,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&Ii(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=l,h=0,v;for(h=0,v=c.length-1;h<v;h++)typeof f[c[h]]>"u"&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+r)%i,l=n,s;a<i&&l;)s=this.instance.toPhysicalRow(a),o.push(s),l-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],a=(i+r)%i,l=n;a<i&&l;){var s=this.instance.toPhysicalColumn(a);o.push(s),l-=1,a+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],a,l,s,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),v=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var m=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=v&&m!==null;l++)s.push(f.call(this,a,this.colToProp(l)));m!==null&&o.push(s)}return o}},{key:"getText",value:function(r,n){return eO(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return eO(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const Nte=xte;var rm=Jn("cellTypes"),Dte=rm.register,Hte=rm.getItem,Lte=rm.hasItem;function Fte(e){if(!Lte(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Hte(e)}function jte(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,o=r.validator;n&&lR(e,n),i&&C4(e,i),o&&$4(e,o),Dte(e,t)}function Vte(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Ii(t,e)}function Rc(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?Fte(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Te(t,function(o,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Br(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};Te(n,function(o,a){if(Vte(a,r)){var l;i[a]=o,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),$i(e,i)}}function Wte(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}cB(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Vs(e){return Number.isInteger(e)&&e>=0}function Ws(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function ms(e){return e==null}function ev(e){return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}const h$=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),ki(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),ki(i)===!1)return ev(i)==="object"?(o=this.getCellMeta(t,r),G_(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function tl(e){return tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tl(e)}function rO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rO(Object(r),!0).forEach(function(n){Bte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bte(e,t,r){return t=v$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v$(n.key),n)}}function d$(e,t,r){return t&&iO(e.prototype,t),r&&iO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v$(e){var t=zte(e,"string");return tl(t)==="symbol"?t:String(t)}function zte(e,t){if(tl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ute(){return d$(function e(){y$(this,e)})}var Yte=function(){function e(t){y$(this,e),this.metaCtor=Ute(),this.meta=this.metaCtor.prototype,$i(this.meta,h$()),this.meta.instance=t}return d$(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;$i(this.meta,r),Rc(this.meta,nO(nO({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function rl(e){return rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rl(e)}function Gte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xte(n.key),n)}}function Kte(e,t,r){return t&&oO(e.prototype,t),r&&oO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xte(e){var t=qte(e,"string");return rl(t)==="symbol"?t:String(t)}function qte(e,t){if(rl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zte=function(){function e(t){Gte(this,e);var r=t.getMetaConstructor();this.meta=new r}return Kte(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){$i(this.meta,r),Rc(this.meta,r,r)}}]),e}();function nl(e){return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(e)}function aO(e){return tre(e)||ere(e)||Jte(e)||Qte()}function Qte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jte(e,t){if(e){if(typeof e=="string")return tv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tv(e,t)}}function ere(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tre(e){if(Array.isArray(e))return tv(e)}function tv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ire(n.key),n)}}function nre(e,t,r){return t&&lO(e.prototype,t),r&&lO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ire(e){var t=ore(e,"string");return nl(t)==="symbol"?t:String(t)}function ore(e,t){if(nl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rv=function(e){function t(r){rre(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return nre(t,[{key:"obtain",value:function(n){Ws(function(){return Vs(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ws(function(){return Vs(n)||ms(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],a=this.data.length,l=0;l<i;l++)o.push(a+l),this.data.push(void 0);var s=ms(n)?this.index.length:n;this.index=[].concat(aO(this.index.slice(0,s)),o,aO(this.index.slice(s)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ws(function(){return Vs(n)||ms(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(ms(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var l=o[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return ly(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function il(e){return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(e)}function are(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sre(n.key),n)}}function lre(e,t,r){return t&&sO(e.prototype,t),r&&sO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sre(e){var t=ure(e,"string");return il(t)==="symbol"?t:String(t)}function ure(e,t){if(il(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cre=["data","width"],fre=function(){function e(t){var r=this;are(this,e),this.globalMeta=t,this.metas=new rv(function(){return r._createMeta()})}return lre(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);$i(i,n),Rc(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return Wte(this.globalMeta.getMetaConstructor(),cre).prototype}}]),e}();function ol(e){return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function hre(e){return mre(e)||yre(e)||vre(e)||dre()}function dre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vre(e,t){if(e){if(typeof e=="string")return nv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nv(e,t)}}function yre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mre(e){if(Array.isArray(e))return nv(e)}function nv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bre(n.key),n)}}function pre(e,t,r){return t&&uO(e.prototype,t),r&&uO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bre(e){var t=wre(e,"string");return ol(t)==="symbol"?t:String(t)}function wre(e,t){if(ol(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sre=function(){function e(t){var r=this;gre(this,e),this.columnMeta=t,this.metas=new rv(function(){return r._createRow()})}return pre(e,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);$i(o,i),Rc(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(i),l[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,hre(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){Ws(function(){return Vs(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new rv(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function al(e){return al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},al(e)}function Ore(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_re(n.key),n)}}function Cre(e,t,r){return t&&cO(e.prototype,t),r&&cO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _re(e){var t=Tre(e,"string");return al(t)==="symbol"?t:String(t)}function Tre(e,t){if(al(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(al(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m$=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Ore(this,e),this.hot=t,this.globalMeta=new Yte(t),this.tableMeta=new Zte(this.globalMeta),this.columnMeta=new fre(this.globalMeta),this.cellMeta=new Sre(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return Cre(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,a=i.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=o,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();Be(m$,ei);function Lu(e){return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function fO(e,t,r,n){var i=n.hotInstance,o=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,c=n.firstRun,f=Py(l),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":ke(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(f),e,c,s);var v=new Nte(i,e,u);if(t(v),Lu(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var m=v.getSchema();e=[];var p,b=0,C=0;for(b=0,C=h.startRows;b<C;b++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)p=vn(m),e.push(p);else if(i.dataType==="array")p=vn(m[0]),e.push(p);else{p=[];for(var T=0,I=h.startCols;T<I;T++)p.push(null);e.push(p)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Lu(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),h.data=e,v.dataSource=e,a.data=e,a.dataType=i.dataType,a.colToProp=v.colToProp.bind(v),a.propToCol=v.propToCol.bind(v),a.countCachedColumns=v.countCachedColumns.bind(v),r(v),i.runHooks("after".concat(f),e,c,s),c||(i.runHooks("afterChange",null,l),i.render())}function ll(e){return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}function Rre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$re(n.key),n)}}function Ere(e,t,r){return t&&hO(e.prototype,t),r&&hO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $re(e){var t=Pre(e,"string");return ll(t)==="symbol"?t:String(t)}function Pre(e,t){if(ll(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ire=function(){function e(t){var r=this;Rre(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Nt.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return Ere(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var c=Ii(r,"type")?r.type:null,f=ke(r.cells)?r.cells(i,o,u):null;if(c)if(f){var h;f.type=(h=f.type)!==null&&h!==void 0?h:c}else f={type:c};f&&this.metaManager.updateCellMeta(i,o,f),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),e}();function sl(e){return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}function kre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mre(n.key),n)}}function Are(e,t,r){return t&&dO(e.prototype,t),r&&dO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mre(e){var t=xre(e,"string");return sl(t)==="symbol"?t:String(t)}function xre(e,t){if(sl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nre=function(){function e(t){kre(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Are(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof o=="string",u=s?o:i,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,c,l),s&&r.installPropWatcher(o,c,l)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),vO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),gs=function(t){return t.map(function(r){var n=r.toLowerCase();return vO.has(n)?vO.get(n):n}).sort().join("+")},Dre=function(t){return t.split("+")},yO=function(t){return t.toLowerCase()},mO;function Hre(e){return jre(e)||Fre(e)||g$(e)||Lre()}function Lre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jre(e){if(Array.isArray(e))return iv(e)}function Vre(e,t){return zre(e)||Bre(e,t)||g$(e,t)||Wre()}function Wre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g$(e,t){if(e){if(typeof e=="string")return iv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iv(e,t)}}function iv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function zre(e){if(Array.isArray(e))return e}function Ure(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Yre=function(t){var r=Oc({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,h=c.callback,v=c.group,m=c.runOnlyIf,p=m===void 0?function(){return!0}:m,b=c.captureCtrl,C=b===void 0?!1:b,T=c.preventDefault,I=T===void 0?!0:T,P=c.stopPropagation,E=P===void 0?!1:P,q=c.relativeToGroup,Y=c.position;if(bt(v))throw new Error("You need to define the shortcut's group.");if(ke(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(Pt(mO||(mO=Ure([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var ne={callback:h,group:v,runOnlyIf:p,captureCtrl:C,preventDefault:I,stopPropagation:E};if(oe(q)){var me=[q,Y];ne.relativeToGroup=me[0],ne.position=me[1]}f.forEach(function(dt){var et=gs(dt),ze=r.hasItem(et);if(ze){var ie=r.getItem(et),Pe=ie.findIndex(function(Ke){return Ke.group===q});Pe!==-1?Y==="before"?Pe-=1:Pe+=1:Pe=ie.length,ie.splice(Pe,0,ne)}else r.addItem(et,[ne])})},i=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(h){Te(f,function(v,m){Object.prototype.hasOwnProperty.call(h,m)===!1&&(h[m]=f[m])}),n(h)})},o=function(c){var f=gs(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(h){var v=Vre(h,2),m=v[0],p=v[1],b=p.filter(function(C){return C.group!==c});b.length===0?o(Dre(m)):(p.length=0,p.push.apply(p,Hre(b)))})},l=function(c){var f=gs(c),h=r.getItem(f);return oe(h)?h.slice():[]},s=function(c){var f=gs(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:i,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:o,removeShortcutsByGroup:a}};function Gre(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var Kre=["meta","alt","shift","control"],Vo=Gre();function Xre(e,t,r,n,i){var o=function(v){return Kre.includes(v)},a=function(v){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=[];return v.altKey&&p.push("alt"),m&&(v.ctrlKey||v.metaKey)?p.push("control/meta"):(v.ctrlKey&&p.push("control"),v.metaKey&&p.push("meta")),v.shiftKey&&p.push("shift"),p},l=function(v){if(t(v)!==!1){var m=r(v);if(!(v.keyCode===229||m===!1||mi(v))){var p=yO(v.key),b=[];o(p)?Vo.press(p):b=a(v);var C=[p].concat(b),T=i(v,C);!T&&(Kp()&&b.includes("meta")||!Kp()&&b.includes("control"))&&i(v,[p].concat(a(v,!0))),n(v)}}},s=function(v){if(t(v)!==!1){var m=yO(v.key);o(m)!==!1&&Vo.release(m)}},u=function(){Vo.releaseAll()},c=function(){for(var v=e;v;)v.document.documentElement.addEventListener("keydown",l),v.document.documentElement.addEventListener("keyup",s),v.document.documentElement.addEventListener("blur",u),v=bb(v)},f=function(){for(var v=e;v;)v.document.documentElement.removeEventListener("keydown",l),v.document.documentElement.removeEventListener("keyup",s),v.document.documentElement.removeEventListener("blur",u),v=bb(v)};return{mount:c,unmount:f,isPressed:function(v){return Vo.isPressed(v)},releasePressedKeys:function(){return Vo.releaseAll()}}}var qre=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,o=t.afterKeyDown,a=Oc({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),l="grid",s=function(p){var b=Yre(p);return a.addItem(p,b),b},u=function(){return l},c=function(p){return a.getItem(p)},f=function(p){l=p},h=!1,v=Xre(r,n,i,o,function(m,p){var b=c(u()),C=!1;if(!b.hasShortcut(p))return C;for(var T=b.getShortcuts(p),I=0;I<T.length;I++){var P=T[I],E=P.callback,q=P.runOnlyIf,Y=P.preventDefault,ne=P.stopPropagation,me=P.captureCtrl;if(q(m)!==!1&&(h=me,C=E(m,p)===!1,h=!1,Y&&m.preventDefault(),ne&&m.stopPropagation(),C))break}return C});return v.mount(),{addContext:s,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!h&&(v.isPressed("control")||v.isPressed("meta"))},releasePressedKeys:function(){return v.releasePressedKeys()},destroy:function(){return v.unmount()}}},gO,pO;function _t(e){return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(e)}function bO(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Sr(e,t){return Jre(e)||Qre(e,t)||p$(e,t)||Zre()}function Zre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function Jre(e){if(Array.isArray(e))return e}function hi(e){return rne(e)||tne(e)||p$(e)||ene()}function ene(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p$(e,t){if(e){if(typeof e=="string")return ov(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ov(e,t)}}function tne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rne(e){if(Array.isArray(e))return ov(e)}function ov(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nne="gridDefault",lh=null,ps=new Set;function b$(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,a=this,l=new Dl(a),s,u,c,f,h=!0;wq(i)&&bq(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var v=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",m=["rtl","ltr"].includes(v)?v:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=bJ(t.language);var p=new m$(a,t,[Ire,Nre]),b=p.getTableMeta(),C=p.getGlobalMeta(),T=Oc();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Dd(this)&&bG(t.licenseKey,e),this.guid="ht_".concat(zT()),this.columnIndexMapper=new Kd,this.rowIndexMapper=new Kd,u=new Wq(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var I=function(y){var g=y.row,w=y.col;return a._createCellCoords(g>=0?a.rowIndexMapper.getRenderableFromVisualIndex(g):g,w>=0?a.columnIndexMapper.getRenderableFromVisualIndex(w):w)},P=function(y){var g=y.row,w=y.col;return a._createCellCoords(g>=0?a.rowIndexMapper.getVisualFromRenderableIndex(g):g,w>=0?a.columnIndexMapper.getVisualFromRenderableIndex(w):w)},E=new mte(b,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(y){return s.propToCol(y)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(y,g){return a._createCellCoords(y,g)},createCellRange:function(y,g,w){return a._createCellRange(y,g,w)},visualToRenderableCoords:I,renderableToVisualCoords:P,isDisabledCellSelection:function(y,g){return a.getCellMeta(y,g).disableVisualSelection}});this.selection=E;var q=function(y){var g=y.hiddenIndexesChanged;g&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",q),this.rowIndexMapper.addLocalHook("cacheUpdated",q),this.selection.addLocalHook("beforeSetRangeStart",function(d){n.runHooks("beforeSetRangeStart",d)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(d){n.runHooks("beforeSetRangeStartOnly",d)}),this.selection.addLocalHook("beforeSetRangeEnd",function(d){n.runHooks("beforeSetRangeEnd",d),d.row<0&&(d.row=n.view._wt.wtTable.getFirstVisibleRow()),d.col<0&&(d.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(d){var y=Pi(!1),g=n.selection.getSelectedRange(),w=g.current(),S=w.from,_=w.to,R=g.size()-1;n.runHooks("afterSelection",S.row,S.col,_.row,_.col,y,R),n.runHooks("afterSelectionByProp",S.row,a.colToProp(S.col),_.row,a.colToProp(_.col),y,R);var $=n.selection.isSelectedByAnyHeader(),k=n.selection.selectedRange.current(),H=!0;o&&(H=!1),y.isTouched()&&(H=!y.value);var N=n.selection.isSelectedByRowHeader(),B=n.selection.isSelectedByColumnHeader();H!==!1&&($?N?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(d.row)):B&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(d.col)):k&&!n.selection.isMultiple()?n.view.scrollViewport(I(k.from)):n.view.scrollViewport(I(d))),N&&B?he(n.rootElement,["ht__selection--rows","ht__selection--columns"]):N?(Ue(n.rootElement,"ht__selection--columns"),he(n.rootElement,"ht__selection--rows")):B?(Ue(n.rootElement,"ht__selection--rows"),he(n.rootElement,"ht__selection--columns")):Ue(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(d){var y=d.length-1,g=d[y],w=g.from,S=g.to;n.runHooks("afterSelectionEnd",w.row,w.col,S.row,S.col,y),n.runHooks("afterSelectionEndByProp",w.row,a.colToProp(w.col),S.row,a.colToProp(S.col),y)}),this.selection.addLocalHook("afterIsMultipleSelection",function(d){var y=n.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=y)}),this.selection.addLocalHook("beforeModifyTransformStart",function(d){n.runHooks("modifyTransformStart",d)}),this.selection.addLocalHook("afterModifyTransformStart",function(d,y,g){n.runHooks("afterModifyTransformStart",d,y,g)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(d){n.runHooks("modifyTransformEnd",d)}),this.selection.addLocalHook("afterModifyTransformEnd",function(d,y,g){n.runHooks("afterModifyTransformEnd",d,y,g)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),Ue(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(d){n.alter("insert_row_above",d,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(d){n.alter("insert_col_start",d,1,"auto")}),c={alter:function(y,g){var w,S,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=arguments.length>3?arguments[3]:void 0,$=arguments.length>4?arguments[4]:void 0,k=function(xt){if(xt.length===0)return[];var nt=hi(xt);nt.sort(function(pe,de){var ae=Sr(pe,1),_e=ae[0],yt=Sr(de,1),mt=yt[0];return _e===mt?0:_e>mt?1:-1});var lt=lc(nt,function(pe,de){var ae=Sr(de,2),_e=ae[0],yt=ae[1],mt=pe[pe.length-1],gt=Sr(mt,2),gr=gt[0],pn=gt[1],Zr=gr+pn;if(_e<=Zr){var ti=Math.max(yt-(Zr-_e),0);mt[1]+=ti}else pe.push([_e,yt]);return pe},[nt[0]]);return lt};switch(y){case"insert_row":ps.has(y)||(ps.add(y),Ln(Pt(gO||(gO=bO(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),y)));case"insert_row_below":case"insert_row_above":var H=a.countSourceRows();if(b.maxRows===H)return;var N=y==="insert_row_below"?"below":"above";g=(w=g)!==null&&w!==void 0?w:y==="insert_row"||N==="below"?H:0;var B=s.createRow(g,_,{source:R,mode:N}),te=B.delta,z=B.startPhysicalIndex;if(te){var G=E.selectedRange.current(),se=G==null?void 0:G.from,ge=se==null?void 0:se.row,He=a.toVisualRow(z);if(E.isSelectedByCorner())a.selectAll();else if(oe(ge)&&ge>=He){var we=G.to,Se=we.row,We=we.col,Xe=se.col;E.isSelectedByRowHeader()&&(Xe=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(ge+te,Xe),!0),E.setRangeEnd(a._createCellCoords(Se+te,We))}else a._refreshBorders()}break;case"insert_col":ps.has(y)||(ps.add(y),Ln(Pt(pO||(pO=bO(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),y)));case"insert_col_start":case"insert_col_end":var er=y==="insert_col_end"?"end":"start";g=(S=g)!==null&&S!==void 0?S:y==="insert_col"||er==="end"?a.countSourceCols():0;var Vt=s.createCol(g,_,{source:R,mode:er}),at=Vt.delta,At=Vt.startPhysicalIndex;if(at){if(Array.isArray(b.colHeaders)){var tt=[a.toVisualColumn(At),0];tt.length+=at,Array.prototype.splice.apply(b.colHeaders,tt)}var rt=E.selectedRange.current(),hr=rt==null?void 0:rt.from,qr=hr==null?void 0:hr.col,gn=a.toVisualColumn(At);if(E.isSelectedByCorner())a.selectAll();else if(oe(qr)&&qr>=gn){var dr=rt.to,vr=dr.row,Wt=dr.col,yr=hr.row;E.isSelectedByColumnHeader()&&(yr=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(yr,qr+at),!0),E.setRangeEnd(a._createCellCoords(vr,Wt+at))}else a._refreshBorders()}break;case"remove_row":var vt=function(xt){var nt=0;ve(xt,function(lt){var pe=Sr(lt,2),de=pe[0],ae=pe[1],_e=ki(de)?a.countRows()-1:Math.max(de-nt,0);Number.isInteger(de)&&(de=Math.max(de-nt,0));var yt=s.removeRow(de,ae,R);if(yt){var mt=a.countRows(),gt=b.fixedRowsTop;gt>=_e+1&&(b.fixedRowsTop-=Math.min(ae,gt-_e));var gr=b.fixedRowsBottom;gr&&_e>=mt-gr&&(b.fixedRowsBottom-=Math.min(ae,gr)),nt+=ae}})};Array.isArray(g)?vt(k(g)):vt([[g,_]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var Mt=function(xt){var nt=0;ve(xt,function(lt){var pe=Sr(lt,2),de=pe[0],ae=pe[1],_e=ki(de)?a.countCols()-1:Math.max(de-nt,0),yt=a.toPhysicalColumn(_e);Number.isInteger(de)&&(de=Math.max(de-nt,0));var mt=s.removeCol(de,ae,R);if(mt){var gt=b.fixedColumnsStart;gt>=_e+1&&(b.fixedColumnsStart-=Math.min(ae,gt-_e)),Array.isArray(b.colHeaders)&&(typeof yt>"u"&&(yt=-1),b.colHeaders.splice(yt,ae)),nt+=ae}})};Array.isArray(g)?Mt(k(g)):Mt([[g,_]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(y,'"'))}$||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var y=b.minRows,g=b.minSpareRows,w=b.minCols,S=b.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&E.deselect(),y){var _=a.countRows();_<y&&s.createRow(_,y-_,{source:"auto"})}if(g){var R=a.countEmptyRows(!0);if(R<g){var $=g-R,k=Math.min($,b.maxRows-a.countSourceRows());s.createRow(a.countRows(),k,{source:"auto"})}}{var H;(w||S)&&(H=a.countEmptyCols(!0));var N=a.countCols();if(w&&!b.columns&&N<w){var B=w-N;H+=B,s.createCol(N,B,{source:"auto"})}if(S&&!b.columns&&a.dataType==="array"&&H<S){N=a.countCols();var te=S-H,z=Math.min(te,b.maxCols-N);s.createCol(N,z,{source:"auto"})}}if(E.isSelected()){var G=a.countRows(),se=a.countCols();ve(E.selectedRange,function(ge){var He=!1,we=ge.from.row,Se=ge.from.col,We=ge.to.row,Xe=ge.to.col;we>G-1?(we=G-1,He=!0,We>we&&(We=we)):We>G-1&&(We=G-1,He=!0,we>We&&(we=We)),Se>se-1?(Se=se-1,He=!0,Xe>Se&&(Xe=Se)):Xe>se-1&&(Xe=se-1,He=!0,Se>Xe&&(Se=Xe)),He&&a.selectCell(we,Se,We,Xe)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(y,g,w,S,_,R,$){var k,H,N,B,te=[],z={},G=[],se=y.row,ge=y.col;if(H=g.length,H===0)return!1;var He=0,we=0;switch(Br(w)&&(He=w.col-ge+1,we=w.row-se+1),_){case"shift_down":var Se=Tf(g),We=Se.length,Xe=Math.max(We,He),er=a.getData().slice(se),Vt=Tf(er).slice(ge,ge+Xe);for(N=0;N<Xe;N+=1)if(N<We){for(k=0,H=Se[N].length;k<we-H;k+=1)Se[N].push(Se[N][k%H]);N<Vt.length?G.push(Se[N].concat(Vt[N])):G.push(Se[N].concat(new Array(er.length).fill(null)))}else G.push(Se[N%We].concat(Vt[N]));a.populateFromArray(se,ge,Tf(G));break;case"shift_right":var at=g.length,At=Math.max(at,we),tt=a.getData().slice(se).map(function(gt){return gt.slice(ge)});for(k=0;k<At;k+=1)if(k<at){for(N=0,B=g[k].length;N<He-B;N+=1)g[k].push(g[k][N%B]);if(k<tt.length)for(var rt=0;rt<tt[k].length;rt+=1)g[k].push(tt[k][rt]);else{var hr;(hr=g[k]).push.apply(hr,hi(new Array(tt[0].length).fill(null)))}}else g.push(g[k%H].slice(0,At).concat(tt[k]));a.populateFromArray(se,ge,g);break;case"overwrite":default:z.row=y.row,z.col=y.col;var qr={row:w&&y?w.row-y.row+1:1,col:w&&y?w.col-y.col+1:1},gn=0,dr=0,vr=!0,Wt,yr=function(gr){var pn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Zr=g[gr%g.length];return pn!==null?Zr[pn%Zr.length]:Zr},vt=g.length,Mt=w?w.row-y.row+1:0;for(w?H=Mt:H=Math.max(vt,Mt),k=0;k<H&&!(w&&z.row>w.row&&Mt>vt||!b.allowInsertRow&&z.row>a.countRows()-1||z.row>=b.maxRows);k++){var mr=k-gn,xt=yr(mr).length,nt=w?w.col-y.col+1:0;if(w?B=nt:B=Math.max(xt,nt),z.col=y.col,Wt=a.getCellMeta(z.row,z.col),(S==="CopyPaste.paste"||S==="Autofill.fill")&&Wt.skipRowOnPaste){gn+=1,z.row+=1,H+=1;continue}for(dr=0,N=0;N<B&&!(w&&z.col>w.col&&nt>xt||!b.allowInsertColumn&&z.col>a.countCols()-1||z.col>=b.maxCols);N++){if(Wt=a.getCellMeta(z.row,z.col),(S==="CopyPaste.paste"||S==="Autofill.fill")&&Wt.skipColumnOnPaste){dr+=1,z.col+=1,B+=1;continue}if(Wt.readOnly&&S!=="UndoRedo.undo"){z.col+=1;continue}var lt=N-dr,pe=yr(mr,lt),de=a.getDataAtCell(z.row,z.col),ae={row:mr,col:lt};if(S==="Autofill.fill"){var _e=a.runHooks("beforeAutofillInsidePopulate",ae,R,g,$,{},qr);_e&&(pe=bt(_e.value)?pe:_e.value)}if(pe!==null&&_t(pe)==="object")if(Array.isArray(pe)&&de===null&&(de=[]),de===null||_t(de)!=="object")vr=!1;else{var yt=na(Array.isArray(de)?de:de[0]||de),mt=na(Array.isArray(pe)?pe:pe[0]||pe);G_(yt,mt)||Array.isArray(yt)&&Array.isArray(mt)?pe=vn(pe):vr=!1}else de!==null&&_t(de)==="object"&&(vr=!1);vr&&te.push([z.row,z.col,pe]),vr=!0,z.col+=1}z.row+=1}a.setDataAtCell(te,null,null,S||"populateFromArray");break}}};function Y(d){var y=CE(d);Zy(y)?(a.runHooks("beforeLanguageChange",y),C.language=y,a.runHooks("afterLanguageChange",y)):_E(d)}function ne(d,y){var g=d==="className"?a.rootElement:a.table;if(h)he(g,y);else{var w=[],S=[];C[d]&&(w=Array.isArray(C[d])?C[d]:Yp(C[d])),y&&(S=Array.isArray(y)?y:Yp(y));var _=Up(w,S),R=Up(S,w);_.length&&Ue(g,_),R.length&&he(g,R)}C[d]=y}this.init=function(){u.setData(b.data),a.runHooks("beforeInit"),(Pn()||SB())&&he(a.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new xq(this),f=W3.getInstance(a,b,E),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&DG(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),_t(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function me(){var d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function dt(d){var y=d.replace(",",".");return isNaN(parseFloat(y))===!1?parseFloat(y):d}function et(d,y,g){if(d.length){var w=a.getActiveEditor(),S=a.runHooks("beforeChange",d,y||"edit"),_=!0;if(S===!1){w&&w.cancelChanges();return}var R=new me;R.onQueueEmpty=function(G){w&&_&&w.cancelChanges(),g(G)};for(var $=d.length-1;$>=0;$--)if(d[$]===null)d.splice($,1);else{var k=Sr(d[$],4),H=k[0],N=k[1],B=k[3],te=s.propToCol(N),z=a.getCellMeta(H,te);z.type==="numeric"&&typeof B=="string"&&AK(B)&&(d[$][3]=dt(B)),a.getCellValidator(z)&&(R.addValidatorToQueue(),a.validateCell(d[$][3],z,function(G,se){return function(ge){if(typeof ge!="boolean")throw new Error("Validation error: result is not boolean");if(ge===!1&&se.allowInvalid===!1){_=!1,d.splice(G,1),se.valid=!0;var He=a.getCell(se.visualRow,se.visualCol);He!==null&&Ue(He,b.invalidCellClassName)}R.removeValidatorFormQueue()}}($,z),y))}R.checkIfQueueIsEmpty()}}function ze(d,y){var g=d.length-1;if(!(g<0)){for(;g>=0;g--){var w=!1;if(d[g]===null){d.splice(g,1);continue}if(!((d[g][2]===null||d[g][2]===void 0)&&(d[g][3]===null||d[g][3]===void 0))){if(b.allowInsertRow)for(;d[g][0]>a.countRows()-1;){var S=s.createRow(void 0,void 0,{source:y}),_=S.delta;if(_===0){w=!0;break}}if(a.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;s.propToCol(d[g][1])>a.countCols()-1;){var R=s.createCol(void 0,void 0,{source:y}),$=R.delta;if($===0){w=!0;break}}w||s.set(d[g][0],d[g][1],d[g][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",d,y),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",d,y||"edit");var k=a.getActiveEditor();k&&oe(k.refreshValue)&&k.refreshValue()}}this._createCellCoords=function(d,y){return a.view._wt.createCellCoords(d,y)},this._createCellRange=function(d,y,g){return a.view._wt.createCellRange(d,y,g)},this.validateCell=function(d,y,g,w){var S=a.getCellValidator(y);function _(R){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!$||y.hidden===!0){g(R);return}var k=y.visualCol,H=y.visualRow,N=a.getCell(H,k,!0);if(N&&N.nodeName!=="TH"){var B=a.rowIndexMapper.getRenderableFromVisualIndex(H),te=a.columnIndexMapper.getRenderableFromVisualIndex(k);a.view._wt.getSetting("cellRenderer",B,te,N)}g(R)}mG(S)&&(S=function(R){return function($,k){k(R.test($))}}(S)),ke(S)?(d=a.runHooks("beforeValidate",d,y.visualRow,y.prop,w),a._registerImmediate(function(){S.call(y,d,function(R){a&&(R=a.runHooks("afterValidate",R,d,y.visualRow,y.prop,w),y.valid=R,_(R),a.runHooks("postAfterValidate",R,d,y.visualRow,y.prop,w))})})):a._registerImmediate(function(){y.valid=!0,_(y.valid,!1)})};function ie(d,y,g){return Array.isArray(d)?d:[[d,y,g]]}this.setDataAtCell=function(d,y,g,w){var S=ie(d,y,g),_=[],R=w,$,k,H;for($=0,k=S.length;$<k;$++){if(_t(S[$])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof S[$][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");S[$][1]>=this.countCols()?H=S[$][1]:H=s.colToProp(S[$][1]),_.push([S[$][0],H,u.getAtCell(this.toPhysicalRow(S[$][0]),S[$][1]),S[$][2]])}!R&&_t(d)==="object"&&(R=y),a.runHooks("afterSetDataAtCell",_,R),et(_,R,function(){ze(_,R)})},this.setDataAtRowProp=function(d,y,g,w){var S=ie(d,y,g),_=[],R=w,$,k;for($=0,k=S.length;$<k;$++)_.push([S[$][0],S[$][1],u.getAtCell(this.toPhysicalRow(S[$][0]),S[$][1]),S[$][2]]);!R&&_t(d)==="object"&&(R=y),a.runHooks("afterSetDataAtRowProp",_,R),et(_,R,function(){ze(_,R)})},this.listen=function(){a&&!a.isListening()&&(lh=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(lh=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return lh===a.guid},this.destroyEditor=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(d,y)},this.populateFromArray=function(d,y,g,w,S,_,R,$,k){if(!(_t(g)==="object"&&_t(g[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var H=typeof w=="number"?a._createCellCoords(w,S):null;return c.populateFromArray(a._createCellCoords(d,y),g,H,_,R,$,k)},this.spliceCol=function(d,y,g){for(var w,S=arguments.length,_=new Array(S>3?S-3:0),R=3;R<S;R++)_[R-3]=arguments[R];return(w=s).spliceCol.apply(w,[d,y,g].concat(_))},this.spliceRow=function(d,y,g){for(var w,S=arguments.length,_=new Array(S>3?S-3:0),R=3;R<S;R++)_[R-3]=arguments[R];return(w=s).spliceRow.apply(w,[d,y,g].concat(_))},this.getSelected=function(){if(E.isSelected())return Dn(E.getSelectedRange(),function(d){var y=d.from,g=d.to;return[y.row,y.col,g.row,g.col]})},this.getSelectedLast=function(){var d=this.getSelected(),y;return d&&d.length>0&&(y=d[d.length-1]),y},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){var d=this.getSelectedRange(),y;return d&&d.length>0&&(y=d[d.length-1]),y},this.emptySelectedCells=function(d){var y=this;if(!(!E.isSelected()||this.countRows()===0||this.countCols()===0)){var g=[];ve(E.getSelectedRange(),function(w){var S=w.getTopStartCorner(),_=w.getBottomEndCorner();Yt(S.row,_.row,function(R){Yt(S.col,_.col,function($){y.getCellMeta(R,$).readOnly||g.push([R,$,null])})})}),g.length>0&&this.setDataAtCell(g,d)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(d){this.suspendRender();var y=d();return this.resumeRender(),y},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(y,0),(!this.isExecutionSuspended()&&y===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var g=d();return this.resumeExecution(y),g},this.batch=function(d){this.suspendRender(),this.suspendExecution();var y=d();return this.resumeExecution(),this.resumeRender(),y},this.refreshDimensions=function(){if(a.view){var d=a.view.getLastSize(),y=d.width,g=d.height,w=a.rootElement.getBoundingClientRect(),S=w.width,_=w.height,R=S!==y||_!==g,$=a.runHooks("beforeRefreshDimensions",{width:y,height:g},{width:S,height:_},R)===!1;$||((R||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(S,_),a.render()),a.runHooks("afterRefreshDimensions",{width:y,height:g},{width:S,height:_},R))}},this.updateData=function(d,y){var g=this;fO(d,function(w){s=w},function(w){s=w,a.columnIndexMapper.fitToLength(g.getInitialColumnCount()),a.rowIndexMapper.fitToLength(g.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:y,metaManager:p,firstRun:h})},this.loadData=function(d,y){fO(d,function(g){s=g},function(){p.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:y,metaManager:p,firstRun:h})},this.getInitialColumnCount=function(){var d=b.columns,y=0;if(Array.isArray(d))y=d.length;else if(ke(d))if(a.dataType==="array")for(var g=this.countSourceCols(),w=0;w<g;w+=1)d(w)&&(y+=1);else(a.dataType==="object"||a.dataType==="function")&&(y=s.colToPropCache.length);else if(oe(b.dataSchema)){var S=s.getSchema();y=Array.isArray(S)?S.length:sy(S)}else y=this.countSourceCols();return y},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,y,g,w){return bt(d)?s.getAll():s.getRange(a._createCellCoords(d,y),a._createCellCoords(g,w),s.DESTINATION_RENDERER)},this.getCopyableText=function(d,y,g,w){return s.getCopyableText(a._createCellCoords(d,y),a._createCellCoords(g,w))},this.getCopyableData=function(d,y){return s.getCopyable(d,s.colToProp(y))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=(h?a.loadData:a.updateData).bind(this),w=!1,S,_;if(oe(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(oe(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(oe(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(S in d)S==="data"||(S==="language"?Y(d.language):S==="className"?ne("className",d.className):S==="tableClassName"&&a.table?(ne("tableClassName",d.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Nt.getSingleton().isRegistered(S)||Nt.getSingleton().isDeprecated(S)?(ke(d[S])||Array.isArray(d[S]))&&(d[S].initialHook=!0,a.addHook(S,d[S])):!y&&Ii(d,S)&&(C[S]=d[S]));d.data===void 0&&b.data===void 0?g(null,"updateSettings"):d.data!==void 0?g(d.data,"updateSettings"):d.columns!==void 0&&(s.createMap(),a.initIndexMappers());var R=a.countCols(),$=b.columns;if($&&ke($)&&(w=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&p.clearCache(),R>0)for(S=0,_=0;S<R;S++){if($){var k=w?$(S):$[_];k&&p.updateColumnMeta(_,k)}_+=1}oe(d.cell)&&Te(d.cell,function(G){a.setCellMetaObject(G.row,G.col,G)}),a.runHooks("afterCellMetaReset");var H=a.rootElement.style.height;H!==""&&(H=parseInt(a.rootElement.style.height,10));var N=d.height;if(ke(N)&&(N=N()),y){var B=a.rootElement.getAttribute("style");B&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(N===null){var te=a.rootElement.getAttribute("data-initialstyle");te&&(te.indexOf("height")>-1||te.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",te):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else N!==void 0&&(a.rootElement.style.height=isNaN(N)?"".concat(N):"".concat(N,"px"),a.rootElement.style.overflow="hidden");if(typeof d.width<"u"){var z=d.width;ke(z)&&(z=z()),a.rootElement.style.width=isNaN(z)?"".concat(z):"".concat(z,"px")}y||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!y&&a.view&&(H===""||N===""||N===void 0)&&H!==N&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var d=a.getSelectedLast();if(b.getValue){if(ke(b.getValue))return b.getValue.call(a);if(d)return a.getData()[d[0][0]][b.getValue]}else if(d)return a.getDataAtCell(d[0],d[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,y,g,w,S){c.alter(d,y,g,w,S)},this.getCell=function(d,y){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,w=y,S=d;if(y>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(y)))return null;w=this.columnIndexMapper.getRenderableFromVisualIndex(y)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;S=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return S===null||w===null?null:a.view.getCellAtCoords(a._createCellCoords(S,w),g)},this.getCoords=function(d){var y=this.view._wt.wtTable.getCoords(d);if(y===null)return null;var g=y.row,w=y.col,S=g,_=w;return g>=0&&(S=this.rowIndexMapper.getVisualFromRenderableIndex(g)),w>=0&&(_=this.columnIndexMapper.getVisualFromRenderableIndex(w)),a._createCellCoords(S,_)},this.colToProp=function(d){return s.colToProp(d)},this.propToCol=function(d){return s.propToCol(d)},this.toVisualRow=function(d){return n.rowIndexMapper.getVisualFromPhysicalIndex(d)},this.toVisualColumn=function(d){return n.columnIndexMapper.getVisualFromPhysicalIndex(d)},this.toPhysicalRow=function(d){return n.rowIndexMapper.getPhysicalFromVisualIndex(d)},this.toPhysicalColumn=function(d){return n.columnIndexMapper.getPhysicalFromVisualIndex(d)},this.getDataAtCell=function(d,y){return s.get(d,s.colToProp(y))},this.getDataAtRowProp=function(d,y){return s.get(d,y)},this.getDataAtCol=function(d){for(var y=[],g=s.getRange(a._createCellCoords(0,d),a._createCellCoords(b.data.length-1,d),s.DESTINATION_RENDERER),w=0;w<g.length;w+=1)for(var S=0;S<g[w].length;S+=1)y.push(g[w][S]);return y},this.getDataAtProp=function(d){for(var y=[],g=s.getRange(a._createCellCoords(0,s.propToCol(d)),a._createCellCoords(b.data.length-1,s.propToCol(d)),s.DESTINATION_RENDERER),w=0;w<g.length;w+=1)for(var S=0;S<g[w].length;S+=1)y.push(g[w][S]);return y},this.getSourceData=function(d,y,g,w){var S;return d===void 0?S=u.getData():S=u.getByRange(a._createCellCoords(d,y),a._createCellCoords(g,w)),S},this.getSourceDataArray=function(d,y,g,w){var S;return d===void 0?S=u.getData(!0):S=u.getByRange(a._createCellCoords(d,y),a._createCellCoords(g,w),!0),S},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,y,g,w){var S=ie(d,y,g),_=this.hasHook("afterSetSourceDataAtCell"),R=[];_&&ve(S,function(k){var H=Sr(k,3),N=H[0],B=H[1],te=H[2];R.push([N,B,u.getAtCell(N,B),te])}),ve(S,function(k){var H=Sr(k,3),N=H[0],B=H[1],te=H[2];u.setAtCell(N,B,te)}),_&&this.runHooks("afterSetSourceDataAtCell",R,w),this.render();var $=a.getActiveEditor();$&&oe($.refreshValue)&&$.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,y){return u.getAtCell(d,y)},this.getDataAtRow=function(d){var y=s.getRange(a._createCellCoords(d,0),a._createCellCoords(d,this.countCols()-1),s.DESTINATION_RENDERER);return y[0]||[]},this.getDataType=function(d,y,g,w){var S=this,_=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,y,g,w],R=_[0],$=_[1],k=_[2],H=_[3],N=null,B=null;k===void 0&&(k=R),H===void 0&&(H=$);var te="mixed";return Yt(Math.max(Math.min(R,k),0),Math.max(R,k),function(z){var G=!0;return Yt(Math.max(Math.min($,H),0),Math.max($,H),function(se){var ge=S.getCellMeta(z,se);return B=ge.type,N?G=N===B:N=B,G}),te=G?B:"mixed",G}),te},this.removeCellMeta=function(d,y,g){var w=[this.toPhysicalRow(d),this.toPhysicalColumn(y)],S=w[0],_=w[1],R=p.getCellMetaKeyValue(S,_,g),$=a.runHooks("beforeRemoveCellMeta",d,y,g,R);$!==!1&&(p.removeCellMeta(S,_,g),a.runHooks("afterRemoveCellMeta",d,y,g,R)),R=null},this.spliceCellsMeta=function(d){for(var y=this,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=arguments.length,S=new Array(w>2?w-2:0),_=2;_<w;_++)S[_-2]=arguments[_];if(S.length>0&&!Array.isArray(S[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&p.removeRow(this.toPhysicalRow(d),g),S.length>0&&ve(S.reverse(),function(R){p.createRow(y.toPhysicalRow(d)),ve(R,function($,k){return y.setCellMetaObject(d,k,$)})}),a.render()},this.setCellMetaObject=function(d,y,g){var w=this;_t(g)==="object"&&Te(g,function(S,_){w.setCellMeta(d,y,_,S)})},this.setCellMeta=function(d,y,g,w){var S=a.runHooks("beforeSetCellMeta",d,y,g,w);if(S!==!1){var _=d,R=y;d<this.countRows()&&(_=this.toPhysicalRow(d)),y<this.countCols()&&(R=this.toPhysicalColumn(y)),p.setCellMeta(_,R,g,w),a.runHooks("afterSetCellMeta",d,y,g,w)}},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(d,y){var g=this.toPhysicalRow(d),w=this.toPhysicalColumn(y);return g===null&&(g=d),w===null&&(w=y),p.getCellMeta(g,w,{visualRow:d,visualColumn:y})},this.getCellMetaAtRow=function(d){return p.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||b.columns)},this.getCellRenderer=function(d,y){var g=typeof d=="number"?a.getCellMeta(d,y).renderer:d.renderer;return typeof g=="string"?Gb(g):bt(g)?Gb("text"):g},this.getCellEditor=function(d,y){var g=typeof d=="number"?a.getCellMeta(d,y).editor:d.editor;return typeof g=="string"?Mb(g):bt(g)?Mb("text"):g},this.getCellValidator=function(d,y){var g=typeof d=="number"?a.getCellMeta(d,y).validator:d.validator;return typeof g=="string"?E4(g):g},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,y){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(y,d)},this.validateColumns=function(d,y){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(y,void 0,d)},this._validateCells=function(d,y,g){var w=new me;d&&(w.onQueueEmpty=d);for(var S=a.countRows()-1;S>=0;){if(y!==void 0&&y.indexOf(S)===-1){S-=1;continue}for(var _=a.countCols()-1;_>=0;){if(g!==void 0&&g.indexOf(_)===-1){_-=1;continue}w.addValidatorToQueue(),a.validateCell(a.getDataAtCell(S,_),a.getCellMeta(S,_),function(R){if(typeof R!="boolean")throw new Error("Validation error: result is not boolean");R===!1&&(w.valid=!1),w.removeValidatorFormQueue()},"validateCells"),_-=1}S-=1}w.checkIfQueueIsEmpty()},this.getRowHeader=function(d){var y=b.rowHeaders,g=d;return g!==void 0&&(g=a.runHooks("modifyRowHeader",g)),g===void 0?(y=[],Yt(a.countRows()-1,function(w){y.push(a.getRowHeader(w))})):Array.isArray(y)&&y[g]!==void 0?y=y[g]:ke(y)?y=y(g):y&&typeof y!="string"&&typeof y!="number"&&(y=g+1),y},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(var d=0,y=a.countCols();d<y;d++)if(a.getColHeader(d))return!0;return!1},this.getColHeader=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,g=a.runHooks("modifyColHeader",d);if(g===void 0){for(var w=[],S=a.countCols(),_=0;_<S;_++)w.push(a.getColHeader(_));return w}var R=b.colHeaders,$=function(B){for(var te=[],z=a.countCols(),G=0;G<z;G++)ke(b.columns)&&b.columns(G)&&te.push(G);return te[B]},k=a.toPhysicalColumn(g),H=$(k);return b.colHeaders===!1?R=null:b.columns&&ke(b.columns)&&b.columns(H)&&b.columns(H).title?R=b.columns(H).title:b.columns&&b.columns[k]&&b.columns[k].title?R=b.columns[k].title:Array.isArray(b.colHeaders)&&b.colHeaders[k]!==void 0?R=b.colHeaders[k]:ke(b.colHeaders)?R=b.colHeaders(k):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(R=Dq(g)),R=a.runHooks("modifyColumnHeaderValue",R,d,y),R},this._getColWidthFromSettings=function(d){var y;if(d>=0){var g=a.getCellMeta(0,d);y=g.width}if((y===void 0||y===b.width)&&(y=b.colWidths),y!=null){switch(_t(y)){case"object":y=y[d];break;case"function":y=y(d);break}typeof y=="string"&&(y=parseInt(y,10))}return y},this.getColWidth=function(d){var y=a._getColWidthFromSettings(d);return y=a.runHooks("modifyColWidth",y,d),y===void 0&&(y=mR.DEFAULT_WIDTH),y},this._getRowHeightFromSettings=function(d){var y=b.rowHeights;if(y!=null){switch(_t(y)){case"object":y=y[d];break;case"function":y=y(d);break}typeof y=="string"&&(y=parseInt(y,10))}return y},this.getRowHeight=function(d){var y=a._getRowHeightFromSettings(d);return y=a.runHooks("modifyRowHeight",y,d),y},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var d=b.maxCols,y=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,y)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=0;return Bb(a.countRows()-1,function(g){if(a.isEmptyRow(g))y+=1;else if(d===!0)return!1}),y},this.countEmptyCols=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=0;return Bb(a.countCols()-1,function(g){if(a.isEmptyCol(g))y+=1;else if(d===!0)return!1}),y},this.isEmptyRow=function(d){return b.isEmptyRow.call(a,d)},this.isEmptyCol=function(d){return b.isEmptyCol.call(a,d)},this.selectCell=function(d,y,g,w){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return bt(d)||bt(y)?!1:this.selectCells([[d,y,g,w]],S,_)},this.selectCells=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;y===!1&&(o=!0);var w=E.selectCells(d);return w&&g&&a.listen(),o=!1,w},this.selectColumns=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return E.selectColumns(d,y)},this.selectRows=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return E.selectRows(d,y)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,y=d&&this.hasRowHeaders(),g=d&&this.hasColHeaders();o=!0,E.selectAll(y,g),o=!1};var Pe=function(y,g){return y.getNearestNotHiddenIndex(g,1,!0)};this.scrollViewportTo=function(d,y){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_=!g,R=!w,$=d,k=y;if(S){var H=Number.isInteger(d),N=Number.isInteger(y),B=H?Pe(this.rowIndexMapper,d):void 0,te=N?Pe(this.columnIndexMapper,y):void 0;if(B===null||te===null)return!1;$=H?a.rowIndexMapper.getRenderableFromVisualIndex(B):void 0,k=N?a.columnIndexMapper.getRenderableFromVisualIndex(te):void 0}var z=Number.isInteger($),G=Number.isInteger(k);return z&&G?a.view.scrollViewport(a._createCellCoords($,k),_,w,g,R):z&&G===!1?a.view.scrollViewportVertically($,_,g):G&&z===!1?a.view.scrollViewportHorizontally(k,w,R):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),p.clearCache(),Dd(a)){var d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}Ai(a.rootElement),l.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),T.getItems().forEach(function(y){var g=Sr(y,2),w=g[1];w.destroy()}),T.clear(),a.runHooks("afterDestroy")},!0),Nt.getSingleton().destroy(a),Te(a,function(y,g,w){ke(y)?w[g]=Ke(g):g!=="guid"&&(w[g]=null)}),a.isDestroyed=!0,s&&s.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,s=null,c=null,E=null,f=null,a=null};function Ke(d){return function(){throw new Error('The "'.concat(d,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(d){var y=Py(d);return y==="UndoRedo"?this.undoRedo:T.getItem(y)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(d)},this.getInstance=function(){return a},this.addHook=function(d,y){Nt.getSingleton().add(d,y,a)},this.hasHook=function(d){return Nt.getSingleton().has(d,a)||Nt.getSingleton().has(d)},this.addHookOnce=function(d,y){Nt.getSingleton().once(d,y,a)},this.removeHook=function(d,y){Nt.getSingleton().remove(d,y,a)},this.runHooks=function(d,y,g,w,S,_,R){return Nt.getSingleton().run(a,d,y,g,w,S,_,R)},this.getTranslatedPhrase=function(d,y){return J0(b.language,d,y)},this.toHTML=function(){return Wb(n)},this.toTableElement=function(){var d=n.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",Wb(n)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=d;typeof g=="function"&&(g=setTimeout(g,y)),this.timeouts.push(g)},this._clearTimeouts=function(){ve(this.timeouts,function(d){clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){ve(this.immediates,function(d){clearImmediate(d)})},this._refreshBorders=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(d),a.view.render(),y&&E.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var Ce=qre({handleEvent:function(y){var g=a.isListening(),w=(y==null?void 0:y.key)!==void 0;return g&&w},beforeKeyDown:function(y){return n.runHooks("beforeKeyDown",y)},afterKeyDown:function(y){n.isDestroyed||a.runHooks("afterDocumentKeyDown",y)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(d){d.ctrlKey===!1&&d.metaKey===!1&&Ce.releasePressedKeys()}),this.getShortcutManager=function(){return Ce};var Me=Ce.addContext("grid"),xe={runOnlyIf:function(){return oe(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:nne};Ce.setActiveContextName("grid"),Me.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var y=a.getSelectedRange(),g=y[y.length-1].highlight,w=g.row,S=g.col,_=a.getDataAtCell(w,S),R=new Map,$=0;$<y.length;$++)y[$].forAll(function(k,H){if(k>=0&&H>=0&&(k!==w||H!==S)){var N=a.getCellMeta(k,H),B=N.readOnly;B||R.set("".concat(k,"x").concat(H),[k,H,_])}});a.setDataAtCell(Array.from(R.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var y=a.getSelectedRangeLast(),g=y.from,w=y.to,S=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(g.clone()),E.setRangeEnd(a._createCellCoords(S,w.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var y=a.getSelectedRangeLast(),g=y.from,w=y.to,S=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);E.setRangeStart(g.clone()),E.setRangeEnd(a._createCellCoords(S,w.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){E.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var y,g=a.getSelectedRangeLast().highlight.row,w=(y=a.columnIndexMapper).getNearestNotHiddenIndex.apply(y,hi(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(a._createCellCoords(g,w))}},{keys:[["ArrowLeft","Shift"]],callback:function(){E.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var y,g=a.getSelectedRangeLast(),w=g.from,S=g.to,_=(y=a.columnIndexMapper).getNearestNotHiddenIndex.apply(y,hi(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(w.clone()),E.setRangeEnd(a._createCellCoords(S.row,_))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){E.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var y,g=a.getSelectedRangeLast().highlight.row,w=(y=a.columnIndexMapper).getNearestNotHiddenIndex.apply(y,hi(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(a._createCellCoords(g,w))}},{keys:[["ArrowRight","Shift"]],callback:function(){E.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var y,g=a.getSelectedRangeLast(),w=g.from,S=g.to,_=(y=a.columnIndexMapper).getNearestNotHiddenIndex.apply(y,hi(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(w.clone()),E.setRangeEnd(a._createCellCoords(S.row,_))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var y=parseInt(a.getSettings().fixedColumnsStart,10),g=a.getSelectedRangeLast().highlight.row,w=a.columnIndexMapper.getNearestNotHiddenIndex(y,1);E.setRangeStart(a._createCellCoords(g,w))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var y=parseInt(a.getSettings().fixedRowsTop,10),g=parseInt(a.getSettings().fixedColumnsStart,10),w=a.rowIndexMapper.getNearestNotHiddenIndex(y,1),S=a.columnIndexMapper.getNearestNotHiddenIndex(g,1);E.setRangeStart(a._createCellCoords(w,S))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var y=parseInt(a.getSettings().fixedRowsBottom,10),g=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-y-1,-1),w=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);E.setRangeStart(a._createCellCoords(g,w))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){E.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var y=a.getSelectedRangeLast(),g=y.to,w=Math.max(g.row-a.countVisibleRows(),0),S=a.rowIndexMapper.getNearestNotHiddenIndex(w,1);if(S!==null){var _=a._createCellCoords(S,g.col),R=g.row-a.view.getFirstFullyVisibleRow(),$=Math.max(_.row-R,0);E.setRangeEnd(_),a.scrollViewportTo($)}}},{keys:[["PageDown"]],callback:function(){E.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var y=a.getSelectedRangeLast(),g=y.to,w=Math.min(g.row+a.countVisibleRows(),a.countRows()-1),S=a.rowIndexMapper.getNearestNotHiddenIndex(w,-1);if(S!==null){var _=a._createCellCoords(S,g.col),R=g.row-a.view.getFirstFullyVisibleRow(),$=Math.min(_.row-R,a.countRows()-1);E.setRangeEnd(_),a.scrollViewportTo($)}}},{keys:[["Tab"]],callback:function(y){var g=typeof b.tabMoves=="function"?b.tabMoves(y):b.tabMoves;E.transformStart(g.row,g.col,!0)}},{keys:[["Shift","Tab"]],callback:function(y){var g=typeof b.tabMoves=="function"?b.tabMoves(y):b.tabMoves;E.transformStart(-g.row,-g.col)}}],xe),p4().forEach(function(d){var y=b4(d);T.addItem(d,new y(n))}),Nt.getSingleton().run(a,"construct")}var ine="hooksRefRegisterer",w$={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;ve(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Te(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};mn(w$,"MIXIN_NAME",ine,{writable:!1,enumerable:!1});const one=w$;function so(e){return so=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(e)}function ane(e,t){return cne(e)||une(e,t)||sne(e,t)||lne()}function lne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sne(e,t){if(e){if(typeof e=="string")return wO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(e,t)}}function wO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function une(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function cne(e){if(Array.isArray(e))return e}function fne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&av(e,t)}function av(e,t){return av=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},av(e,t)}function hne(e){var t=yne();return function(){var n=Fu(e),i;if(t){var o=Fu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dne(this,i)}}function dne(e,t){if(t&&(so(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vne(e)}function vne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fu(e)}function SO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mne(n.key),n)}}function CO(e,t,r){return t&&OO(e.prototype,t),r&&OO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mne(e){var t=gne(e,"string");return so(t)==="symbol"?t:String(t)}function gne(e,t){if(so(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(so(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pne="base",ot=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),lv="baseEditor",nm=function(){function e(t){SO(this,e),this.hot=t,this.instance=t,this.state=ot.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return CO(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,a,l){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=l,this.state=ot.VIRGIN}},{key:"extend",value:function(){return function(r){fne(i,r);var n=hne(i);function i(){return SO(this,i),n.apply(this,arguments)}return CO(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,a,l,s;if(n){var u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];o=c[0],a=c[1],l=c[2],s=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",o,a);if(Array.isArray(f)){var h=ane(f,2);o=h[0],a=h[1]}var v=this.hot.getShortcutManager(),m=v.getContext("editor"),p={runOnlyIf:function(){return oe(i.hot.getSelected())},group:lv};this.isInFullEditMode()&&m.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],p),this.hot.populateFromArray(o,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===ot.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,a)),this.state=ot.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:BT(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,a;if(i){var l=this._closeCallback;this._closeCallback=function(f){l&&l(f),i(f),o.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(lv),u.removeShortcutsByGroup(xy),this.state===ot.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===ot.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=ot.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){o.state=ot.FINISHED,o.discardEditor(f)}):(this.state=ot.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=ot.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===ot.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=ot.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ot.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===ot.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,o=i.wtOverlays,a=i.wtViewport,l=this.hot.rootWindow,s=$t(n),u=Qe(n),c=$t(this.hot.rootElement),f=Qe(this.hot.rootElement),h=o.topOverlay.holder,v=o.inlineStartOverlay.holder,m=h!==l?h.scrollTop:0,p=v!==l?v.scrollLeft:0,b=l.innerWidth-c.left-f,C=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,T=C.wtTable,I=T.name,P=["master","inline_start"].includes(I)?m:0,E=["master","top","bottom"].includes(I)?p:0,q=s.top===c.top?0:1,Y=s.top-c.top-q-P,ne=0;this.hot.isRtl()?ne=l.innerWidth-s.left-u-b-1+E:ne=s.left-c.left-1-E,["top","top_inline_start_corner"].includes(I)&&(Y+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(I)&&(ne+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var me=this.hot.hasColHeaders(),dt=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),et=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ze=this.hot.rowIndexMapper.getRenderableIndexesLength(),ie=ze-this.hot.view._wt.getSetting("fixedRowsBottom");(me&&dt<=0||dt===ie)&&(Y+=1),et<=0&&(ne+=1);var Pe=a.rowsRenderCalculator.startPosition,Ke=a.columnsRenderCalculator.startPosition,Ce=Math.abs(o.inlineStartOverlay.getScrollPosition()),Me=o.topOverlay.getScrollPosition(),xe=wt(this.hot.rootDocument),d=n.offsetTop+Pe-Me,y=0;if(this.hot.isRtl()){var g=n.offsetLeft;g>=0?y=T.getWidth()-n.offsetLeft:y=Math.abs(g),y+=Ke-Ce-u}else y=n.offsetLeft+Ke-Ce;var w=Hn(this.TD,this.hot.rootWindow),S=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(w[S],10)>0?0:1,R=parseInt(w.borderTopWidth,10)>0?0:1,$=Qe(n)+_,k=Kt(n)+R,H=xG(h)?xe:0,N=NG(v)?xe:0,B=this.hot.view.maximumVisibleElementWidth(y)-H+_,te=Math.max(this.hot.view.maximumVisibleElementHeight(d)-N+R,23);return{top:Y,start:ne,height:k,maxHeight:te,width:$,maxWidth:B}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return pne}}]),e}();Be(nm,one);function bne(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(v,m,p){v.addEventListener(m,p,!1)},a=function(v,m,p){v.removeEventListener(m,p,!1)},l=function(v){var m,p;v?/^[a-zA-Z \.,\\\/\|0-9]$/.test(v)||(v="."):v="",n.textContent!==void 0?n.textContent=t.value+v:n.data=t.value+v,i.style.position="absolute",i.style.fontSize=f(t).fontSize,i.style.fontFamily=f(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),m=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>m?t.style.width=e.minWidth+"px":m>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=m+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},s=function(){window.setTimeout(l,0)},u=function(v){if(v&&v.minHeight)if(v.minHeight=="inherit")e.minHeight=t.clientHeight;else{var m=parseInt(v.minHeight);isNaN(m)||(e.minHeight=m)}if(v&&v.maxHeight)if(v.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(v.maxHeight);isNaN(p)||(e.maxHeight=p)}if(v&&v.minWidth)if(v.minWidth=="inherit")e.minWidth=t.clientWidth;else{var b=parseInt(v.minWidth);isNaN(b)||(e.minWidth=b)}if(v&&v.maxWidth)if(v.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var C=parseInt(v.maxWidth);isNaN(C)||(e.maxWidth=C)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(v,m,p){t=v,u(m),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(o(t,"change",l),o(t,"cut",s),o(t,"paste",s),o(t,"drop",s),o(t,"keydown",s),o(t,"focus",l),o(t,"compositionstart",s),o(t,"compositionupdate",s),o(t,"compositionend",s)),l()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(v,m,p){c(v,m,p)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function _O(e,t){for(var r=AG(t),n=t.value.split(`
`),i=r,o=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(o+=n[a-1].length+1);var s=o+l.length;if(e==="home"?i=o:e==="end"&&(i=s),r<=s)break}KT(t,i)}function uo(e){return uo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(e)}function TO(e,t){return Cne(e)||One(e,t)||Sne(e,t)||wne()}function wne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sne(e,t){if(e){if(typeof e=="string")return RO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(e,t)}}function RO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function One(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,l=[],s=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,i=c}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function Cne(e){if(Array.isArray(e))return e}function _ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rne(n.key),n)}}function Tne(e,t,r){return t&&EO(e.prototype,t),r&&EO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rne(e){var t=Ene(e,"string");return uo(t)==="symbol"?t:String(t)}function Ene(e,t){if(uo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qo(){return typeof Reflect<"u"&&Reflect.get?Qo=Reflect.get.bind():Qo=function(t,r,n){var i=$ne(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Qo.apply(this,arguments)}function $ne(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zn(e),e!==null););return e}function Pne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sv(e,t)}function sv(e,t){return sv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sv(e,t)}function Ine(e){var t=Ane();return function(){var n=zn(e),i;if(t){var o=zn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kne(this,i)}}function kne(e,t){if(t&&(uo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S$(e)}function S$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ane(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zn(e)}var Mne="ht_editor_visible",bs="ht_editor_hidden",$O="textEditor",xne="text",Nne=function(e){Pne(r,e);var t=Ine(r);function r(n){var i;return _ne(this,r),i=t.call(this,n),i.eventManager=new Dl(S$(i)),i.autoResize=bne(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return Tne(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,a,l,s,u){var c=this.state;if(Qo(zn(r.prototype),"prepare",this).call(this,i,o,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,h=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==ot.FINISHED&&this.hideEditableElement();var v=!h;v&&!Pn()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===ot.VIRGIN&&(this.TEXTAREA.value="",Qo(zn(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),KT(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,he(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),he(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ne(this.TEXTAREA_PARENT,this.layerClass)&&Ue(this.TEXTAREA_PARENT,this.layerClass),he(this.TEXTAREA_PARENT,bs),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(bB()||pB())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ue(this.TEXTAREA_PARENT,this.layerClass),he(this.TEXTAREA_PARENT,bs)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Yt(i.length-1,function(a){var l=i[a];if(Ne(l,"handsontableEditor"))return o=!0,!1}),Ne(this.TEXTAREA_PARENT,bs)&&Ue(this.TEXTAREA_PARENT,bs),o?(this.layerClass=Mne,he(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),he(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==ot.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),a=o.top,l=o.start,s=o.width,u=o.maxWidth,c=o.height,f=o.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Hn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var v=Hn(this.TEXTAREA),m=parseInt(v.paddingLeft,10)+parseInt(v.paddingRight,10),p=parseInt(v.paddingTop,10)+parseInt(v.paddingBottom,10),b=s-m,C=c-p,T=u-m,I=f-p;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(b,T),minHeight:Math.min(C,I),maxWidth:T,maxHeight:I},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),K_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),l={runOnlyIf:function(){return oe(i.hot.getSelected())},group:$O},s=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(c){return!i.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:Ms,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Ms,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Ms,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var h=TO(f,1),v=h[0];_O(v,i.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var h=TO(f,1),v=h[0];_O(v,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(xy),o.removeShortcutsByGroup($O),o.removeShortcutsByGroup(lv)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[W.ARROW_UP,W.ARROW_RIGHT,W.ARROW_DOWN,W.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return xne}}]),r}(nm),Dne="base";function O$(e,t,r,n,i,o,a){var l=[],s=[];a.className&&he(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!o&&a.placeholder&&l.push(a.placeholderCellClassName),Ue(t,s),he(t,l)}O$.RENDERER_TYPE=Dne;var Hne="text";function C$(e,t,r,n,i,o,a){O$.apply(this,[e,t,r,n,i,o,a]);var l=o;if(!l&&a.placeholder&&(l=a.placeholder),l=BT(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Ai(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else xl(t,l)}C$.RENDERER_TYPE=Hne;var Lne="text",Fne={CELL_TYPE:Lne,editor:Nne,renderer:C$};jte(Fne);Lt.editors={BaseEditor:nm};function Lt(e,t){var r=new b$(e,t||{},Ky);return r.init(),r}Lt.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new b$(e,t,Ky)};Lt.DefaultSettings=h$();Lt.hooks=Nt.getSingleton();Lt.CellCoords=lu;Lt.CellRange=Hy;Lt.packageName="handsontable";Lt.buildDate="28/03/2023 12:24:11";Lt.version="12.3.3";Lt.languages={dictionaryKeys:uJ,getLanguageDictionary:Q0,getLanguagesDictionaries:gJ,registerLanguageDictionary:Z0,getTranslatedPhrase:J0};var Ti=Symbol("unassigned"),jne="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function ju(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _$(e){var t=Lt.hooks.getRegistered(),r={};Object.assign(r,Lt.DefaultSettings);for(var n in r)r[n]={default:Ti};for(var i=0;i<t.length;i++)r[t[i]]={default:Ti};return r.settings={default:Ti},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function T$(e){var t={},r=e.settings;if(r!==Ti)for(var n in r)ju(r,n)&&r[n]!==Ti&&(t[n]=r[n]);for(var i in e)ju(e,i)&&i!=="settings"&&e[i]!==Ti&&(t[i]=e[i]);return t}function PO(e,t){var r=T$(e),n=e.settings?e.settings:r,i=e.settings?r:null,o={};for(var a in n)ju(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!IO(t[a],n[a]))&&(o[a]=n[a]);for(var l in i)ju(i,l)&&l!=="id"&&l!=="settings"&&i[l]!==void 0&&(!(t&&l!=="data")||!IO(t[l],i[l]))&&(o[l]=i[l]);return o}function IO(e,t){return JSON.stringify(e)===JSON.stringify(t)}var Vne="12.3.3",R$=AO({name:"HotTable",props:_$("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=PO(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(jne),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=PO(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=I$(new Lt.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==o&&r.length<o)for(var s=r.length;s<o;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var c=r[0].length;c<l;c++)i.push(c)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(o-1,r.length-o),a&&r.length!==0&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:Vne}),Wne=["id"];function Bne(e,t,r,n,i,o){return k$(),A$("div",{id:e.id},[M$(e.$slots,"default")],8,Wne)}R$.render=Bne;R$.__file="src/HotTable.vue";function kO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kO(Object(r),!0).forEach(function(n){Une(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Une(e,t,r){return t=Gne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yne(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gne(e){var t=Yne(e,"string");return typeof t=="symbol"?t:String(t)}var Kne=AO({name:"HotColumn",props:_$("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=T$(this.$props),r=zne({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});Kne.__file="src/HotColumn.vue";export{R$ as H};
